commit 650a3b73479d1b92f8a12c696735f4d6c7c9ff7e
Author: Pavan Sondur <pavan@lw.com>
Date:   Fri Feb 12 04:08:03 2010 +0000

    features/locks: Set dummy fd ctx in all relevant places so that release callback in locks is always called.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 15043b6d978e1baa7b0884d2dc98c3d00f096cde
Author: Anand Avati <avati@lw.com>
Date:   Fri Feb 5 05:00:20 2010 +0000

    Fixes for MacOSX and Solaris build
    
    Fixes for Solaris and MacOSX build errors.
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 481 (Fix compilation failures in Solaris)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=481

commit 921332253e86cf15ad6bd1adb963523a3980e94d
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Jan 28 08:20:26 2010 +0000

    cluster/dht: Check for size 0 in check_is_linkfile()
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 574 (Sticky bit files are not listed in the output of ls on a dht volume)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=574

commit c15449aaaeb725c49af3817e07ea33c6c09c8c15
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Tue Jan 26 09:05:41 2010 +0000

    Revert "Server backend storage hang should not cause the mount point to hang."
    
    This reverts commit a0b148ea4e2a0163548eeb89b7580be4adbb8070.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 272 (Server backend storage hang should not cause the mount point to hang)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=272

commit 936eac4cec6cf57ab22688cb8f3222d385818c97
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 14:49:05 2010 +0000

    write-behind: fix 'option enable-trickling-writes'
    
    fix logic in __wb_mark_winds to properly initialize incomplete_writes
    and conditionally check based on enable_trickling_writes flag
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 547 (write-behind enable-trickling-writes working?)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=547

commit 21b2b12ae44a2583604ce6628b4570b8fd9dbf01
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 15:18:21 2010 +0000

    protocol/server: unlink dentry only for non-root inodes
    
    in server_lookup_cbk, unlink dentry from the crash on receiving
    ENOENT from subvolume only for non-root inode. ENOENT can be returned
    for root inode if export directory is deleted
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 526 (lwfsd crash when export dir is deleted and revalidate happens on /)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=526

commit c95e892e454d6fc49f6749150eca028ff8b2b45d
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 16:52:48 2010 +0000

    trace: multiple fixes
    
           Jeff Darcy <jdarcy@redhat.com>
    
           Jeff Darcy <jdarcy@redhat.com>
    
    - whitespace and indentation cleanup
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 168 (trace does not output debug messages)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=168
    
    BUG: 473 (Trace misreporting pre/post attributes for setattr.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=473
    
    BUG: 519 (Possible SEGV when tracing readlink)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=519
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 1ee3cc05cdff1b34dae466e1218fb2505899ddeb
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 17:37:38 2010 +0000

    protocol/client: timeout tweaks
    
    * option frame-timeout 0 now means no frame timeout
    * option ping-timeout 0 now means no ping timeout
    * extended frame-timeout range from 0 to 1 day
    * extended ping-timeout range from 1
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 450 (frame-timeout range should be higher)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=450
    
    BUG: 423 (Disable protocol timeout)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=423

commit 5e1fdc783072337ab37876bfbbd4f3b2f56e6d7e
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Jan 25 07:02:45 2010 +0000

    mount/fuse: Fix file type checking.
    
    This patch fixes two things:
     - Check for symlinks and set d_type appropriately
     - Use S_IS* macros for checking.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 571 (find -type l ignores symlinks on LWFS)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=571

commit 404d4dadcea3893a86a405475acb32545598f0b5
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Tue Jan 26 03:45:00 2010 +0000

    Fix fetching volume file from the server, by sending parent up through the xlator graph.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 573 (3.0.1 doesn't fetch volfume files from the server)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=573

commit 4c20b5377e4a73a684ba3bb091380fd0f19731ca
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Jan 25 05:59:28 2010 +0000

    storage/posix: Fix an access-after-free bug in release() and releasedir().
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 533 (close() should not block main loop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=533

commit e468531dcba808e71a13d3479b6f31a52f745f59
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Mon Jan 25 05:09:40 2010 +0000

    Fix occurence of cache-size being floating point
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 516 (cache-size should not be hard-coded to 1GB)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=516

commit 9f39bbf1e73a857ce052852844a98938557ad93a
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Mon Jan 25 03:53:55 2010 -0800

    set format-patch.sh BRANCH: tag

commit 899b89a8c2faee55128db392cdb426e08e2289e7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Dec 23 15:06:38 2009 +0000

    booster/fcntl: implement F_GETFD and F_SETFD.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 446 (apache does not start in daemon mode on fedora core 11.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=446

commit da505a63c12ea9be0e783711547fe7bbfecf05ea
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 13:26:39 2010 +0000

    dht: initialize layout type
    
    Instead of relying on CALLOC's zero initialization which happens
    to be the value of DHT_HASH_TYPE_DM, explicitly set the value
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 523 (Hash type is not initialized in dht_layout_new)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=523

commit 6313f854fb41ef0a61a40b08a4cf05254763eb21
Author: Vijay Bellur <vijay@lw.com>
Date:   Sat Jan 23 12:53:56 2010 +0000

    protocol/client: Look only for op_ret while handling a setvolume response.
    
    op_errno should not be looked up to stop processing setvolume_cbk().
    This fixes the problem of 3.0.x clients crashing if they attempt to
    connect to 2.0.x servers.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 564 (3.0.1rc3 server daemon crashes when any of the 2.0.x version client connects)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=564

commit 502fef89bb352aa8092c3b2e606757c5ef644171
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 07:03:08 2010 +0000

    error-gen: change all STACK_UNWIND calls to STACK_UNWIND_STRICT
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 6f15b21994e26925a587ab8965ab909abbfbeece
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 07:02:35 2010 +0000

    error-gen: unwind fsync with proper parameters
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 553 (server crashed in server_fsync_cbk)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=553

commit 546168723f5b04a95aa1dab80679591335c5fc75
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 05:14:49 2010 +0000

    protocol/server: cleanup whitespaces
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 272 (Server backend storage hang should not cause the mount point to hang)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=272

commit a0b148ea4e2a0163548eeb89b7580be4adbb8070
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 05:14:31 2010 +0000

    Server backend storage hang should not cause the mount point to hang.
    
    Submitted-by: Krishna Srinivas <krishna@lw.com>
    NOTE: fixed compilation issues in posix.c introduced while merging
    
    storage/posix polls for FS/kernel being functional by issuing
    statvfs() call. In case statvfs expires the timer, storage/posix will
    send CHILD_DOWN to upper translator. Ultimately this will cause
    protocol/server to disconnect all clients connected and also cleans up
    the data structures. Hence if soft lockup or other kernel bug causes
    backend FS to hang, the clients will not be hung.
    
    Signed-off-by: Krishna Srinivas <krishna@lw.com>
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 272 (Server backend storage hang should not cause the mount point to hang)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=272

commit 9c53d5daf403f6fbfde76dec121295a4c156b32e
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 05:13:24 2010 +0000

    core: fix initialization of disjoint xlator graph
    
    if graph has disjoint subgraphs, send GF_EVENT_PARENT_UP to every top node
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 272 (Server backend storage hang should not cause the mount point to hang)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=272

commit 95dba6f085379ce8e07f316bc92c479956b5b221
Author: Anand Avati <avati@lw.com>
Date:   Sat Jan 23 00:46:16 2010 +0000

    protocol/server: handle group id decoding in a stricter way
    
    This causes crash between 3.0.x servers and 2.0.x clients
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 564 (3.0.1rc3 server daemon crashes when any of the 2.0.x version client connects)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=564

commit 375f08e1b56f61c5687bb276fb95bea230085f77
Author: Anand Avati <avati@lw.com>
Date:   Fri Jan 22 08:53:49 2010 +0000

    transport: set proper reference counts on peer_trans for local connections
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 562 (crash resulting from bad refs in transport_setpeer)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=562

commit a116e5b3ef2d4fbb57a5690a01368ec7aa0942aa
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Jan 22 03:02:32 2010 +0000

    transport/socket: use appropriate address family macro when address family is inet-sdp.
    
    - sa_family should be set to AF_INET_SDP only during call to socket system
        call. For all other calls, sa_family should be AF_INET.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 561 (with address family set to 'inet-sdp', transport/socket doesn't work correctly)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=561

commit ab8cabcd30bbb5dde4cb8a35d4fd88136994f526
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Thu Jan 21 05:36:42 2010 +0000

    Cache size is now dynamic and is 20% of the total memory on the client side.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 516 (cache-size should not be hard-coded to 1GB)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=516

commit 27399cc92d62a168f768c490fc19c935e7e513f1
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jan 21 07:28:59 2010 +0000

    cluster/afr: Send the struct flock returned by the server to the user.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 521 (SPECFS validation fails over distribute + replicate)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=521

commit 84fe79c086a4623e1bb1c0ca5cebff19d19d15ec
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jan 21 06:46:25 2010 +0000

    storage/posix: Make the janitor sleep duration configurable.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 533 (close() should not block main loop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=533

commit a6a1f596a443b6a015dca6435f1d22fc582acc80
Author: Pavan Sondur <pavan@lw.com>
Date:   Tue Jan 19 08:11:05 2010 +0000

    extras: Add defrag scripts to the repository
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 478 (Add defrag scripts into lwfs)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=478

commit a23185f3a43ec95a56af9f0f543b67a1fcfb4852
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Jan 15 06:59:00 2010 +0000

    storage/posix: Hand off calling close() and closedir() to the janitor thread.
    
    Let the janitor thread handle calling close() and closedir() on fd's and DIR *
    when posix_release is called. This avoids blocking the main server loop
    due to close().
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 533 (close() should not block main loop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=533

commit 4951f4dcc1b795b42fa845b6a89a9902af5b6586
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jan 12 13:21:59 2010 +0000

    stripe entry self heal
    
    Create the entry (either regular file or directory), when its
    missing in some of the subvolumes and available on some.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 535 (stripe entry self-heal..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=535

commit e6f074f93195b2e7d92812f26782e8dc281a1329
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Dec 30 21:45:20 2009 +0000

    default log file now doesn't start with '-'
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 490 (Default log file path should not begin with '-')
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=490

commit 5522f6eaef99616efe01b8f4688be0486e511b12
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jan 12 04:14:25 2010 +0000

    cluster/afr: Pick a source for metadata self-heal even if all nodes are innocent.
    
    If metadata changelog has been disabled, all subvolumes
    will be innocent. In that case, simply pick the subvolume
    on which the file has the lowest uid as the source and
    sync other subvolumes to it.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 451 (metadata self-heal does not a pick a source if mode/times have been changed at the backend)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=451

commit da09bf7fafa725db7f6e778f7fb5645276978948
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Jan 12 17:47:25 2010 +0000

    liblwfsclient/readv: fix data corruption.
    
    - libgf_client_readv should return the total number of bytes read by
         multiple invocations of libgf_client_iobuf_readv, instead of return value
         of last invocation.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 531 (accessing a file through apache results in Permission denied errors.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=531

commit a1965b73da712644d1536d0dac3212041de5eb0c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Jan 6 20:18:47 2010 +0000

    cluster/unify: don't call xl_init_tree on namespace node.
    
    - just before xl_init_tree call on namespace, unify node is set as parent of
        namespace node and since xl->ready of unify node is set only after return
        from init call, calling xl_init_tree on namespace node will result in
        execution of init of unify node for the second time. This results in
        following bugs:
    
        * since during second execution, parent of namespace node is unify, init of
          unify xlator fails.
        * even if init did not fail, re-execution of init in itself is bad, since it
          results in memory leaks etc. Worse, it can result in infinite recursive
          calls into init of unify node.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 518 (unify does not start)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=518

commit 7317a250caa96b00072a8a7cb2b2c18016e8a8d2
Author: Pavan Sondur <pavan@lw.com>
Date:   Mon Jan 11 01:20:21 2010 +0000

    features/locks: Fix broken interface grant_blocked_inode_locks
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 496 (deadlock in pl_inode_setlk)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=496

commit 3647c9707f0124ae2fea21b4d501461e0e9b0169
Author: Pavan Sondur <pavan@lw.com>
Date:   Mon Jan 11 01:19:05 2010 +0000

    features/locks: Do not call grant blocked locks in pl_forget
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 496 (deadlock in pl_inode_setlk)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=496

commit d0c355917839ac06463ea1d0852eb56835cb7b45
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Jan 12 03:57:42 2010 +0000

    fuse: treat DESTROY message as proto requires, ie. don't leave it unanswered
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 361 (LWFS 3.0 should work on Mac OS/X)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=361

commit fb234e86288776386daad21fd6632414376b1cdc
Author: Vijay Bellur <vijay@lw.com>
Date:   Fri Jan 8 12:22:45 2010 +0000

    transport/socket: Enable NODELAY even if no option is set.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 524 (TCP_NODELAY not set when expected on client)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=524

commit 2674d226f41bf090c8f69c676f22102f877a75c5
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Dec 24 12:10:09 2009 +0000

    liblwfs/inode: add NULL checks.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 510 (crash in inode_ref)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=510

commit 3adb7082c63d28950aca21718be84b65806e5d6e
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jan 7 05:17:17 2010 +0000

    cluster/afr: Use dict_ref instead of dict_copy_with_ref.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 509 (Crash in afr_local_cleanup ())
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=509

commit 90d18c74defcc11ee4b31c49d2700f96c18016e9
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Jan 5 07:19:40 2010 +0000

    fuse: fix memleak
    
    continuing the work of d281971e
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 438 (Memory leak)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=438

commit 013850c9bedacdb868eee6b70f3aa6b46d4acfab
Author: Csaba Henk <csaba@lw.com>
Date:   Thu Dec 24 06:59:44 2009 +0000

    fuse: add mtab entry asynchronously
    
    Instead of taking libfuse's approach to the bug referred
    -- making use of an ad-hoc mount option --, we get over
    the issue by not waiting for mtab manipulation to complete.
    If mtab manipulation happens to fail for some reason, just
    log an error message (instead of aborting the mount).
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 511 (mount hangs with some audit configurations)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=511

commit ea1403d8d922c3f08dc6feecc17d6eb33b8a72d2
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Dec 24 05:30:42 2009 +0000

    storage/posix: Zero out the checksum array in rchecksum.
    
    Set the checksum bytes to zero to ensure random junk
    is not returned as the checksum.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 3bcf8d4ce67654e2b5648ae11aaeb2e49dbcfa95
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Dec 28 06:07:48 2009 +0000

    cluster/afr: Allocate diff algorithm loop_state structures only once.
    
    Instead of CALLOC'ing a loop_state structure at the beginning
    of every loop, keep a table of allocated structures and reuse
    them.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 9658e13bd91849f75d968376aae5b937aabec512
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Dec 24 05:30:40 2009 +0000

    cluster/afr: Report number of blocks healed during diff self-heal.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 9331e101a4cd0a3faff25cf7dd603762296c7345
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Dec 24 05:11:40 2009 +0000

    protocol/client: Fail revalidate with ESTALE.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 6917011ee224fc41f6ca46a674d9c2df4e72913a
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Dec 22 01:53:33 2009 +0000

    properly ref/unref fd in stripe_opendir_cbk
    
    fixes the crash due to dereferencing NULL fd pointer
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 497 (Client crashes in fuse_fd_cbk while running ltp tests)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=497

commit 77d9a17a712a250c773a2bc724f16ecb3a3aa919
Author: Pavan Sondur <pavan@lw.com>
Date:   Mon Dec 21 04:30:04 2009 +0000

    features/locks: Unwind if inode is NULL to prevent 'lost' frame.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit 96ae032a9cb9b198f31e26aba30a39e5148a2ba4
Author: Vijay Bellur <vijay@lw.com>
Date:   Fri Dec 18 12:38:04 2009 +0000

    Support for Compilation on Solaris
    
    This is based on patch at:
    
    http://node3.rnode.ru/lwfs-3.0.0-p1.patch
    
    Thanks to Petrunin Egor <shellcode@mail.ru> for this patch.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 481 (Fix compilation failures in Solaris)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=481

commit 2a51ab19e6370325a5ebac9ed63f8606738919ec
Author: Hraban Luyat <hraban@0brg.net>
Date:   Sat Dec 19 15:47:25 2009 +0000

    More robust dictionary (un)serialization (fixes bug #397).
    
    Hello,
    
    This patch fixes bug 397: dictionary (de)serialization used pointer
    casting which forced word-alignment on (at least) armv5tel, causing
    corruption while writing and reading buffers into memory. It also adds
    some debugging (more information in case of errors).
    
    I tried to send this a few times already but I think it got bounced from
    the list.
    
    Greetings,
    
    Hraban Luyat
    
    Signed-off-by: Hraban Luyat <hraban@0brg.net>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 397 (dictionary serialization / deserialization fails on armv5tel)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=397

commit ea18fce5cd759a19aa928393a4b30cb87d33beec
Author: Csaba Henk <csaba@lw.com>
Date:   Fri Dec 18 07:51:12 2009 +0000

    fuse-bridge: Don't try to fill a loc in setattr when we can proceed on with an fd.
    
    This fixes broken ftruncate on unlinked files.
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 472 (OpenOffice fails on LWFS $HOME due to fuse_loc_fill error)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=472

commit 40541428c7df4192d93b6bc61a92784ca56c8b3f
Author: Csaba Henk <csaba@lw.com>
Date:   Fri Dec 18 07:49:43 2009 +0000

    fix typo in configure.ac
    
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>

commit 4921bc8c0fd045fdb82eb21eb358d378cdcad976
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Dec 18 07:06:27 2009 +0000

    distribute: Dont dereference sbuf on failed readlink_cbk
    
    This fixes a crash that was caused due to a NULL pointer deref
    because a NULL sbuf is returned if the readlink fop fails.
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 492 (distribute crashes in readlink)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=492

commit ff5170faa131b201bf8170601dbeae18b400542f
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Thu Dec 17 15:41:21 2009 +0000

    Added null checks in "fini"
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 364 (Segfault in io-cache)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=364

commit cfe095763c4ec59026467e3b76a92c61c18f0792
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Dec 16 19:09:16 2009 +0000

    bug fixes in call-stub creation for {fsetattr, fxattrop}_cbk()
    
    'wind' flag was set in case of 'unwind' stubs, causing wrong variables
    to get free'd, causing process to segfault.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 483 (booster unfsd segfault)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=483

commit b64d55a5b879812ff01f749a609238316031f332
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Dec 16 00:48:16 2009 +0000

    cluster/dht: Check for pointers before de-referencing in dht_stat_merge()
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 463 (Crash in dht_stat_merge ())
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=463

commit d049402c7336df73b1af7524f5f06a42069aa6b5
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Dec 14 17:59:15 2009 +0000

    more cleanup in stripe stat structures
    
    Removed few more 'fops' from stripe. More cleaner stat structure return.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>
    
    BUG: 340 (Kernel Compilation fail in stripe)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=340

commit 32b3961727cb61aed79de80bdc2c46da0dcea4d8
Author: Csaba Henk <csaba@lw.com>
Date:   Fri Dec 11 08:50:34 2009 +0000

    fix typo in posix
    
    Signed-off-by: Vijay Bellur <vijay@dev.lw.com>

commit 8379edd97876a85fe1231b7cc8d4cc40f962c5cc
Author: Pavan Sondur <pavan@lw.com>
Date:   Mon Dec 7 09:43:23 2009 +0000

    Disable fusermount by default in the rpm spec file and remove bdb references.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 349 (FreeBSD compilation error (alloca.h).)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=349

commit f0a026b837df2c85d44e1991a802d00201402a47
Author: Vijay Bellur <vijay@lw.com>
Date:   Mon Dec 7 02:07:39 2009 +0000

    Changed occurrences of JiangNan to LW
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>

commit 2fa7e528f50236355aa29874bd57d96c429ef33f
Author: Anand Avati <avati@lw.com>
Date:   Mon Dec 7 07:33:49 2009 +0000

    resolver: include RESOLVE_EXACT type for failure case when inode not found
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit a12bfdc8f32212354824a1b8dd7b27840518c4dc
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Dec 7 05:44:31 2009 +0000

    cluster/afr: Sync the parent directory's mtime during missing entries self-heal.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 137 (Parent directory mtime not reset after a create in self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=137

commit 0ae2b4be39214426a50f5e1fd09562f309819f32
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Dec 7 04:52:47 2009 +0000

    cluster/afr: Don't do entry self-heal in the background.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 326 ([2.0.8rc9] Spurious self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=326

commit 7499335588eabb578c4dab06263cd416a4f3b2d5
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Dec 7 04:40:57 2009 +0000

    cluster/afr: Hold inode lock on 0-infinity for a flush transaction.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 326 ([2.0.8rc9] Spurious self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=326

commit 4fdfc9fdcce340209d35e62f585c5897ca2a1104
Author: Csaba Henk <csaba@lw.com>
Date:   Sun Dec 6 21:18:53 2009 +0000

    fix typo in 76d6f3fbe
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit e026edec58aa234ef0c923eb6fed50dc227b7f8a
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Sun Dec 6 21:16:12 2009 +0000

    Save st_dev properly in stbuf.st_dev from the same subvolume.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 433 (Posix conformance test failed on 3.0.0pre2 (Dec 3) release)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=433

commit 3b2c86c8ed77b04cda05b7cbd8e73f6d01db1bed
Author: Amar Tumballi <amar@lw.com>
Date:   Sun Dec 6 16:38:06 2009 +0000

    removed every reference to BDB from configure.ac
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 343 (Placeholder bug for adding volgen into rpm, bdb makefile changes, etc)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=343

commit 2bee3fb30bb05e5c6b9af9cbbe0b10deba0db790
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Sun Dec 6 13:51:03 2009 -0800

    Revert "performance/write-behind: Changed default value of option disable-till to 0"
    
    This reverts commit e6c35f74ff4a204cf016ebf201a2630b331f9434.
    
    This commit is found to trigger spurious self heal by causing flush and writev to get
    reordered. Reverting as a workaround.

commit c50bc71035d87b5df77f6331ced6229af5508a10
Author: Csaba Henk <csaba@lw.com>
Date:   Sun Dec 6 14:29:04 2009 +0000

    fuse-bridge: set lk_owner to -1 for release forged flush.
    
    Server would interpret 0 as a sign of us getting disconnected.
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 76d6f3fbe993dddd72540f461090803636fa2dc5
Author: Csaba Henk <csaba@lw.com>
Date:   Sun Dec 6 14:27:57 2009 +0000

    fuse-bridge: make use of lock owner data in a protocol adherent way.
    
    No need for pid fallback, for those cases where we use it,
    it's always available.
    
    It appears conditionally in read/write/truncate (related to mandatory
    locking). There just get it for demonstrative purposes.
    
    Discard it from release, there locking data exists only as a
    portability hack, no use of it on Linux.
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 33f3abffe4f0de929d3732a472ad3df766d575b7
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 13:48:43 2009 +0000

    resolver: handle resolutions of paths
    
    support a new type of resolution where only the path is sent from the
    client over the wire without inode/parent/generation numbers. this can
    happen when cluster translators could not look up inodes on a server
    and later when the server comes up applications issues operations on
    the inode without a lookup (since they could be cd'ed inside). In these
    cases the server makes the best attempt to resolve the path and perform
    the fop on it
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit f08a2073d58ffff8c5b358fbb05702377a251b87
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Sun Dec 6 11:34:07 2009 -0800

    Revert "protocol/client: return ENOENT if inode context is missing"
    
    This reverts commit 4439876a34f2e5d19db0d8b05ce7d7722c1c466f.
    
    This revert is necessary for path handle resolution to work over the
    protocol where client/server talk only with the path, without inode
    or parent inode and generation numbers

commit 9e38b5066d42d47f1011e1d1bc32ed9c41df57ec
Author: Pavan Sondur <pavan@lw.com>
Date:   Sun Dec 6 13:29:08 2009 +0000

    features/locks: Implement release xlator callback.
    
    This patch solves the lock bailout problem seen recently when autoconf tools were run. This is a workaround,
    where 'flock' locks are removed in pl_release, if an explicit UNLCK call does not come. The complete fix would
    be to allow 'fcntl' and 'flock' locks to operate in different domains.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 449 (Handle flock calls in a different domain from fcntl calls)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=449

commit fe37a56dd42294e26158a29c15a35aeb8cb38be2
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 13:06:18 2009 +0000

    distribute: more cases of st_dev setting
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 433 (Posix conformance test failed on 3.0.0pre2 (Dec 3) release)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=433

commit 72e82741b52fb749eb912f97848b707d97ec69ff
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 12:47:25 2009 +0000

    distribute: return st_dev from the same subvol from where itransform is performed
    
    distribute should return st_dev from the same subvolume it itransforms the inode
    number. this is to ensure that there will not be false replacements of inodes in
    inode management
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 433 (Posix conformance test failed on 3.0.0pre2 (Dec 3) release)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=433

commit 0117cf0d3dfeb49b739e0da84f429b5375fd922a
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 12:46:14 2009 +0000

    fuse-bridge: log cases where newer generation is found in table
    
    This is usually the case when there is a bug a cluster xlator and returns
    generation number from the wrong subvolume
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 433 (Posix conformance test failed on 3.0.0pre2 (Dec 3) release)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=433

commit b5ad85803b85ae83b2a1bcbe18c8b42265dc34dc
Author: Pavan Sondur <pavan@lw.com>
Date:   Sun Dec 6 10:50:18 2009 +0000

    features/locks: Disable mandatory locks, until we can use lock-owner field without problems in mandatory locking.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 21b06ce3e46c3125ee5f281b49f6fcc3a09c02e7
Author: Pavan Sondur <pavan@lw.com>
Date:   Sun Dec 6 10:34:39 2009 +0000

    features/locks: Correct the order of arguments and print a log message in pl_flush.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit fdc187d11ead26710add3cd45dd5f306dad59900
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 07:42:30 2009 +0000

    protocol/server: more fixes in server_link_cbk
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 448 (server_link_cbk refers to @inode when op_ret is -1)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=448

commit a53cd95827df0a9c560fdf5e07b0c23d03707b04
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 05:31:44 2009 +0000

    THIS: set THIS pointers before forget/release/releasedir callbacks
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ea93dd6397b79842c1d8e5189ff217201c002a8d
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 04:45:17 2009 +0000

    afr: fix fd ref leak in self-heal
    
    sh->healing_fd should be ref'ed only when healing_fd_opened is not set
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 7a3c372c7a8a3ad7d481f94a899fd4333d146634
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 04:44:59 2009 +0000

    liblwfsclient: fix libgf_client_read to handle short reads
    
    Fixes two issues in the current code
    -short reads (reading larger than file size) result in failure of full read
    -reads which span multiple iterations return with the op_ret of only
       the last read
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 334 (lwfs_read/readv should break large-reads into 128Kb block sizes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=334

commit 4235868f0ded7aeb157aef05f10d2df4a470a2c5
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Dec 6 04:42:01 2009 +0000

    performance/stat-prefetch: remove the usage of THIS.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit bf23224e5dc2af09efd0888490f7af191052c874
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Dec 6 04:39:13 2009 +0000

    performance/stat-prefetch: fix memory leak.
    
    - rbt_hash_remove only removes entry from the hash table. It does not free
        the data.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 438 (Memory leak)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=438

commit 4d8c682181822834f46adaa6afea029556a0bb59
Author: Anand Avati <avati@lw.com>
Date:   Sun Dec 6 04:41:02 2009 +0000

    protocol/server: fix bad reference to @inode in server_link_cbk
    
    when op_ret is -1, gf_log refers to @inode which can be NULL. fix
    this to refer to state->loc2.inode instead
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 448 (server_link_cbk refers to @inode when op_ret is -1)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=448

commit 9cedbb537f648a38606d14c425caa952dd5d0049
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Fri Dec 4 20:43:01 2009 +0000

    Fix critical argument validation bug found during initial testing.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 437 (Fix critical argument validation check on Fedora11 systems)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=437

commit a2d7ca2ee22de61bf43525e4a8a2928ce6dd8851
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Fri Dec 4 20:42:55 2009 +0000

    lwfs-volgen honours now build level prefix.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 437 (Fix critical argument validation check on Fedora11 systems)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=437

commit b5da78348291435b2f711018c529c83dc824cff8
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sat Dec 5 16:35:14 2009 +0000

    liblwfsclient/chdir: assign op_ret the return value of libgf_client_chdir.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 446 (apache does not start in daemon mode on fedora core 11.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=446

commit 05140d5f3c84cde0f0a568a6deb000bb906174b2
Author: Amar Tumballi <amar@lw.com>
Date:   Sat Dec 5 22:04:32 2009 +0000

    corrected the stripe's stat structure return logic.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 340 (Kernel Compilation fail in stripe)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=340

commit 759d2ec189ce632022494baa478cc0d5256697e0
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Dec 4 15:16:05 2009 +0000

    performance/stat-prefetch: don't check whether previous lookups have been failed in sp_process_inode_ctx.
    
    We need this patch for following reasons:
       1. The inode used in the successful lookup call may not be the one passed to
          fops operating on path. This may happen, if revalidate of inode is failed,
          but the lookup itself succeeds (in case of reavalidate failures, fuse
          sends a fresh lookup using new inode) and since inode_link, if there is an
          inode already associated with a path retains it.
       2. Only fops that "wait" in stat-prefetch for a lookup which is already in
          progress, need to check for the result of the lookup they are waiting on,
          before resuming and sp_process_inode_ctx is _not_ used in such contexts.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 428 (looks like stat cache not upto date..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=428

commit d281971e5061d4a339b31340798d6f1dbff348be
Author: Anand Avati <avati@lw.com>
Date:   Sat Dec 5 06:03:04 2009 +0000

    fuse: fix leak in fuse_getxattr and fuse_getattr
    
    In fuse_getxattr, @finh was leaked in the case of posix ACL getxattr
    request
    
    In fuse_getattr, @state was leaked when fuse_loc_fill() failed
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 438 (Memory leak)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=438

commit 73ef824cbb8a468b70b57e503c98c226aed813a7
Author: Vikas Gorur <vikas@lw.com>
Date:   Sat Dec 5 03:06:40 2009 +0000

    cluster/afr: Fix inode_ref's for local->cont.lookup.inode
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 3e86687e74bdf4847f3e35063dfb46e9871d6959
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Dec 4 21:27:15 2009 +0000

    fix crash in server protocol server-connection-destroy
    
    a variable allocated inside a condition was getting reffered outside
    the block. If the condition fails, there used to be a crash.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 439 (crash in server protocol, while destroying connection)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=439

commit 89bbaa124af8c54bb7ca8b85ad5d40f0bb754e49
Author: Anand Avati <avati@lw.com>
Date:   Fri Dec 4 09:28:23 2009 +0000

    posix_rchecksum() - fix leak of read buffer
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 4439876a34f2e5d19db0d8b05ce7d7722c1c466f
Author: Anand Avati <avati@lw.com>
Date:   Fri Dec 4 08:12:43 2009 +0000

    protocol/client: return ENOENT if inode context is missing
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit cba270e7dfe271dfa43cd7127089b91dfedf838f
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Dec 4 06:04:37 2009 +0000

    mount/fuse: Refactored fuse_setattr.
    
    If both truncate & setattr need to be sent from fuse_setattr,
    they are now sent one after the other (setattr first, and then truncate)
    instead of being sent parallelly. The earlier code that sent them parallelly
    had a couple of problems:
    
    1) A bug in the logic that would sometimes cause the setattr call
       to never return, making the application hang.
    
    2) A possibility that truncate and setattr would race at the server/io-threads/posix
       end, thus returning the wrong stat structure to the application.
    
    This patch also removes an unneccessary "can_fuse_return" call in
    fuse_attr_cbk, which would cause a call to hang if STAT or FSTAT failed.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 05ad7717083057de819ad545591bffeb8af2f741
Author: Anand Avati <avati@lw.com>
Date:   Fri Dec 4 04:52:33 2009 +0000

    afr: fix memory leaks
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 349f9b77178aac3d2823bb35b0dc6c40b7a3b876
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Dec 3 21:47:23 2009 +0000

    performance/stat-prefetch: add "caller" arguement to sp_process_inode_ctx.
    
    - since sp_process_inode_ctx is called by many fops, if the context is not
        set "caller" argument can be logged in log msgs to identify caller.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 45494f35deb30b6e0410351bdea7cf10f8f83c04
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Dec 3 21:47:11 2009 +0000

    performance/stat-prefetch: implement sp_check_and_create_inode_ctx.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 4db7a358a294e11568ef818e64d5b3f37176609b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Dec 3 21:46:52 2009 +0000

    performance/stat-prefetch: refactor sp_lookup_cbk to use sp_update_inode_ctx.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 58535b168ca9d65a5c5018f89882d7c18d8f15fe
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Dec 3 21:46:40 2009 +0000

    performance/stat-prefetch: dont check for inode context in fops like create, mkdir.
    
    - context will not be set as a fresh inode is passed in each of these calls.
        instead create a new context.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 290a38912ce9f942f4ebdd24fcb0033214ecc537
Author: Anand Avati <avati@lw.com>
Date:   Fri Dec 4 03:50:47 2009 +0000

    protcol/server: server_connection_destroy - destroy frame after issuing flush
    
    frame was getting destroyed after unlocking, but before issuing flush. This
    could result in corruption if an fd was opened between server_connection_cleanup
    and server_connection_destroy because of pending open calls in io-threads at the
    time of POLLERR disconnection
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 430 (Server crash when client is killed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=430

commit e7b86dedcdde48e37a2d50370998d7285624bdb8
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Dec 2 18:18:35 2009 +0000

    features/locks: Process State Dump support for locks.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit aa53bb583d2d01867a2db1d217001fc897e2b835
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Dec 3 16:10:17 2009 +0000

    fixing some warnings on 64bit machine.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 408 (warning while building on 64bit machine..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=408

commit cec1f78d42f49f35448d81c944afb9afae19c959
Author: Pavan Sondur <pavan@lw.com>
Date:   Thu Dec 3 16:10:16 2009 +0000

    features/locks: Fix inodelk leak when issued an UNLOCK.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit f4983bb29be027e40fcd379d0a018b87cf82fc85
Author: Pavan Sondur <pavan@lw.com>
Date:   Thu Dec 3 16:09:22 2009 +0000

    storage/posix: Fix Leak in posix_getxattr while filtering gen-number xattr.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 54046015d3c732b48304c9a5ecf7a7f8ff94c90e
Author: Pavan Vilas Sondur <pavan@lw.com>
Date:   Thu Dec 3 14:51:12 2009 +0000

    mount/fuse: Print correct log message if encountered with errno - EAGAIN.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 26257254fb42c132ff2e0565655fdc382184d8af
Author: Pavan Vilas Sondur <pavan@lw.com>
Date:   Thu Dec 3 14:51:11 2009 +0000

    features/locks: Release all locks of an fd when a client disconnects.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 120b446967ef33701a31d0da23324177922a3d73
Author: Pavan Sondur <pavan@lw.com>
Date:   Thu Dec 3 14:51:10 2009 +0000

    features/locks: Changes in log messages reflecting lk-owner.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 83487d024bcfe671ef83752c8c3a8b56b8dcee2b
Author: Pavan Vilas Sondur <pavan@lw.com>
Date:   Thu Dec 3 14:51:09 2009 +0000

    protocol/server: Changes in protocol client to include lk_owner in protocol header.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 687311adfd08f55de5f70cc89d69c5da0f37a80f
Author: Pavan Vilas Sondur <pavan@lw.com>
Date:   Thu Dec 3 14:51:08 2009 +0000

    features/locks: Use owner field in inodelks.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 31b18f256fa3972a0cebc51cc15127440321c4c4
Author: Pavan Vilas Sondur <pavan@lw.com>
Date:   Thu Dec 3 14:51:07 2009 +0000

    features/locks: Use owner field for entrylks.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit e0c09ea80904a26ac932eec546d7675fc0d2cd08
Author: Pavan Vilas Sondur <pavan@lw.com>
Date:   Thu Dec 3 14:51:06 2009 +0000

    features/locks: Use lock_owner from fuse in posix locks.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 1c8aa56a1bcff7640b65102782641ab0d53861d2
Author: Pavan Vilas Sondur <pavan@lw.com>
Date:   Thu Dec 3 14:51:05 2009 +0000

    mount/fuse: Use fuse lock_owner field in posix locks.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 336 (Use lock owner field from fuse in locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=336

commit 4645dc9a0be85d64f0a19c4cc9cf8cdc24e24865
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Dec 3 08:11:36 2009 +0000

    mount/fuse: Handle the case when attribute_timeout is set to 0 in dictionary.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 252 (client coherence problem with locks and truncate)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=252

commit 6922f156d65e7426b90f6ae5ebf0fc87f162554c
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Dec 3 08:10:57 2009 +0000

    lwfsd: Handle argument attribute-timeout when set to 0
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 252 (client coherence problem with locks and truncate)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=252

commit 3208d63c0ffd1735bc95c6986b2a3ddd96ba71d6
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Dec 3 05:37:05 2009 +0000

    core: Change replicate trash directory name to ".landfill".
    
    The earlier name ".trash" conflicts with the name used by
    the trash translator.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 227 (replicate selfheal does not remove directory with contents in it)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=227

commit 5821d2cf591789760e790d4af0575d1b9754c08d
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Dec 3 05:15:09 2009 +0000

    core, client, server: Support auxiliary group ids
    
    Support for auxiliary group ids is needed for transmission
    of more than one group id right through the xlator tree
    so that posix can use these group ids to perform
    in-house permission tests. The in-house permission checks are
    needed so that we do not have to depend on non-POSIX calls
    like setfs[ug]id for changing the user for each fop.
    
    The setfs[ug]id  are also limited since they do not allow setting
    multiple group id as required for operation with NFS, which sends
    us all the group ids for a process issuing file system requests.
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 400 (Support auxiliary gids in LWFS)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=400

commit 930f709881d85774baab1df57c2c03de93110bf7
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Dec 3 03:57:15 2009 +0000

    cluster/afr: Don't mark the fop as failed if rmdir returns ENOTEMPTY.
    
    Marking the fop as failed in the ENOTEMPTY case led to spurious
    entry self-heals.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 326 ([2.0.8rc9] Spurious self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=326

commit 2615d1a9558868b0b247375fc7560ea399390516
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Dec 3 03:43:12 2009 +0000

    liblwfsclient: Separate order of path compaction and VMP search for abs and rel paths
    
    The previous set of changes for relative paths in liblwfsclient
    break the absolute path operation. The fix involves differentiating
    between absolute and relative paths in terms of the order
    in which the 2 operations are performed:
    
    - path compaction
    - VMP search
    
    For absolute paths, since we assume that VMP is already perfixed to the
    path, we need the following order of operation:
    
    1. VMP search
    2. path compaction on the path components beyond the VMP.
    
    For relative paths, the operations are reversed because there
    we do not have a VMP pre-fixed in order to perform a VMP search.
    This means that a path compaction combined with prepending of the
    CWD is needed to get an absolute path before the VMP is searched for.
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 0f73d6c94ce00eae317463fe32de40bb4225c820
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Dec 3 03:16:34 2009 +0000

    performance/stat-prefetch: don't access stat if lookup has been failed.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 429 (crash in lookup_cbk when lookup returns with error)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=429

commit d666c882cf6896fb700a15bd72e53c675356f8fc
Author: Erick Tryzelaar <idadesub@users.sourceforge.net>
Date:   Wed Dec 2 17:32:05 2009 +0000

    Hopefully fix rpm building for everyone by rm-ing *.a and *.la
    
    My Fedora 11 machine doesn't seem to make the .a files, so it errors out,
    but it appears someone else's machine does, so try to fix it by explicitly
    removing the .a and .la files, rather than excluding them from the %files
    section.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 0cac194a149871999072e8573d7eccc4b4723e0c
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Dec 2 18:19:53 2009 +0000

    Disable fusermount by default in configure.ac.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 343 (Placeholder bug for adding volgen into rpm, bdb makefile changes, etc)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=343

commit 29890d798167338c0aaa3a1bab26fe416ddadf19
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Dec 2 14:28:59 2009 +0000

    posix-compliance test now passes over stripe
    
    * needed to have ctime in the statbuffer from first subvolume.
    * unlink should be sent to all subvolumes no matter what.
      (earlier it was sent to all nodes only in case of regular files,
       causing directory not empty type of errors in 'rm -rf' cases)
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 321 (over distributed-stripe set-up, annihilate.sh fails.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=321

commit a3d5eb9b2a08190528b1e024bdfbff41c0a6b88f
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Dec 2 14:17:18 2009 +0000

    storage/posix: Change janitor sleep duration to 10 minutes.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 227 (replicate selfheal does not remove directory with contents in it)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=227

commit be762405e773ac25054cd08ba7f5760389db3bdd
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Dec 2 14:02:44 2009 +0000

    cluster/afr: Don't do transactional flush if pre-op has been nowhere done.
    
    If a pre-op has not been done on any subvolume at all, there
    is no reason to make flush a transaction call.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 427 (flush on a file opened read-only should not hold locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=427

commit 9cc2207e2ffc23e88c23a95bb0783156a85b57c4
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Dec 2 13:29:34 2009 +0000

    storage/posix: Filter out generation number xattr.
    
    Don't return the generation number xattr "trusted.<volname>.gen"
    in getxattr, since this can cause replicate self-heal to copy
    it over to another subvolume.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit e6c35f74ff4a204cf016ebf201a2630b331f9434
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Dec 2 12:17:32 2009 +0000

    performance/write-behind: Changed default value of option disable-till to 0
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 425 (Change disable-till default to 0)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=425

commit 494db717941e90ae209d416e00bf2c63490ba75e
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Dec 2 08:34:25 2009 +0000

    features/locks: Release blocked locks also when server requests to release all locks of a 'transport'.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit 7d740b2c01224019525fda01235f56c3a4416747
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Dec 2 12:20:10 2009 +0000

    cluster/afr: Add log messages when setattr fails in self-heal.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 14c5492a2c03728f18a20125b785f43f441dbfd5
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Dec 2 12:29:56 2009 +0000

    performance/stat-prefetch: get inode context from local->loc.inode instead of inode passed as arguement in sp_lookup_cbk.
    
    - @inode in sp_lookup_cbk may be NULL in case of failure of lookup.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 426 (stat on mount point hangs.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=426

commit 855a57a1f9c05d627c22f3091a7e0603d3e4092f
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Dec 2 10:28:34 2009 +0000

    cluster/afr: Fix conditional typo.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit c04c1a170dcc605efcf80c8ae2674b69488b591d
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Dec 2 07:48:45 2009 +0000

    storage/posix: Added janitor thread.
    
    The janitor thread deletes all files and directories in
    the "/" GF_REPLICATE_TRASH_DIR directory. This directory
    is used by replicate self-heal to dump files and
    directories it deletes.
    
    This is needed because letting replicate walk the directory
    tree and delete a directory and all its children is too racy.
    Instead, replicate self-heal only does an atomic rename(),
    and the janitor thread takes care of actually deleting them.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 227 (replicate selfheal does not remove directory with contents in it)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=227

commit 90328b827768552a05bb12abf62d09c9566309d1
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Dec 2 01:00:44 2009 +0000

    performance/stat-prefetch: fix access to inode table.
    
    - Access the inode table from one of fd->inode->table, inode->table or
        parent->table instead of from root xlators itable.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 67d6a0a6195a72bce251891fccbd38929d5586dc
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Dec 1 20:28:28 2009 +0000

    fixes to compile on MacOSX (no fuse client)
    
    These changes are required to make LWFS compile on MacOSX (10.5).
    
    Currently lwfs server component alone will work over Mac, and it has
    to be built with following options to ./configure.
    
     "bash$ ./configure --disable-fuse-client --disable-fusermount "
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 361 (LWFS 3.0 should work on Mac OS/X)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=361

commit 0c4b5814e7402658493f1e16ef7fa9a8fa8b4be5
Author: Amar Tumballi <amar@lw.com>
Date:   Sat Nov 28 03:09:02 2009 +0000

    bring new MOP called NOTIFY.
    
    which can be used as a bridge between client and server processes,
    when needed.
    
    This mop is needed now, so that many features in 3.0.0 can come in
    with this without bumping protocol version.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 201 (server should get notified about client 'umount')
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=201

commit 0a6b3ce3bf4acd994cb67c9c79b7c03909443bdd
Author: Anand Avati <avati@lw.com>
Date:   Tue Dec 1 20:06:18 2009 +0000

    afr: remove memcpy of @local contents in afr_local_copy
    
    copy out members which are needed. memcpy of full local causes
    a copy of pointers without references and results in various corruption
    errors
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit dc16ba6f79726e9c42d2309947ad805978375b8c
Author: Anand Avati <avati@lw.com>
Date:   Tue Dec 1 19:58:02 2009 +0000

    afr: fix fd reference leak
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 933e87700e25e83bcd5e9ba4c4f580d48fcaccee
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Dec 1 12:03:08 2009 +0000

    performance/io-cache: Hold locks on inode before creating rbt tree.
    
    Lock is held before creating a RBT in inode. Also, did some re-factoring.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 335 (Io-cache optimization)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=335

commit 6afe4faeaa77911490b2eca0830928367543e504
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Dec 1 14:39:45 2009 +0000

    liblwfsclient/read: break reads bigger than the iobuffer size into smaller ones.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 334 (lwfs_read/readv should break large-reads into 128Kb block sizes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=334

commit 435b234325bdcdcea88c3e1c7e9d97deeee3eb9a
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Dec 1 14:39:31 2009 +0000

    liblwfsclient/readv: break reads bigger than the iobuffer size into smaller ones.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 334 (lwfs_read/readv should break large-reads into 128Kb block sizes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=334

commit b491da7cc5fdcebdf641c5768685061221643611
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Dec 1 14:46:21 2009 +0000

    extras/benchmarking: port glfs-bm.c to master.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 422 (port glfs-bm to latest code-base)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=422

commit 8d9b1a1987840b5ab254db0ffe47663641d9ae15
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Dec 1 14:51:15 2009 +0000

    changed the version of lwfs from 2.1.0 to 3.0.0
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ade63327d7beaf6f8458aba9f8980e15016b6f31
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Nov 30 01:20:20 2009 +0000

    trash_ftruncate fop added
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 142 (enhance features/trash  translator so it can work on client side too..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=142

commit 4f7886034742709b285499aa0052fdb21e9c42f6
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Nov 30 01:19:10 2009 +0000

    trash_truncate fop added
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 142 (enhance features/trash  translator so it can work on client side too..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=142

commit 7bb52eb192f9541e70bf48a206c2d78b5dbb5cb2
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Nov 30 01:18:41 2009 +0000

    trash_rename fop added
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 142 (enhance features/trash  translator so it can work on client side too..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=142

commit 056e3e7a56a24291c6f07b9ef572ee8c8ff7c700
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Nov 30 01:18:09 2009 +0000

    trash_unlink fop added
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 142 (enhance features/trash  translator so it can work on client side too..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=142

commit 936001b147a3adcf9731d02e8f2fb62e5e50caf4
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Nov 30 01:16:35 2009 +0000

    features/trash initial cleanup commit
    
    * support O_TRUNC flag in open (call comes to FS as 'truncate'
      or 'ftruncate' fop)
    * option to provide 'eliminate-pattern' so those files matching
      won't be kept in trash. Eg:
          option eliminate-pattern *.out|*~
    * option to give 'maximum' file size to keep in trash, ie, when a
      20GB file is deleted, it won't be kept in trash if max file size
      given is 1GB. Eg:
          option max-trashable-file-size 1GB
    
    These particular features are developped as a part of college project
    by following team:
    
    Sunil bhagwath <sunilkbhagwat@gmail.com>
    Yashaswi Kumar <yashaswikumar@gmail.com>
    Rashmi B K     <rashmibk17@gmail.com>
    Sandeep M      <astrophyster@gmail.com>
    
    Submitting after minor coding standard edits and memoryleak fixes.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 142 (enhance features/trash  translator so it can work on client side too..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=142

commit 90cebe19380b4319e3a4345f31268563b51e08c3
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Mon Nov 30 01:17:22 2009 +0000

    Booster configuration fixed for per transport type and honours conf-dir option.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 421 (Make booster configuration honour conf-dir and transport type)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=421

commit 85ed82893aca7dd6307100660b9bba0233d52240
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Dec 1 06:11:06 2009 +0000

    cluster/afr: Don't do memcpy of afr_local_t in afr_local_copy.
    
    For the background self-heal frame's local_t, copy only
    required members --- not a wholesale memcpy. The memcpy
    lead to pointers being copied and then double free'd.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit cc57da87504621655d4acb7ec65e27f45b2b72d1
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Dec 1 06:11:05 2009 +0000

    cluster/afr: Set file size properly before unwinding from self-heal.
    
    Set the buf.st_size of the original frame's afr_local_t, and
    not the copy_frame'd one.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit ab99355f55ce8a55d5c9b339ced830723be5f213
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Dec 1 06:11:04 2009 +0000

    cluster/afr: Set the self-heal "source" as read subvolume even when not doing self-heal.
    
    This patch sets the read-subvolume equal to the self-heal "source"
    even if we're not doing self-heal (because some one else is already
    doing it).
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit d2a30ec4aaeaa546f6370a1377c44574ada5edbc
Author: Anand Avati <avati@lw.com>
Date:   Tue Dec 1 07:02:02 2009 +0000

    stat-prefetch: fix unsafe reference to @local in sp_lookup_cbk
    
    stat-prefetch uses the main syscall frame for performing lookup on
    demand. this causes a potential reference to a freed local in
    sp_lookup_cbk after resuming the main syscall frame (which could
    have unwound and destroyed)
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 242 (If any of the writes fail, write-behind should not wait till the fd is closed for reporting errors)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=242

commit d7e0bf1757e5fae23bce3d09cd0d9fbbd822a067
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 30 15:48:38 2009 +0000

    performance/stat-prefetch: make lookup to wait for the completion of another lookup on same path if one is in progress.
    
    - If current lookup (2) does not wait for completion of the lookup (1) which
        is in progress, there can be a race condition where (2) completes ahead of
        (1) and resuming all the waiting operations in the queue. When (1) returns,
        the original operation (eg., stat, chmod etc) might've already unwound and
        hence the frame would've been destroyed.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 47a8f97b729dd6bb2a2dabd3ed250ebbdf8be7fc
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 30 15:48:21 2009 +0000

    performance/stat-prefetch: don't use same variable for getting inode context of an inode and its parent.
    
    - this bug results in updation of flags in inode context of the parent
        instead of that of inode.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit cff970c45034f917a76182bc0a326d59f2cebd40
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 30 15:48:08 2009 +0000

    performance/stat-prefetch: fix errors in handling memory allocation failures in sp_inode_ctx_process.
    
    - the variables that are used for making decisions are assigned before
        memory allocations and these variables were not reset to
        correct values in case of memory allocation failures.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 2a3adcfe5c8d649a17b2d30f3715f26794dff6bb
Author: Csaba Henk <csaba@lw.com>
Date:   Sun Nov 29 19:26:57 2009 +0000

    fix leaks pointed out by cppcheck static analyzer
    
    See http://cppcheck.sf.net
    
    [./build/liblwfs/src/y.tab.c:2104]: (error) Memory leak: cmd
    [./liblwfs/src/md5.c:306]: (error) Resource leak: f
    [./xlators/debug/io-stats/src/io-stats.c:1396]: (error) Possible null pointer dereference: this - otherwise it is redundant to check if this is null at line 1402
    [./xlators/cluster/stripe/src/stripe.c:3597]: (error) Memory leak: dup_str
    [./xlators/debug/trace/src/trace.c:2426]: (error) Possible null pointer dereference: this - otherwise it is redundant to check if this is null at line 2429
    
    These appear in rarely hit error cases or test/demo code so nothing
    serious, in fact.
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 420 (fix leaks pointed out by cppcheck static analyzer)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=420

commit cc3967db49e5983f43530708c1eb4b2708546ad9
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Nov 30 04:35:09 2009 +0000

    cluster/afr: Preserve generation number along with inode in lookup and creation fops.
    
    This fixes fuse_create_cbk conflict warnings and random errors while
    running dbench (typically open handle failure with ENOENT).
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit d21e0108638bdde5f46361aadb370061293c8146
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Nov 30 02:27:12 2009 +0000

    cluster/afr: Refactored lookup_cbk and introduce precedence of errors.
    
    Error handling in afr_lookup_cbk was faulty because it
    did not give priority to errors such as ESTALE over ENOENT,
    and ENOENT over other errors. This patch fixes that, and
    also breaks up afr_lookup_cbk into multiple logical functions.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 205 ([ lwfs 2.0.6rc4 ] - Hard disk failure not handled correctly)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=205

commit 357e464ffee8cbed84e0c34727b9226adbdb7bd2
Author: Anand Avati <avati@lw.com>
Date:   Sun Nov 29 09:27:54 2009 +0000

    afr: fix crash in afr_sh_data_close
    
    when active_sink count is 0, the code proceeded into a dangerous loop
    resulting in a crash while issuing the call or in the callback
    afr_sh_data_setattr_cbk or afr_sh_data_flush_cbk
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 6c949d9d0ddc3397eac3207c0718743d49bd8707
Author: Anand Avati <avati@lw.com>
Date:   Sun Nov 29 07:45:20 2009 +0000

    protocol/server: enhance trace logging
    
    add logging of fop name, callid number and make logging more friendly
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 77a7250b16c119e20c2d5c66a80b559455953a47
Author: Anand Avati <avati@lw.com>
Date:   Sun Nov 29 07:37:32 2009 +0000

    afr: handle fdctx->pre_op_done handling
    
    reset pre_op_done[i] to 0 after issuing a postop in flush. this was
    missed during the introduction of pre_op_done[] array and was resulting
    in a lot of spurious self heals when spurious flushes were received
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 51600217be80dc9e1b1ad8bf20b7e5a95d31ec1c
Author: Anand Avati <avati@lw.com>
Date:   Sat Nov 28 05:34:41 2009 +0000

    afr: fix logic to break out of diff/checksum loop
    
    When checksum fop returns error, mark for terminating the loop at the end
    of the iteration (when all checksum calls of that iteration return) and
    not immediately
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 1ec37aa78fccb45aa701a3380f6acf95819c7a39
Author: Anand Avati <avati@lw.com>
Date:   Sat Nov 28 05:34:11 2009 +0000

    protocol/server: fix improper validation of fd in server_rchecksum
    
    state->fd validation should be done _after_ resolve_and_resume()
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 915299aff39c993fbe21e68e9458100db519535e
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sat Nov 28 11:04:19 2009 +0000

    performance/quick-read: add options to doc/translator-options.txt.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 419 (Issues with writing files of size >= 1MB)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=419

commit 79243bfdeeb328126d30da22fd48756a1bf65dd3
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sat Nov 28 10:52:37 2009 +0000

    performance/quick-read: change the maximum value of max-file-size to 1000KB from 1MB.
    
    - protocol restricts the maximum buffer size that can be received over network
        to 1MB. Since the buffer holding reply of lookup should also contain the
        lookup header and other key/value pairs of xattr_reply dict, the maximum
        file size that can be fetched through dictionary cannot be equal to 1MB.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 419 (Issues with writing files of size >= 1MB)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=419

commit 04da2ae78b83e1cb3e14379dd72d694fa03fc5e1
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Thu Nov 26 15:47:28 2009 +0000

    Excluding static libraries.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 413 (rpmbuild fails with unpackaged files)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=413

commit 4b363f1c968e7b9d2c339ea8e30dac5ca935da0e
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Thu Nov 26 15:42:26 2009 +0000

    Removed deprecated export_dir in print string.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 412 (Remove deprecated export_dir in print string)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=412

commit 07d5b01960a8fc7754d1957451210fff2ed4617e
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Nov 26 14:55:03 2009 +0000

    moved unify from 'cluster/unify' to 'legacy/cluster/unify'
    
    maintaining unify is not feasible, and its design of namespace is
    not scalable too. hence moving it to 'legacy/' directory..
    
    Thanks to unify, we learnt something about rename(). 'cluster/unify' has
    served LWFS well for more than 2years, and its the time to say
    goodbye :-(
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ff9944ff7910441a1f8b9784c153d5de5be62142
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Nov 26 13:36:34 2009 +0000

    performance/stat-prefetch: Changed rbthash to make use of 1 bucket
    
    rbthash makes use of 1 bucket and a common mem-pool is being used for all rbt entries.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 03949adaf0c7fcfe10f31a802723613b357ec191
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Thu Nov 26 12:08:44 2009 +0000

    Volgen rewritten using option parser and added proper support for booster.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 411 (Rewrite volgen using option parser and extend cifs/nfs support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=411

commit 9b2159c6111cff889c543fdaf7628fce03e50154
Author: Anand Avati <avati@lw.com>
Date:   Thu Nov 26 07:22:08 2009 +0000

    THIS: transport to use xlator_notify() for proper setting of @THIS
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit bf34a8714e6ab9dce0670c2648f839165904f2f7
Author: Pavan Sondur <pavan@lw.com>
Date:   Thu Nov 26 07:51:26 2009 +0000

    protocol/server: Introduce option trace to log requests and replies in normal log.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit e91b3c49e3ab8787513764dfdadf503bc9a5da1f
Author: Pavan Sondur <pavan@lw.com>
Date:   Thu Nov 26 07:50:49 2009 +0000

    protocol/server: Get all fops to use the new 'resolve_and_resume' path in server/protocol.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 63f963700f0c89292092047ec2423e8d8ab1f955
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Nov 26 06:37:30 2009 +0000

    Changed rbthash_table_init() to take a mem-pool argument.
    
    Changes in liblwfs/rbthash:
    
    rbthash_table_init() now takes a mem-pool argument.
    The mem-pool argument would be mutually exclusive to expected_entries.
    If expected_entries is provided, mem-pool would be ignored and vice-versa.
    
    Changes in io-cache:
    1) Moved rbthash creation to readv.
    2) rbthash makes use of 1 rbt instead of 4096
    3) A global mem-pool is being used in place of a mem-pool per rbt.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 335 (Io-cache optimization)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=335

commit a928aa5e0d65b9439b8a10eb9dede954220ba9f3
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Nov 25 21:29:25 2009 +0000

    fixes in nufa
    
    Now nufa uses dht_conf->private variable to store its
    contents, and doesn't pollute distribute's structures.
    
    It used to hang earlier as layout_lock was not INIT()'d.
    
    whitespace-cleanup done on the code too.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 409 (implement a switch scheduler)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=409

commit fc87b19f0bd511ee294c058ea9066189ca06ce88
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Nov 25 21:26:24 2009 +0000

    switch translator added
    
    switch translator is a wrapper around distribute to work for a
    pattern based scheduling.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 409 (implement a switch scheduler)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=409

commit 057c071403eb808b065e760d91101d519f86b65c
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Wed Nov 25 14:40:55 2009 +0000

    Volgen supporting multidisks and booster configuration for nfs and cifs
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 396 (Volgen multiple export directory support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=396

commit 3429e8755756191d010896083ca9a7141682ead9
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Nov 25 15:13:37 2009 +0000

    add an extra check for loc->parent when loc->ino is not 1
    
    This extra check is needed only in case where setup is
    "server -> chain -> client", where for the root inode, inode->ino
    is not updated in the first lookup call, hence used to crash.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 377 (segfault in protocol/client with chaining)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=377

commit 28e2901806d35055ca58470bf26d72edb803ba01
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Thu Nov 26 04:16:27 2009 +0000

    Fixed typo in gf_proc_dump for attribute_timeout.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 410 (Typo in gf_proc_dump for attribute_timeout)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=410

commit b80fac541701689b07940be518431bacb101f09f
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Nov 26 03:29:46 2009 +0000

    don't allow stripe with just one subvolume
    
    stripe code assumes in many places that it will have more than one subvolume,
    but the strict check was not there in init, hence, if somebody configures stripe
    with just one subvolume, it will cause many fops with frame loss.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 340 (Kernel Compilation fail in stripe)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=340

commit d1f3cdc4dcae63b1bb8e6fd6ff0db791646e2ad2
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Nov 26 00:53:49 2009 +0000

    protocol/server: Changed logging level of message on deep resolution
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 61a73726a51936fb59245a0ba9511c4907306130
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Nov 26 00:38:28 2009 +0000

    changed the log level of failure case in client_setvolume_cbk
    
    It *should* be an error when a handshake fails. Its hard to debug
    it otherwise
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 26 (Version mismatch not handled correctly)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=26

commit 25c220cf505c71139afe0cefe5a04b7e435f77ba
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Wed Nov 25 13:15:36 2009 +0000

    Added boundaries for each fops, mops and cbks.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 366 (Infinite loop with centralized logging.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=366

commit 2517ec18aeae5d6952aace778dacdd1cde93efe0
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 10:08:54 2009 +0000

    cluster/afr: Include "common-utils.h" instead of alloca.h
    
    alloca.h should be included on a platform-specific basis.
    Lets common-utils.h handle that.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 349 (FreeBSD compilation error (alloca.h).)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=349

commit 1c6a55b04c418106cf2be5156fa8e53b1adaa1b4
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Nov 25 02:19:31 2009 +0000

    protocol/client: Make log message print both generation number and inode number.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 1bcb009cf65e57117653bbbb5cdf673f9d9142e9
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Nov 25 07:51:23 2009 +0000

    cluster/afr: Do self-heal on unopened fds.
    
    This patch completes the previous patch for self-heal of
    open fds in replicate.
    
    If an fd was never opened on a subvolume, we remember that
    and do the open after we've done self-heal on that fd.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 9806bd1f58d80d158e3cfb6edee40e92ee30c6d7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Nov 24 20:47:00 2009 +0000

    performance/stat-prefetch: Add refcounting to cache objects
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 405 (Segmentation fault in stat-prefetch.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=405

commit ca4c8115a839568405e1dea2f4bda01f43357921
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Nov 24 20:46:48 2009 +0000

    performance/stat-prefetch: remove lock member in sp_fd_ctx_t.
    
    - since the lifetime of fd context can be no longer than the fd, we can use
        lock in fd.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 405 (Segmentation fault in stat-prefetch.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=405

commit 81af21adec38eb04de19694af1b3ce8a1a095ab7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Nov 24 20:46:34 2009 +0000

    performance/stat-prefetch: don't free the cache in readdir if the offset is not the expected one.
    
    - cache creation is expensive operation. Also, cache will be freed in
        releasedir. Hence, just remove all entries from cache without freeing
        the cache. However this is not entirely true, since sp_cache_remove_entry
        frees the old table and reinitializes a new table if all entries are being
        removed. When rbtree based hash table provides an interface to remove all
        the entries, sp_cache_remove_entry should be modified not to destroy the
        table.
    
      - this patch also fixes a race condition wherein the cache being used in
        lookup getting freed in readdir if the offset is not equal to expected
        offset.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 405 (Segmentation fault in stat-prefetch.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=405

commit 250edc9e494fe0c59eff580df18080111ecb475e
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 08:45:10 2009 +0000

    cluster/afr: Refactored the self-heal interface.
    
    Cleaned up the self-heal interface to callers.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 74612a456ad1602f8038fae79fee654eb427602a
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 08:45:09 2009 +0000

    cluster/afr: Do self-heal on reopened fds.
    
    This patch brings in partial support for self-heal of open
    fds. The precondition is that the fd should have been opened
    successfully during the initial open() (or create()), and we
    assume that protocol/client has successfully reopened the fd
    when the subvolume comes back up.
    
    It works by doing an "up/down flush" (a dummy flush transaction
    to do post-op wherever necessary) and then triggering
    data self-heal on the file in the post-post-op hook of the
    dummy flush transaction. This ensures that any writes
    that come in during self-heal will wait until self-heal completes.
    
    The up/down flush is also done when a subvolume goes down,
    so that post-op is done on all subvolumes where pre-op was done.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 218959e0597b16755a98b19786ed6a42cd15cbc4
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 08:45:08 2009 +0000

    cluster/afr: Provide a post-post_op hook in the transaction.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 9e3fddb13769288ddc13db3125b8bedf26058cdf
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 08:45:07 2009 +0000

    cluster/afr: Refactored the data self-heal algorithm.
    
    Refactored the operation of the data self-heal algorithm
    as:
    
    * open all fd's (if fd not supplied by caller)
    * lock 0-0 (if lock not supplied by caller)
    * fxattrop, fstat (instead of lookup)
       ... self heal ...
    * unlock (if lock not supplied by caller)
    * close (if fd not supplied by caller).
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 21cffbc219efc36229002e71a02b9270cfee9186
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 08:45:06 2009 +0000

    cluster/afr: Hold blocking locks for data self-heal.
    
    Data self-heal now holds blocking locks, and instead of locking
    on all subvolumes, it only locks on {data-lock-server-count} subvolumes.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit a63e189822a777b450eeaeda8622cdb0e5e7cb1d
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 08:45:05 2009 +0000

    cluster/afr: Set read-child = source regardless of foreground/background self-heal
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 3fe840d93730f1f7feef053e58dfbc40f99cae04
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 07:41:36 2009 +0000

    cluster/afr: Fix inode context bitmasks.
    
    Set opendir_done and split_brain flags correctly
    in the inode context.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 249 (Self heal of a file that does not exist on the first subvolume)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=249

commit 4a43031ce0f045b673a50159dce5316bcae825ee
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 06:07:16 2009 +0000

    cluster/afr: Fix double-free in opendir self-heal callback.
    
    local->cont.opendir.checksum was being free'd both in the
    self-heal completion function and self-heal unwind.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 249 (Self heal of a file that does not exist on the first subvolume)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=249

commit 6adfd865588bdcf5ea67e8bde61dce131d18108c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 23 18:57:40 2009 +0000

    performance/quick-read: use STACK_UNWIND_STRICT for unwinding.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit fe34bb798cbadc964447ad2fd60a870dc2891572
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 23 18:57:33 2009 +0000

    performance/write-behind: use STACK_UNWIND_STRICT for unwinding.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 9aed8cd65940f99c9cdf647414d932750d2caf2d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 23 18:57:27 2009 +0000

    performance/read-ahead: use STACK_UNWIND_STRICT for unwinding.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit afdc2c956912d8b01db414fceacd74d9c3ab3dbe
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 23 18:57:21 2009 +0000

    performance/io-threads: use STACK_UNWIND_STRICT for unwinding.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 8b8205c2be7ea70b9eaab8da3cec5ec7e830c516
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 23 18:57:13 2009 +0000

    performance/io-cache: use STACK_UNWIND_STRICT for unwinding.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 54188f9d8878b2a961050e001658f35e163caebc
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Nov 23 18:56:22 2009 +0000

    performance/stat-prefetch: use STACK_UNWIND_STRICT for unwinding.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 7c6bc261e7d60bb1c4103c2e2e64a8ab89aa66e9
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Oct 14 14:07:51 2009 +0000

    cluster/afr: Unlock only those paths which have been locked during rename.
    
    For ENTRY_RENAME_TRANSACTIONs, keep track separately whether the
    lower_path and the higher_path have been locked, and unlock only
    those which have been.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 112 (parallel deletion of files mounted by different clients on the same back-end hangs and/or does not completely delete)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=112

commit 1cd2e389020b8713d45dce44df9f473622109b0d
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 24 04:46:35 2009 +0000

    cluster/afr: Fix handling of revalidate lookups.
    
    This patch does two things related to revalidate:
    
    1) If a revalidate fails on any subvolume, the entire lookup
       call is failed.
    
    2) Self-heal is not triggered on a revalidate if revalidate
       has failed on any subvolume.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 389 (auto-heal fails randomly and causes "Stale NFS file handle" errors)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=389

commit 5b483cb62f00faa66e8795e24856600b961c8d4a
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Tue Nov 24 03:40:53 2009 -0800

    Revert "liblwfs/src/gf-dirent.c: In gf_dirent_nb structure d_name should be char array of size 1."
    
    This reverts commit e151ab3ed4718606767146f18b416f8900552fbc.

commit 40dfc3e78b590af907caa8a4461730284648034c
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Nov 20 07:35:45 2009 +0000

    storage/posix: Fix condition typo.
    
    Do comparision instead of assignment in if-condition
    in posix_link.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 254 (storage/posix has to do inode number transformation wherever it unwinds with a stat structure)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=254

commit 96ac4559414035288fa18e72a21628ea3cdf6a4c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Nov 19 17:28:00 2009 +0000

    performance/io-cache: don't use stat got in read_cbk if it is zero-filled.
    
    - translators like io-cache, read-ahead return a zero-filled stbuf in
        readv_cbk and usage of zero filled stat for cache validation is not
        correct.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 376 (server-side io-cache is preventing client-side io-cache from working)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=376

commit 83598e6015d76e2bebd0a3ad5141801a2864af1c
Author: Paul Rawson <plrca2@gmail.com>
Date:   Tue Nov 17 00:13:24 2009 +0000

    Fix Redhat init file so that it knows the correct binary location
    
    Signed-off-by: Paul Rawson <plrca2@gmail.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 388 (Redhat initfile fix)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=388

commit 9503af54284e27104051cc7eafffd3f138c28851
Author: Erick Tryzelaar <idadesub@users.sourceforge.net>
Date:   Mon Nov 16 13:27:30 2009 +0000

    Fix rpm building for Fedora 11.
    
    I was running into a problem compiling lwfs on Fedora 11, rpmbuild was
    complaining that it couldn't find any .a files. Since it doesn't look like
    lw's creating archive libraries anymore, I removed this line from the
    spec file, and lw started to compile again.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 717faf468fcac827d00c81c76ac53057c43e28fa
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 15:07:22 2009 +0000

    transport/ib-verbs: assign to qpreg before accessing it in __ib_verbs_lookup_peer.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 381 (lwfs crash in ib-verbs)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=381

commit 68a9546e5ce01e6fefc8ae97d5d7e27da1f6d52a
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 00:29:17 2009 +0000

    performance/stat-prefetch: don't cache dentries corresponding to directory.
    
    - distribute picks up the inode number from hashed subvolume. But readdir
        is done from different subvolumes based on the offset. Hence there is a
        possibility of inode number and device number for directories being
        inconsistent between two stat calls.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 371 (rm -rf fails on stat-prefetch.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=371

commit d14d014782dd4d7023f99a054d0c4db37d020435
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 00:29:05 2009 +0000

    performance/stat-prefetch: don't use pre-allocated dirent structure in sp_get_cache_entry.
    
    - since we don't know the size of dentry before calling sp_get_cache_entry,
        we must dynamically allocate the dentry in sp_cache_get_entry and copy the
        contents from cache.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 371 (rm -rf fails on stat-prefetch.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=371

commit 892710a37abcb10fdcff395a4369efce2af4c63f
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 00:28:49 2009 +0000

    cluster/distribute: copy the stat structure while copying dentries in readdirp_cbk.
    
    - only the transformed inode number was being copied, leaving other fields of
        stat 0.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 371 (rm -rf fails on stat-prefetch.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=371

commit dd216deb8a9e281ec41867c354efb0067cde4785
Author: vinayak hegde <vinayak@lw.com>
Date:   Thu Nov 19 01:39:39 2009 +0000

    debug/error-gen: Correct log messages in init function.
    
    Signed-off-by: Vinayak Hegde <vinayak@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 291 (feature enhancement of error-gen translator)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=291

commit 6148894110fd83d020e92b49b9b6f2532d7c7a99
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Nov 18 01:11:11 2009 +0000

    Check for other return values as well from call to inode_path.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 7a5325d284a850f4a18de8795f88e45816bfaf4f
Author: vinayak hegde <vinayak@lw.com>
Date:   Tue Nov 17 06:17:04 2009 +0000

    cluster/stripe: Wrong variable is checked after calloc.
    
    Signed-off-by: Vinayak Hegde <vinayak@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 368 (setattr on a non-regular file makes lwfs crash)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=368

commit 5cd0d1c7447c6947e81c659635a472a97d41303d
Author: Vijay Bellur <vijay@lw.com>
Date:   Mon Nov 16 13:08:31 2009 +0000

    protocol/client: Changed default ping-timeout to 42
    
    This change is necessary to avoid frequent disconnections between client and server under load.
    A disconnect-connect sequence is costly in terms of clean up and re-building of context,
    self-heals etc. This value should be optimal for most use cases. Users requiring a lower
    ping-timeout value need to configure it explicitly.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 384 (Increase default timeout in client protocol)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=384

commit 916ca4d87c410c075a622fc24848ba06868c280a
Author: Pavan Sondur <pavan@lw.com>
Date:   Tue Nov 17 05:24:03 2009 +0000

    Do not access a free'd lock while releasing all inodelks of transport.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit 7a6b1de614c6db02eeb437c06fd2568ccea7d34e
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Nov 18 07:02:25 2009 +0000

    cluster/afr: Handle op_ret properly in opendir_cbk
    
    Change the success condition to op_ret >= 0 instead
    of op_ret == 0.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 249 (Self heal of a file that does not exist on the first subvolume)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=249

commit 71d6a1c8aaa82780bdf4191732216ac1f5c57e65
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:20:41 2009 +0000

    liblwfsclient/umount: fix double free.
    
    - calling lwfs_fini results in double free.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 9d9cbb893661763783f2e4fb8093ff7f0a720143
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:20:30 2009 +0000

    liblwfsclient: don't change the st_dev in stat-structure before doing inode_link.
    
    - st_dev is used for storing generation number of the inode in
        inode_link and libgf_iattr_transform changes the st_dev to fake_fsid.
        If inode_link is done after libgf_iattr_transform, the generation number
        stored will be wrong and will result in ESTALE errors from server.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit ed75d6588899b3a812818e82ac7805998dbbd5e0
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:20:15 2009 +0000

    liblwfsclient/open: don't send create call if the file is already present, instead send open.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 80f89493ce2d78095a2df64e48c7bd7291b4558d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:20:02 2009 +0000

    protocol/server: add debug messages.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 9e481a7aee95cc7aebba8843820069909f21fe07
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:19:50 2009 +0000

    liblwfsclient: update iattr cache only if operation was successful.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 2bf35da812016c8adb05b0aa90c9f0b25e50a878
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:19:37 2009 +0000

    liblwfsclient: fix memory leak.
    
    - lwfs_glh_getxattr was implemented using libgf_client_lookup. Hence the
        inode corresponding to the path on which getxattr was done was refed twice
        - one during path_lookup and the other in libgf_client_lookup - but unrefed
        only once.
      - with inode generation number changes the inode returned by inode_link may
        not be the same as the input argument. Hence the inode returned by
        inode_link should be used, not the one returned in libgf_client_lookup_cbk.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 64a4b1f78ee719f33928f4de9abac2a09ce84f21
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:19:22 2009 +0000

    booster: implement xattr related apis.
    
    - implement setxattr, fsetxattr, lsetxattr.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 95d31d089ed8e8a1bb90377160ac0bccdd47b6c0
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:17:49 2009 +0000

    liblwfsclient: change the prototype of lwfs_lsetxattr.
    
    - it no longer needs handle to be passed as arguement. handle is searched
        in the vmp table based on the path.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 8d22d68815fbd27e7ef1b4b2f5bb70c3d82ddb96
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:17:36 2009 +0000

    liblwfsclient: fix __do_path_resolve to return zero if the path happens to be resolved in path_to_parenti.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 134d85015b0251ddc079678e1e0997cb41d0516b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:17:25 2009 +0000

    liblwfsclient: getxattr should return the length of the xattr when size is zero
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 1f1d1569f4bcd8acbfb80e0bdd11b752cdead637
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:17:14 2009 +0000

    liblwfsclient/ftruncate: add braces to ensure proper evaluation of if conditional.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 6b65a11e4e1e351a85cddd86f18b320addec49fb
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:16:57 2009 +0000

    booster: implement creat64.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 1e401ee2a94091154d114c11b55853bda3f49e29
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:16:45 2009 +0000

    booster: implement truncate and truncate64.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 9c5547193f637cb52cbb91c0409dd3580acafdcb
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:16:33 2009 +0000

    liblwfsclient: implement lwfs_truncate.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit a0c05848d2ed0b0600d73214594a161cbb42302c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:16:12 2009 +0000

    booster: implement ftruncate64.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit a33380068a9ab9eea80a6d0b6207d9e3cc9bdff4
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:16:01 2009 +0000

    liblwfsclient: fix libgf_vmp_virtual_path. - This procedure used to return garbage as virtual path if the path happens to be exact mount point but without the trailing slash and the vmp had a trailing slash.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit eb4043706c901f8609e65c9a35463ea3f7e2c569
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:15:46 2009 +0000

    booster: implement getcwd.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit c7dba5ff1468f5e56d22b47cc97ff6cd4937f98f
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:15:30 2009 +0000

    booster: implement fchdir.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 119b179fdc83d49e8242a93439fb043990eb74c9
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:15:11 2009 +0000

    booster: implement chdir.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 3940cf2fc26ed0d2417caef87ff25d17ec8d3bb4
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:14:58 2009 +0000

    liblwfsclient: implement lwfs_getcwd.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 7894bef2174945af06dceb506d501b8e789342fd
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:14:42 2009 +0000

    liblwfsclient: implement lwfs_fchdir.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit d779e00360e7a30d721b3c2d8d94d198e5aa2cc0
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:14:24 2009 +0000

    liblwfsclient: implement lwfs_chdir.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 43ffa430d64117e8864d38cf19202369d4809c6d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:14:04 2009 +0000

    liblwfsclient: Support relative paths.
    
    - This patch is a port of the patch with same title on 2.0 branch.
        The original patch was sent by Shehjar <shehjart@lw.com>.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 8cf1cd070e794f18ed5ec28d5a3cb758fa8bf0f2
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 18 01:13:38 2009 +0000

    Revert "booster, liblwfsclient: Support samba specific relative paths"
    
    This reverts commit e6fc0cbe716a18f02891d3911481fdcb121d8840.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 369 (Samba does not work with booster.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=369

commit 8f0ec7204d4b79dfb9fcf5f61df6275f6d4896fb
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Nov 18 05:20:08 2009 +0000

    liblwfs: Fix error handling in _gf_log.
    
    Unlock the mutex when an error occurs instead of jumping
    straight to "out".
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 394 (Possible deadlock in _gf_log)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=394

commit 4b233c6341134d11b170fa4cdbafc49246b46975
Author: Csaba Henk <csaba@lw.com>
Date:   Mon Nov 16 02:59:04 2009 +0000

    Upgrade FUSE protocol to rev. 7.13
    
    2.6.32 will feature FUSE proto 7.13 which lets us tune the maximal number of
    in-kernel backgrounded requests via INIT.
    
    Hereby we live up to this enhancement.
    
    Signed-off-by: Csaba Henk <csaba@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 385 (Upgrade FUSE protocol to rev. 7.13)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=385

commit 0c7597a1339f1a6762505cfe7292202a0db196a6
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Nov 13 16:08:15 2009 +0000

    transport/ib-verbs: fix race-condition resulting in freeing of transport while it was still being used.
    
    - while handling a failed work completion status, the transport is
        disconnected. But further down in the code, the transport is still
        used. There can be a possibility that transport might've been freed
        by the time control reaches this point. More detailed description of
        events leading to this situation can be found at
        http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=381
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 381 (lwfs crash in ib-verbs)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=381

commit d67322fdfa27746f82fb6e37ffe57efde9bfa021
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Nov 13 16:07:50 2009 +0000

    transport/ib-verbs: synchronize ib_verbs_recv_completion_proc with ib_verbs_receive so that the former doesn't overwrite the pointer from which latter reads.
    
    - There can be a condition wherein,
        1. the thread executing ib_verbs_recv_completion_proc (thr 1) stores the
           buffer pointer and notifies the upper translators about a POLLIN event.
        2. the thread waiting for events on socket (thr 2) calls transport_receive,
           but in ib_verbs_receive it has not still read the data.
        3. thr 1 receives work completion event for another work request and
           overwrites the buffer pointer.
        4. thr 2 reads from the new pointer there by missing the data stored in
           buffer pointed by pointer which got overwritten.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 382 (Data can be lost before it is read in ib_verbs_receive.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=382

commit 63e966d8c466599f84affb55fbedfb39e2a0068f
Author: Amar Tumballi <amar@lw.com>
Date:   Sun Nov 15 21:39:20 2009 +0000

    fixing a crash in posix (on 32bit)
    
    fd_ctx_get () was getting passed with type punned argument, now
    corrected by passing the right argument, and doing the typecasting
    later
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 383 (lwfs server crash on 2.0.8)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=383

commit 91f8b2a1668a4c63e0c21df4f7ac6dfb506f79d7
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Nov 13 14:00:40 2009 +0000

    fixes in stripe
    
    * fix in stripe readv, so that a read request which falls in
      two (or more) subvolumes, depending on stripe-size works fine.
    * fix in stripe_setattr_cbk, where 'postop' stat structure was
      returning wrong 'st_size'.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 368 (setattr on a non-regular file makes lwfs crash)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=368

commit 3c6647577f81568b7ad5cbf7435ef98aaa79e00a
Author: Vijay Bellur <vijay@lw.com>
Date:   Fri Nov 13 13:13:09 2009 +0000

    mount/fuse: Assign the right inode to fuse_entry_out in fuse_create_cbk().
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 380 ([3.0.0 pre1] Crash in fuse_create_cbk)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=380

commit 5c9a8a92edbd011e4fd5ec8e5f77eb13d7d8b771
Author: Anand Avati <avati@lw.com>
Date:   Fri Nov 13 07:53:06 2009 +0000

    protocol/client: preserve open/create flags in fdctx for reopening
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 410909f31704db212174dff874f71621c3cb0576
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Thu Nov 12 04:06:04 2009 +0000

    Disabled centralized logging by default.
    
    Signed-off-by: Harshavardhana <harsha@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 366 (Infinite loop with centralized logging.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=366

commit adebbb2ba19e52b194a4050c2e43a6c92f19c605
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Nov 11 14:26:10 2009 +0000

    performance/quick-read: set return value to zero after successful init.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 374 (quick read fails to initialize if no options are given)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=374

commit 0486b355db0c014f49662ed593a7ab7e74c2cb59
Author: Pavan Sondur <pavan@lw.com>
Date:   Thu Nov 12 03:23:27 2009 +0000

    mount/fuse: Prevent a hang on the mount point if no server is up when the client is started.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 373 (Spawn fuse thread after a parent_up and wait and block until child_up)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=373

commit 2e7fc582cd590f747b0d3cae3d38bbbccffe6a25
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Nov 12 06:27:05 2009 +0000

    extras/lwfs-volgen: Make the script more user-friendly.
    
    Error messages now print more detail.
    Details of export/mount files written is also printed.
    
    Also adds a new option '--version'.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 343 (Placeholder bug for adding volgen into rpm, bdb makefile changes, etc)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=343

commit 53fd5927ea0dc2f7c9cd019002abdc3751135dcd
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Nov 12 08:40:37 2009 +0000

    cluster/afr: Fix self-heal loop driver termination logic.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 26fbaa23cafee4643b7604660762656c4a71684b
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Nov 12 08:44:16 2009 +0000

    cluster/afr: Ensure directory contents are in sync during opendir.
    
    The problem: If some files on the first subvolume disappeared
    without leaving a trace in the entry changelog (this can happen,
    for example, when an fsck has deleted files or when a hard drive
    is replaced), those files would never be self-healed even though
    they would be present on the second subvolume. This is because
    readdir is sent only to the first subvolume, and since the files
    don't appear in the directory listing, no lookup would ever be
    sent on them.
    
    This patch fixes this problem by doing a readdir on all the subvolumes
    during the first opendir on a directory inode. If a discrepancy in the
    contents is detected, entry self-heal in a special "force merge" mode
    is triggered on that directory.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 249 (Self heal of a file that does not exist on the first subvolume)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=249

commit 4717e5279e169a36a870a267039e788cf22602a8
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Nov 12 08:44:15 2009 +0000

    cluster/afr: Refactored inode context bitmasks.
    
    Defined symbolic constants for the bit masks and
    made 'split-brain' a single bit field in the ctx.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 249 (Self heal of a file that does not exist on the first subvolume)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=249

commit b526009f2f5ad813ec88602a3d4fd2ff322809a0
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Nov 12 08:44:14 2009 +0000

    mount/fuse: Do readdirp in fuse_readdir.
    
    Do the readdirp FOP in fuse_readdir. This is needed because
    dht_readdir is not "reliable", whereas dht_readdirp is.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 249 (Self heal of a file that does not exist on the first subvolume)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=249

commit 84a50d45b4502d7efb842b41560f4ae5d62e3d78
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Nov 12 08:44:13 2009 +0000

    cluster/dht: Do readdir in dht_readdir instead of readdirp
    
    The readdir call will not be used by applications (fuse will
    only ever send readdirp), but it will be used by
    afr to do directory self-heal at the time of opendir.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 249 (Self heal of a file that does not exist on the first subvolume)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=249

commit 18d85b59b9e8cc422c06e3ea94694d0cb2d26e1b
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Nov 12 19:48:54 2009 +0000

    fix a crash in debug/trace
    
    stat structure (which is an argument to function) was getting freed
    instead of string which actually should have freed.
    
    Signed-off-by: Amar Tumballi <amar@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 378 (trace segfault in trace_create_cbk)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=378

commit f9bb9dee5f92d50c4e87995680198e488a4f50ce
Author: Anand Avati <avati@lw.com>
Date:   Fri Nov 13 02:58:58 2009 +0000

    protoocl/client: file directory reopen support
    
    reopen files and directories which were open before a disconnection after
    reconnecting. operations on files/directories which could not be opened
    continue to return EBADFD
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 590e5879f819018aee63b800b0f66fd6ff49641d
Author: Anand Avati <avati@lw.com>
Date:   Fri Nov 13 02:58:25 2009 +0000

    protocol/client: whitespace cleanup
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 170 (Auto-heal fails on files that are open()-ed/mmap()-ed)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=170

commit 63ece0f8bc81c2ec145465ff132a18ca47e50be5
Author: vinayak hegde <vinayak@lw.com>
Date:   Wed Nov 11 22:52:01 2009 +0000

    cluster/stripe: Initialize frame->local before checking for directory or regular files.
    
    Signed-off-by: Vinayak Hegde <vinayak@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 368 (setattr on a non-regular file makes lwfs crash)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=368

commit 15a6e0be9bc1c56bd2a0a67c926b01f2f8631ae4
Author: vinayak hegde <vinayak@lw.com>
Date:   Wed Nov 11 07:13:06 2009 +0000

    cluster/stripe: Set local->inode value before referring it.
    
    Signed-off-by: Vinayak Hegde <vinayak@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 362 (LWFS crash while doing mkdir in stripe setup)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=362

commit 8b8691ef70f37d42100f502604ef94b8b9e5f5f8
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Nov 10 02:32:50 2009 +0000

    cluster/stripe: local was not being set in stripe_mknod_ifreg_setxattr_cbk()
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 367 (LWFS crash while doing mknod in stripe setup)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=367

commit 9bbe8d4cd989d331409e174cefd38caed41b0ea0
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Nov 9 14:17:34 2009 +0000

    core: Replace inode_search with inode_grep in inode_from_path
    
    This fixes a situation where the inode_from_path fails to
    return an inode even though the inode exists in the table.
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit c1bf268b28d5d5959295cf1a22bdb71d0a6a9687
Author: Sachidananda <sac@lw.com>
Date:   Mon Nov 9 08:33:25 2009 +0000

    Add unhashed-sticky-bit option to volume_options structure
    
    Signed-off-by: Sachidananda <sac@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 365 (unhashed-sticky-bit is not recognized)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=365

commit ef078a335980b5962239556e9b3a98f589662337
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Nov 4 01:23:18 2009 +0000

    Add lwfs-volgen to master, change fusermount options and other changes to rpm spec file.
    
    The patch has the following changes:
    * Rename lwfs-volgen.py and include it in the rpm spec file
    * Enable fusermount by default. Change fusermount configure option from disable to enable.
    * Remove BDB from configure.ac, essentially removing it from the normal build.
    * Remove all dependencies on fuse in the rpm spec file.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 343 (Placeholder bug for adding volgen into rpm, bdb makefile changes, etc)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=343

commit e98020d5f6f2f22f09d2c21d80ad8ceb6ae46284
Author: vinayak hegde <vinayak@lw.com>
Date:   Wed Nov 4 23:36:35 2009 +0000

    performance/stat-prefetch: In lookup_cbk do not set error no to EINVAL, when inode_ctx_get returns -1.
    
    Signed-off-by: vinayak <vinayak@laptop.(none)>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 360 (All fop fails when stat-prefetch is loaded on afr.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=360

commit f98e7524b4c442ae08c3a335d412b1eeccb5863b
Author: vinayak hegde <vinayak@lw.com>
Date:   Thu Nov 5 02:54:27 2009 +0000

    cluster/afr: In fop structure afr_readdirp is not correctly registered.
    
    Signed-off-by: Vinayak Hegde <vinayak@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 360 (All fop fails when stat-prefetch is loaded on afr.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=360

commit add4dd9623de51dd67ecb8450ad1a57894d92dc2
Author: vinayak hegde <vinayak@lw.com>
Date:   Thu Nov 5 02:53:48 2009 +0000

    performance/stat-prefetch: In sp_readdir_cbk op_ret value is not handled.
    
    Signed-off-by: Vinayak Hegde <vinayak@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 360 (All fop fails when stat-prefetch is loaded on afr.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=360

commit e151ab3ed4718606767146f18b416f8900552fbc
Author: vinayak hegde <vinayak@lw.com>
Date:   Thu Nov 5 02:53:03 2009 +0000

    liblwfs/src/gf-dirent.c: In gf_dirent_nb structure d_name should be char array of size 1.
    
    Signed-off-by: Vinayak Hegde <vinayak@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 360 (All fop fails when stat-prefetch is loaded on afr.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=360

commit 47da643a0e9d8786489fe3173de318732556b6f0
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Nov 4 02:03:05 2009 +0000

    Do not abort make install if a chown on the fuser-mount script does not succeed.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 343 (Placeholder bug for adding volgen into rpm, bdb makefile changes, etc)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=343

commit 7bd570a007202e6eb505091dba611b8320633a26
Author: Pavan Sondur <pavan@lw.com>
Date:   Tue Nov 3 11:08:32 2009 +0000

    Remove fuse_lowlevel.h from xlator.h in liblwfs.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 343 (Placeholder bug for adding volgen into rpm, bdb makefile changes, etc)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=343

commit 612aed4b6aab7447195c7e6715bbbf257b4c62f2
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Nov 4 00:15:20 2009 +0000

    liblwfsclient: Dont alloc root inode context
    
    ....because the lookup on root inode done a few lines before this
    call already allocates an inode context. This one just over-writes
    that context, results in invalidation of the cached iattrs.
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 354 (Stale file handle on unfs3 booster)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=354

commit f04b9fcfeb9b459552207031d003f801189d1cea
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Nov 4 00:15:19 2009 +0000

    liblwfsclient: Prevent root inode number clobbering
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 354 (Stale file handle on unfs3 booster)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=354

commit 51d105d63fa82dae5465d19598b489d453b3a902
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Nov 3 10:17:07 2009 +0000

    cluster/afr: Bail out of the self-heal driver loops as soon as possible
    
    Don't wait for the next recursive call to sh_{full,diff}_loop_driver
    to decide that we've reached the end of file, as the frame could
    have been destroyed by that time (if subvolumes are posix).
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit cd7a02533dbbc192cc117037cf39848d55210c83
Author: Pavan Sondur <pavan@lw.com>
Date:   Tue Nov 3 09:23:03 2009 +0000

    Remove unnecessary log message. It also accesses a freed lock after an 'unlock'.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit 2bda225433762f78c09c2a751b321eb9d94c37c6
Author: Corentin Chary <corentin.chary@gmail.com>
Date:   Tue Oct 27 12:57:35 2009 +0000

    transport/name.c: refine the address resolution logic when listen-host is not specified.
    
    - when listen-host is not specified and there are are no interfaces having
        adresses belonging to the address-family specified, listen at 0.0.0.0/::0.
    
      - this patch is necessary since with AI_ADDRCONFIG, getaddrinfo fails if there
        are no active interfaces for the address family specified and when
        listen-host is specified we still want the functionality provided with
        usage of AI_ADDRCONFIG.
    Signed-off-by: Corentin Chary <corentin.chary@gmail.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 339 (lwfsd fails to start when there are no active interfaces having address in the address family configured.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=339

commit 2a62b1748edcb8319e6ce36e72717c8154635db6
Author: Sachidananda <sac@lw.com>
Date:   Tue Nov 3 08:38:25 2009 +0000

    Wrong variable is checked after stat call.
    
    Signed-off-by: Sachidananda <sac@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 355 (Wrong variable checked after a stat call)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=355

commit c1aa64729130aab9b58925871768d6c9c7d6a4ba
Author: vinayak hegde <vinayak@lw.com>
Date:   Mon Nov 2 23:41:26 2009 +0000

    configure.ac: Before checking for liblwfsclient BUILD_LIBLWFSCLIENT should be initialized to no.
    
    Signed-off-by: Vinayak <vinayak@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 353 (./configure adds liblwfsclient when it shouldn't)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=353

commit 7269a745125d46d52f31a4550136690fd0166355
Author: Vijay Bellur <vijay@lw.com>
Date:   Mon Nov 2 03:24:10 2009 +0000

    storage/posix: Changed error message displayed for option background-unlink.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 352 (Wrong message logged for option `background-unlink')
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=352

commit f8a56c6322d729fcdb96c754dd421fffb025e3bb
Author: Vijay Bellur <vijay@lw.com>
Date:   Mon Nov 2 00:34:10 2009 +0000

    features/locks: Do not try to set value in dict when lookup has failed.
    
    lock-count was being set without checking for op_ret from lookup. This would
    cause a lot of Critical messages in the log as dict would be NULL in case
    of a lookup failure.
    
    Also, removed some trailing white spaces and did some minor re-factoring.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit b4b20984721e169763a5ac26ffb9353d1ca3568a
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Oct 30 05:27:50 2009 +0000

    cluster/afr: Don't try to self-heal if there are locks held
    
    If the inodelk_count or entrylk_count is positive on a
    file/directory, don't try to do self-heal on it.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 326 ([2.0.8rc9] Spurious self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=326

commit 2b610a095febf0e89e5341c575b5579c78a009a3
Author: Corentin Chary <corentin.chary@gmail.com>
Date:   Thu Oct 15 06:32:41 2009 +0000

    volgen: remove trailing whitespace
    
    Signed-off-by: Corentin Chary <corentin.chary@gmail.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ef79f934c38743f3618c00bc24043a484f284a47
Author: Corentin Chary <corentin.chary@gmail.com>
Date:   Thu Oct 15 06:32:40 2009 +0000

    volgen: Add conf-dir option
    
    Add a conf-dir option to change the output directory for
    generated files.
    
    Signed-off-by: Corentin Chary <corentin.chary@gmail.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 0e7875dbf8f70904257725fd4d2be30333da84a2
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 30 03:43:54 2009 +0000

    core: Use parent for condition to create dentry not name
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 348 (touch on booster segfaults)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=348

commit 44f6b7a54224dde7e1663f435f05a6a5cac25a7b
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 30 03:28:40 2009 +0000

    booster: Must check errno for error number not return value
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 346 (booster returns success on failed getxattr and lgetxattr)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=346

commit 10cddf14e9f7a7446ea48bedb07ee9e7d0f21e4f
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 30 03:28:39 2009 +0000

    core: Check for NULL to avoid segfault
    
    A segfault as a result of this was observed during tests.
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 348 (touch on booster segfaults)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=348

commit e6fc0cbe716a18f02891d3911481fdcb121d8840
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 30 03:28:38 2009 +0000

    booster, liblwfsclient: Support samba specific relative paths
    
    Signed-off-by: Shehjar Tikoo <shehjart@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 158 (liblwfsclient: Applications are restricted to using absolute paths)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=158

commit 5d9a4d81b3928e6af15aaeb7fab18fb451f7abcc
Author: Anand Avati <avati@lw.com>
Date:   Fri Oct 30 03:15:19 2009 +0000

    iobuf: initialize size without 4KB padding
    
    since new fuse bridge takes care of landing write buffers to aligned iobufs
    and the 4KB header padding is no more necessary
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit bee7b8877dfbc321637e00106c073fecdd0847f0
Author: Anand Avati <avati@lw.com>
Date:   Fri Oct 30 03:15:02 2009 +0000

    lwfsd: whitespace cleanup
    
    Signed-off-by: Anand V. Avati <avati@blackhole.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit ef2d6b3449ab9cf0cf653b7b84595521db63a412
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Oct 30 01:26:19 2009 +0000

    liblwfsclient: don't do inode_link on root inode.
    
    Signed-off-by: Raghavendra G <raghavendra@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 348 (touch on booster segfaults)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=348

commit 8345b6448d292a8da4464debb4dc65b55f1f6eeb
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Oct 30 00:10:20 2009 +0000

    performance/io-cache: change the data-types to be big enough to hold size of data flushed.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 335 (Io-cache optimization)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=335

commit e16f05a6d1f756f16e363d93f432f950901cf777
Author: Pavan Sondur <pavan@lw.com>
Date:   Fri Oct 30 01:45:20 2009 +0000

    Fix logic while granting blocked entrylks, which could run into an infinite loop.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit c68255daa11937b7f91de11f8d4361d798aa8cbc
Author: Anand Avati <avati@lw.com>
Date:   Thu Oct 29 22:53:57 2009 +0000

    call-stub: fix leak of fxattrop dictionary
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 382b4d03ab029a94f29231e19db9996596985bb7
Author: Anand Avati <avati@lw.com>
Date:   Thu Oct 29 22:53:28 2009 +0000

    protocol/server: fix leak of xattrop dictionary
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit d72c47cb04725c694921e7f3277f6230c26bc936
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 29 05:08:34 2009 +0000

    cluster/afr: Move deleted files to /.trash in entry self-heal.
    
    If entry self-heal determines that a file/directory should
    be deleted from a subvolume, move that entry to a directory
    called "/.trash" on that subvolume. This is for two reasons:
    
    1) It limits the damage that can be done by a "wrong" entry
       self-heal.
    
    2) It solves the problem of a to-be-deleted directory not
       being empty.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 227 (replicate selfheal does not remove directory with contents in it)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=227

commit 14962ce3e69e452a2447c12cde3369759365fda9
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Oct 28 04:46:25 2009 +0000

    performance/io-cache: change the hash function used for rbtree based hash table.
    
    - the earlier hash function does not distribute pages uniformly for offsets that
        fit into 32 bits. The reason is that the hash function just xors the contents of
        the key 4 bytes at a time with the current value of hash. Hence for keys that
        fit into 32 bits, the hash will be the key itself. Since we are using the
        rounded_offset (which is a multiple of 128KB) as the key, the key will
        be exactly divisible by the number of buckets configured (4096) resolving all
        the pages into the first bucket.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 335 (Io-cache optimization)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=335

commit 13e6947744e8a26d2380af200942fd4ed61fd845
Author: Pavan Sondur <pavan@lw.com>
Date:   Thu Oct 29 05:06:58 2009 +0000

    Remove unnecessary check of xattr_req in lookup.
    
    Signed-off-by: Pavan Vilas Sondur <pavan@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit c770322ca4c9ccf50530d6a05ac4107fa1236f60
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 29 07:32:46 2009 +0000

    storage/posix: Serialize do_xattrop.
    
    Hold a lock on the inode for the getxattr/add-array/setxattr
    section since multiple threads can enter into it causing
    wrong values to be written and triggering spurious replicate
    self-heal later.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 326 ([2.0.8rc9] Spurious self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=326

commit 32c963cfea91e196ee1ebf98a5579989c53fdc6c
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 29 07:32:26 2009 +0000

    storage/posix: Refactor xattrop
    
    Move common code into do_xattrop.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 326 ([2.0.8rc9] Spurious self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=326

commit 6e2dba2c418cd09206b390fad0f413fc287b93ee
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 29 09:09:15 2009 +0000

    protocol/server, mount/fuse: Handle returned inode in create properly
    
    Check if linked_inode is different from returned inode in create,
    and if so, make the fd point to the correct inode.
    
    Signed-off-by: Vikas Gorur <vikas@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 347 (Assertion failed: inode->ref)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=347

commit c555dcbb3a41f47149035c1d9ea95f67812db8c8
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Oct 29 05:59:44 2009 +0000

    transport/socket:Enable NODELAY by default for lowlat client and server sockets
    
    TCP_NODELAY is enabled by default for lowlat client and server sockets.
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 344 (Add support for TCP NODELAY in master)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=344

commit c0b5cc88687f4f0b25a411b7d0746dcadb297ce3
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Oct 29 05:58:37 2009 +0000

    protocol/client: Support for TCP_NODELAY
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 344 (Add support for TCP NODELAY in master)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=344

commit 0897c400c0864be252e5d23d41b71779f70eafe4
Author: Vijay Bellur <vijay@lw.com>
Date:   Thu Oct 29 05:58:07 2009 +0000

    transport/socket: Support for TCP_NODELAY
    
    Signed-off-by: Vijay Bellur <vijay@lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 344 (Add support for TCP NODELAY in master)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=344

commit 82c0df9941abfb4836947fce1ff9da266dbd7499
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Oct 28 17:04:33 2009 +0000

    Print inodelks in and out if option trace is on.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit 08327b6a6bdb7a3807a9d279b6d5f99686d13b99
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Oct 28 17:04:05 2009 +0000

    Print entrylks in and out if option trace is on.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit 03c6fe7f7e51d391beb370d04964af1de9728d28
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Oct 28 17:03:37 2009 +0000

    Trace locks in and out with an option in normal log mode.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit 9a62a3747cfcef2db3bc0b630a92f24d9436eeca
Author: Anand Avati <avati@lw.com>
Date:   Thu Oct 29 01:03:09 2009 +0000

    posix: posix_[f]setattr() handle valid=0 case by performing {f, l}chown (-1, -1)
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit b3b4fc4afb7d206d0a481f3234bf83c768f02aa2
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Oct 28 12:27:54 2009 +0000

    Implement lookup in locks to return lock count in a dict value.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit 53ff4f0299cf14c6c413d3e49991a6f05f9cda19
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Oct 28 18:42:35 2009 +0000

    liblwfs/rbtree: change rbthash_init_table to take no of expected entries in the hash table as argument.
    
    - the expected number of entries is used to create the memory pool of the hash
        table. Having constant macro for this purpose is not suitable since different
        users of rbtree based hash table store different number of entries in the
        table.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 335 (Io-cache optimization)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=335

commit 07e8d8a37713d39f63713d8c05dd99a0610a3c35
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Oct 28 16:15:37 2009 +0000

    performance/io-cache: fix memory leak.
    
    - page table of cache was not being destroyed in ioc_forget.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 335 (Io-cache optimization)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=335

commit 11dd6bcb416c2e937ced2b2bbd35fe10b21f283f
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Oct 28 16:15:03 2009 +0000

    performance/io-cache: fix double free.
    
    - the destroyer function passed to rbthash_table_init is used to free the data.
        The data being inserted is page and it is destroyed in ioc_page_destroy. Hence
        no destroyer function needs to be passed to rbthash_table_init.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 335 (Io-cache optimization)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=335

commit f513157e93bbba885f12f10ca2fb94424d7aea5e
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Wed Oct 28 07:15:55 2009 -0700

    Add -s (signoff) to format-patch.sh

commit 7e66ba43d7b75b63cdbf08e2d871136a6648a3a7
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Oct 28 06:22:44 2009 +0000

    Add lwfs-volgen to master
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 343 (LWFS volume generator - 'volgen')
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=343

commit ef7524ec1eda990cb89bee06eff2ef2d7c49d0d2
Author: Anand Avati <avati@lw.com>
Date:   Wed Oct 28 05:40:12 2009 +0000

    fuse: use postbuf in truncate_cbk for attributes to return
    
    this causes a problem where inodes even after truncate show old
    file size for a short time (till attributes are expired in fuse kernel module)
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 1f4e97c01a8483e227e9e66d421302b4114decd1
Author: Anand Avati <avati@lw.com>
Date:   Wed Oct 28 04:20:14 2009 +0000

    xlator: initialize all xlators in a loop instead of top down initialization
    
    top-down initialization will miss out on xlators from disconnected subgraphs
    and notify can go prematurely to these xlators
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 341 (mountpoint first access failure in single address space mode client/server)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=341

commit 6bfbcf7326a1261c8ff7cde9fd2c76a55cf756ae
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Oct 27 08:47:28 2009 +0000

    mount/fuse: Derive fd from the file handle for setattr
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit b4dd7534007dccbc90d7341259bd92a0ff6a678c
Author: Anand Avati <avati@lw.com>
Date:   Wed Oct 28 02:36:31 2009 +0000

    protocol/server: resolver fixes
    
    1. do not set ENOENT for RESOLVE_MAY case
    2. set op_ret to -1 and op_errno to EINVAL when request has neither of entry, inode or fd handles
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 3809bb1bbd617dbde1d943dbcf6b0346329187b6
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Oct 26 03:01:33 2009 +0000

    performance/io-cache: change data structure used to store page-cache.
    
    - io-cache uses rbtree based hash tables to store page-cache instead of lists.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 335 (Io-cache optimization)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=335

commit 78d281d6026ad1ebe8cc65c4396055902369ea89
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Oct 27 06:09:46 2009 +0000

    cluster/afr: Set local->fd in fsync.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 5674c41b3ea4eac8fe8f4f74bd978699bc847332
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Tue Oct 27 05:52:16 2009 -0700

    extras/init.d: make install directory configurable with --with-initdir

commit fad22625b4012e9a5d6b29bb23f0d864c611ae1c
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Oct 27 05:13:05 2009 +0000

    mount/fuse: Use correct offset for name in fuse_getxattr
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c415e5cfb87bc240ae8438e9df995ce45b55004e
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Mon Oct 26 19:53:33 2009 +0000

    Don't stop an already running lwfsd upon upgrade or install.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 338 (rpm post uninstall kills lwfsd process)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=338

commit b5fe35e215626b98b19876bc0f53b9184aef664b
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 26 11:57:28 2009 +0000

    cluster/afr: Remove struct's for [f]chown, [f]chmod, utimens from afr_local_t.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 78c98cac267ef9aebcaa3c35d70ea93c17462e62
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 26 09:15:13 2009 +0000

    cluster/afr: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit a284bf490cdf6ce334a4e70b22eedd7e639620f9
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 26 05:24:19 2009 +0000

    cluster/afr: Pick the data self-heal algorithm dynamically.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit d40ce2cbcd41a25eb053f2970db9bbaab2dafa22
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 26 05:07:31 2009 +0000

    cluster/afr: Check the target of symlink's in entry self-heal.
    
    During entry self-heal, make sure not only that a symlink
    exists on all subvolumes, but also that their targets match.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 193 (symlink contents not self-healed by replicate)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=193

commit 82dea3043878099e392b71bef9ae5de616ac5533
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 26 05:34:21 2009 +0000

    storage/posix: Ensure time(2) is stored in a 64-bit variable.
    
    Before multiplying the time_t value by 2^32, store it in a
    64-bit variable. This is necessary on 32-bit systems, where
    time_t is only 32-bits, and left-shifting by 32 results in 0.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit bd145077164ee20e3eb03f09b401e9a3ebdf8b6e
Author: Anand Avati <avati@lw.com>
Date:   Mon Oct 26 05:45:59 2009 +0000

    protocol/server: touchup loc only if inode/entry resolution was successful
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 79a5b7273d107f3c73534a117157184ffbc170e8
Author: Anand Avati <avati@lw.com>
Date:   Mon Oct 26 05:43:59 2009 +0000

    protocol/server: fix assignment of inode number in server_readlink
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 106a651826eeaacf9d0b40fe6d088d6bdc997675
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Oct 23 13:02:01 2009 +0000

    booster: seperate out the implementations of readdir and readdir64.
    
    - readdir and readdir64 should not call same procedure booster_readdir
        in their implementation, since the layout of dirent structures returned by
        libc implementations of readdir and readdir64 is different (readdir returns
        struct dirent *, where as readdir64 returns struct dirent64 *).
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 333 (ls on paths not on virtual mounts report wrong directory contents)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=333

commit 7445700d0323cbfac11b0e1367b0052438e38318
Author: Vikas Gorur <vikas@lw.com>
Date:   Sat Oct 24 08:17:36 2009 +0000

    cluster/afr: Set read-subvolume to the source while self-heal is in progress.
    
    Just before the lookup is unwound during background data self-heal,
    the read subvolume is set to the self-heal source subvol so that
    read operations on the file work correctly, and don't have to
    wait for the self-heal to complete.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 4163a3f8fbcc5e0d84d955258161f3a6f7a86de8
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Oct 23 10:11:47 2009 +0000

    cluster/afr: Do self-heal in the background.
    
    This patch introduces a new option "background-self-heal-count", with a
    default value of 16.
    
    This means that upto {background-self-heal-count} number of files/directories
    will be healed in the background at any given time. If such number of self-heals
    are already in progress, further self-heals take place in the foreground.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 6490122f107c992f2600fc7d3214a43c3f50df70
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Oct 23 09:31:52 2009 +0000

    cluster/afr: Pipeline the "diff" data self-heal read-write loop.
    
    Start upto "data-self-heal-window-size" instances of the read-write loop
    of the "diff" data self-heal algorithm simultaneously.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 10dea439359238aed4dbad0e2c25df9fb2d5f28e
Author: Vijay Bellur <vijay@lw.com>
Date:   Fri Oct 23 08:37:29 2009 +0000

    mount/fuse: Don't use fsi if it is already cleaned up
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit a5219b99db8076dc8606a44fd1cfaf2bd69a0d31
Author: Anand Avati <avati@lw.com>
Date:   Fri Oct 23 08:23:20 2009 +0000

    protocol/server: deep resolution support
    
    when requested ino/gen is not available in the inode table cache,
    then use the path presented by the client to lookup entries with
    the hope that the requested ino/gen gets populated into the cache.
    
    re-perform regular search after finishing the deep component
    lookup
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 52b02bbabaaa78061c6b223715f57853cbcfd652
Author: Anand Avati <avati@lw.com>
Date:   Fri Oct 23 08:22:49 2009 +0000

    protocol/server: send fresh lookups on revalidate failures
    
    also unlink non existent dentries in lookup_cbk
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 919d80171c73cf3ed516c089603f0c635cf5a376
Author: Anand Avati <avati@lw.com>
Date:   Fri Oct 23 08:22:20 2009 +0000

    whitespace fixes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 00d2fafa1bcab7758aa20741a20fb4ea38b9a8ff
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 15 04:48:09 2009 +0000

    cluster/afr: Pipeline the "full" data self-heal read-write loop.
    
    Start upto "data-self-heal-window-size" instances of the read-write loop
    of the "full" data self-heal algorithm simultaneously.
    
    Add a new option "data-self-heal-window-size" with range [1-1024],
    and a default value of 16.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 320 (Improve self-heal performance)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=320

commit 58efcf03a63324b7bbfda864647d35256917058a
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Oct 23 06:44:46 2009 +0000

    cluster/afr: Prevent spurious entry self-heal.
    
    If the initial lookup shows that 'pending' is positive, then
    self-heal will hold a lock and do a lookup again. This lookup
    might show that 'pending' is zero everywhere. However, entry
    self-heal used to consider this as a case of 'no sources' and
    try to merge the directories. This patch checks for that case
    and does not do the merge.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 326 ([2.0.8rc9] Spurious self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=326

commit dfa1f5755b11d11c81cbbdd79dcb5b3f8d216ac9
Author: Anand Avati <avati@lw.com>
Date:   Thu Oct 22 02:04:39 2009 +0000

    fuse-bridge: send fresh lookup on failed revalidate to return new nodeid
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit fc00f8c622f207577b4568b5e8dd43c6147e34c2
Author: Anand Avati <avati@lw.com>
Date:   Thu Oct 22 02:04:21 2009 +0000

    inode.c: whitespace fixes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 8c86febc41816730c9fd44fd87cefe3ef330d072
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 22 06:36:22 2009 +0000

    cluster/afr: entry self-heal: Store parent_loc on the heap for impunge_parent_setattr.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 137 (Parent directory mtime not reset after a create in self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=137

commit d5009323b3031122508fbd8daa61025b7c397e3c
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 22 05:37:36 2009 +0000

    cluster/afr: entry self-heal: Set parent directory's attributes using a new frame.
    
    There was a race condition in assuming that afr_sh_entry_impunge_parent_setattr_cbk will
       always return before impunge_xattrop_cbk and impunge_setattr_cbk.
    
       This patch fixes two additional problems:
    
    1) Building the parent_loc from impunge_local->loc after STACK_WIND to
       impunge_xattrop_cbk has happened. In a simple afr-posix configuration
       the stack will have been destroyed by the time building of parent_loc is
       attempted.
    
    2) parent_loc built in impunge_newfile_cbk was not being loc_wipe'd.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 137 (Parent directory mtime not reset after a create in self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=137

commit 1fe48896b950e74b589a8ed2c62bfb8571a0bf16
Author: vinayak hegde <vinayak@lw.com>
Date:   Tue Oct 20 23:56:28 2009 +0000

    lwfsd.c: Unnecessary writing of strerror of errorno on pipe
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 4 (mount --bind fails if run immediately after mounting LWFS)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=4

commit 568b3ffa1625a12585cc14565fdb9acfa5b36a1a
Author: Anand Avati <avati@lw.com>
Date:   Tue Oct 20 11:53:24 2009 +0000

    protocol/server: generation number and dentry resolution
    
    - handle generation number in protocol
    - rewrite server dentry resolution code for inode cache miss
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 40fb2587c5709f732dcd575945a8fdbaa51c07ea
Author: Anand Avati <avati@lw.com>
Date:   Tue Oct 20 10:54:24 2009 +0000

    inode: fix internal refs and minor fixes
    
    * also fix trailing whitespaces in a couple of places
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 492993570bb02bd7d244693ad28e409973fa9f4c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Oct 20 03:43:43 2009 +0000

    performance/write-behind: fix to bug in setattr which was causing frames to be missed.
    
    - local->file was being assigned even before file pointer was got from any of
        the fds opened on the inode, thus making local->file to be NULL. In
        wb_setattr_cbk, since local->file is NULL (and hence file passed to
        wb_process_queue), wb_process_queue does not resume the pending operations
        queued for the file.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 327 (dbench does not complete)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=327

commit 61d0ad544322ea0e0e9b0549662b8ca912641951
Author: vinayak hegde <vinayak@lw.com>
Date:   Tue Oct 20 07:18:16 2009 +0000

    performance/read-ahead: Process state dump operations are added.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit f8d40aad7e21389911b151d6445dd8197bec0049
Author: vinayak hegde <vinayak@lw.com>
Date:   Tue Oct 20 07:17:42 2009 +0000

    performance/quick-read: Process state dump operations are added.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit f90bc2a051ea4d6d23dd4c28ca018fcb1aa9cdaf
Author: vinayak hegde <vinayak@lw.com>
Date:   Tue Oct 20 07:17:06 2009 +0000

    performance/write-behind: Process state dump operations are added.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit 4d5ab4c0b8a296e12d80933aad03d06a044c6af2
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Oct 20 01:35:17 2009 +0000

    cluster/afr: Attempt to set fd ctx in create only if the call has succeeded.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 325 (crash in afr_fd_ctx_set)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=325

commit a2a09bb7f3d60a441c1e678484e2a1a3ac332a1e
Author: Anand Avati <avati@lw.com>
Date:   Sun Oct 18 15:02:02 2009 +0000

    protocol/client: incoroporate generation numbers
    
    protocol/client uses the new inode_ctx_{get,put}2 API to store both inode and
    generation number in context
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 7d62e85887047a64df17904c91136c1bc1c89bd4
Author: Anand Avati <avati@lw.com>
Date:   Sun Oct 18 15:01:07 2009 +0000

    protocol: format changes to incorporate generation numbers
    
    incorporate 64bit generation field in all protocol headers to accompany an inode
    number
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 11ddca1cd151479243fe23e579b76c5984f422c3
Author: Amar Tumballi <amar@lw.com>
Date:   Sun Oct 18 14:05:40 2009 +0000

    inode_ctx_{get,put,del}2 API support
    
    support for storing multiple values for a key in inode context - used for storing
    inode and generation number pairs on the server in protocol/client inode ctx
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 3d09fb99093a84a303edc443b68bdf9eb10096b4
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Sun Oct 18 13:35:15 2009 +0000

    fuse: use inode_t address as nodeid and use new inode API
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 7e831d735e3746fa9e6ec2e797e1a7f68ac5c148
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Sun Oct 18 13:35:14 2009 +0000

    inode: API changes for generation number support
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit b2c0c6c713a00631e658c7faafe51d0c941d65ef
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Sun Oct 18 13:35:13 2009 +0000

    inode: fix indentation and spacings
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 9d73eb4c8a9bf1e802985abee83ad36439ab681a
Author: Anand Avati <avati@lw.com>
Date:   Sun Oct 18 11:42:30 2009 +0000

    locks: fix leak in inodelk
    
    unlock was resulting in leak of lock structure if it was unlocking the last existing lock
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 306 (Enhance locks to aid debugging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=306

commit aacde00714c60db438c2fdc5ebacbe60a988f60b
Author: Vijay Bellur <vijay@lw.com>
Date:   Sun Oct 18 09:58:18 2009 +0000

    storage/posix: Set right the op_ret value from posix_readlink()
    
    Since op_ret was being returned as 0, fuse would regard the readlink () as a failure.
    Also, set right the buffer size of gen_key in posix_{f, l}stat_with_gen.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit aa701e2f607902628fce196de3eb0402aede7736
Author: Anand Avati <avati@lw.com>
Date:   Fri Oct 16 09:13:22 2009 +0000

    indentation fixes to conform to coding standards in locks
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 7bf78408ffec1efbceed17ed2e540d7d0af19763
Author: Anand Avati <avati@lw.com>
Date:   Fri Oct 16 09:12:57 2009 +0000

    locks: keep ref on the inode while locks are held
    
    keeping refs on the inode while there are held locks prevents the
    inode from getting pruned away
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 5d423ab4548c941921c1e64135fec6e15c7787f2
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Fri Oct 16 08:48:42 2009 +0000

    posix: posix_{f, l}stat_with_gen to return 0 on success (instead of >= 0)
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit d56c6a81ba22e5caca68bfa6fc0eb5f3079c9d22
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Fri Oct 16 07:30:26 2009 +0000

    posix - generation number support
    
    - use sequential gen counter
    - move span_devices handling and generation assignment to common functions
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 355150088d688fafd82c54af80a583a26732d0da
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Fri Oct 16 07:30:25 2009 +0000

    posix - use lchown and lchmod in setattr
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit ff38298144730c95627cfc11416baa6b75d3c94d
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Fri Oct 16 07:30:24 2009 +0000

    distribute - more NULL check
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit cb76cadb74a36e220a2b6a886c0c8068abdad0c7
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Fri Oct 16 07:30:23 2009 +0000

    distribute,nufa: layout handling changes
    
    changes to make revalidate not fail but instead perform fresh lookup
    and swap inode context (layout) safely
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit fa4e9d639b95b557ae64dab38c4c3ff8a0ec0d7a
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Fri Oct 16 07:30:22 2009 +0000

    fix double initialization of dht_local_t
    
    This was causing leak of the first initialized frame->local in
    every create call
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 3defca52e68cd65b6a32876e00de72832e247171
Author: Anand V. Avati <avati@blackhole.lw.com>
Date:   Fri Oct 16 07:30:21 2009 +0000

    NULL checks on local->loc.parent
    
    check for presence of local->loc.parent != NULL before defering to
    pick ino for post/preparent parameters. local->loc.parent can be NULL
    legally when loc is describing "/"
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 315 (generation number support)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=315

commit 61b5516701224073bbf71afea93ce58d5bd6b811
Author: vinayak hegde <vinayak@lw.com>
Date:   Fri Oct 16 00:38:25 2009 +0000

    performance/write-behind: initialize frame->local before goto out label
    
    if mtime,atime are not changed,
    frame->local will not be initialized.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 310 (While trying to create a file on replicate with write behind set-up, client crashes.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=310

commit 6fda29fcd64dffbbfdbbf63eed69a557e46598d0
Author: Anand Avati <avati@lw.com>
Date:   Thu Oct 15 11:28:00 2009 +0000

    shuffle hash layouts on directories
    
    allow for hash layouts to be written differently for different
    directories to give a better spread for same filenames across
    directories
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 324 (distribute does not spread files of the same name among all servers)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=324

commit ccb0f6fa67c148545e536d1033abe1652520bdb3
Author: vinayak hegde <vinayak@lw.com>
Date:   Thu Oct 15 00:27:14 2009 +0000

    performance/write-behind: In wb_setattr, inode is checked twice
    
    1. check for is it a directory,
    2. otherwise check for inode and continue.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 310 (While trying to create a file on replicate with write behind set-up, client crashes.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=310

commit 8b048b48b6925d0f774875abe5cdfccf4b26a868
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 15 01:47:54 2009 +0000

    performance/io-cache: remove caching in lookup.
    
    - caching file contents in io-cache during lookup is obsolete since quick-read
        does the same work.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 314 (Hang in quick-read)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=314

commit b78fa55bbbb645d4a9ac58ff7f6b59684dfa83d4
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 15 08:39:01 2009 +0000

    performance/quick-read: frame->local need not be set in qr_open_cbk.
    
    - local is used only by certain operations and hence it need not be set by
        all the operations invoking open.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 323 (fd leak with quick-read loaded in translator tree)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=323

commit 680164e64ab9a3817364626cd27cdc997ca16414
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Oct 14 21:14:36 2009 +0000

    performance/quick-read: flush should proceed with winding if fd-context is not found.
    
    - if the fd-context is not set, quick-read has no role to play other than
        just passing down the call to underlying translators.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 317 (Data corruption with write-behind loaded in translator tree.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=317

commit 44db9af90b7280520c1c599d2bf54dd477961948
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Oct 14 14:00:58 2009 +0000

    storage/posix: Use the right macro to set nsec of mtime in posix_do_utimes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 296 (handle futimes correctly in FUSE)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=296

commit 4203033c2da0598712d34389f8ef5ce8c24334b4
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Oct 14 14:00:07 2009 +0000

    mount/fuse: Initialize attr and set nsec values for atime and mtime.
    
    attr was not being initialized and NSEC values were not being set in attr.
    These were being referenced in posix_do_utimes which could cause a failure of
    utimes ().
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 296 (handle futimes correctly in FUSE)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=296

commit 347385beb519d75cd1457a36cf13a02fd2e60a92
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Oct 14 13:48:23 2009 +0000

    performance/write-behind:STACK_UNWIND happens only in failure path of wb_stat()
    
    Only in case of errors STACK_UNWIND happens in wb_stat().
    Also, fixed an incorrect check which would fail all writes.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 309 (In replicate set-up when exnihilate.sh is run , client crashes.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=309

commit 89b40ae93a09043e9d9384ce8c631d0c5abe6787
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Oct 14 07:32:37 2009 +0000

    storage/posix: Initialize op_errno to 0 in posix_create.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 309 (In replicate set-up when exnihilate.sh is run , client crashes.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=309

commit a9364b0a56186a3203820aca69b9875266e4c5f6
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Oct 14 05:50:59 2009 +0000

    io-cache: NFS-friendly changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 65f02619c7d4b29caa8dd11b78c294c521116f12
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Oct 14 02:07:25 2009 +0000

    performance/write-behind: return from wb_open after STACK_WIND
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 312 (iozone crash in Distribute-Replicate)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=312

commit 7c4429b9631c3c9866620887d6a41030466f71e3
Author: Anand Avati <avati@lw.com>
Date:   Tue Oct 13 07:32:46 2009 +0000

    afr transaction: fix op_ret check during locking
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 112 (parallel deletion of files mounted by different clients on the same back-end hangs and/or does not completely delete)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=112

commit 103a9ecfaf5881b31844b8a12a5b98dc5308a800
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Oct 13 06:42:28 2009 +0000

    cluster/afr: Set mtime of parent directory in self-heal properly.
    
    While creating/deleting an entry as part of entry self-heal,
    set the parent directory's mtime to match that on the source
    subvolume.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 137 (Parent directory mtime not reset after a create in self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=137

commit 7d6e73d4421265a304fd22964649e555a2db8097
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Oct 13 06:42:13 2009 +0000

    posix/client/server: Send postparent in lookup even if lookup fails on the entry itself.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 137 (Parent directory mtime not reset after a create in self-heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=137

commit f085beebd03b2c8be2fa57039ad3cbcb6eaa66d3
Author: Anand Avati <avati@lw.com>
Date:   Tue Oct 13 06:42:15 2009 +0000

    prevent spurious unlocks from afr selfheal
    
    afr selfheal now remembers all the nodes on which locks were successfully
    held and sends unlocks only to those nodes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 112 (parallel deletion of files mounted by different clients on the same back-end hangs and/or does not completely delete)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=112

commit b20cee457232a88517af44ae4505361dd3a4de15
Author: Anand Avati <avati@lw.com>
Date:   Tue Oct 13 06:22:37 2009 +0000

    afr transaction prevent spurious unlocks
    
    mark a subvol with held lock only if op_ret == 0
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 112 (parallel deletion of files mounted by different clients on the same back-end hangs and/or does not completely delete)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=112

commit babdbcbb6a434d65b0fdd9df708e94bea13cf05d
Author: vinayak hegde <vinayak@lw.com>
Date:   Mon Oct 12 23:38:41 2009 +0000

    performance/write-behind: In wb_setattr file is used before getting fd context
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 310 (While trying to create a file on replicate with write behind set-up, client crashes.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=310

commit e84a3cf74947d7a6deace07a1726376aa0a8a6a4
Author: vinayak hegde <vinayak@lw.com>
Date:   Mon Oct 12 09:09:33 2009 +0000

    performance/write-behind: file is referenced, without checking for NULL
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 310 (While trying to create a file on replicate with write behind set-up, client crashes.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=310

commit 6df45979aae89a217e43c59a8f0a8087915ce5d8
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 12 07:01:13 2009 +0000

    cluster/afr: Hold second lock after first lock has been granted for rename transactions.
    
    Hold the lock on the {higher_path} only after the lock on the
    {lower_path} has been granted successfully.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 112 (parallel deletion of files mounted by different clients on the same back-end hangs and/or does not completely delete)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=112

commit 0f177f59d199484a15490359f6db69bfa8dff82d
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 12 09:12:45 2009 +0000

    protocol/server: Set preparent and postparent in the response struct.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 5cec042dfa7d7c9699d3110f849a78b2569aa8d9
Author: Anand Avati <avati@lw.com>
Date:   Mon Oct 12 11:26:59 2009 +0000

    replicate: fix missing frame in entry-self-heal
    
    when files on all backend nodes are missing, the logic in afr_sh_entry_erase_pending
    is broken and results in missing lookup frame. this causes processes to enter into
    uninterruptible sleep state.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 311 (missing frame (lookup) when entry-selfheal finds missing files in all backend nodes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=311

commit a3da2ad4cd1c8c6adaa0f5055820541254f8c91d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Oct 9 12:40:19 2009 +0000

    performance/quick-read: change the default option values in quick-read.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 273 (Code review and optimize quick-read)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=273

commit 077d73fa467bcd0a5ac4be26bb4b366d5fc20a69
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 9 09:15:36 2009 +0000

    posix: Ensure ENOTEMPTY return on rmdir
    
    Since we added an extra step after rmdir, i.e.
    the lstat on parent dir as part of the NFS-friendly
    changes, the successful return from postparent lstat
    clobbers the -1 error return from rmdir.
    
    This prevents this particularly ENOTEMPTY error from
    being propagated to higher translators.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 73027dae835fc968dc443294fc8c109110168d37
Author: Anand Avati <avati@dev.lw.com>
Date:   Fri Oct 9 08:00:23 2009 +0000

    Add INIT_LIST_HEAD which was left out in the previous commit
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 297 (Posix locks cannot handle a single unlock over multiple held locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=297

commit 7ef987661626ee2e9de033470bafb7c864e01fe1
Author: Corentin Chary <corentin.chary@gmail.com>
Date:   Tue Oct 6 06:36:31 2009 +0000

    Add all generated files to .gitignore
    
    Signed-off-by: Corentin Chary <corentin.chary@gmail.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 2231e5f8ab2be2721ebb6662bd1e252cd89cea7a
Author: Corentin Chary <corentin.chary@gmail.com>
Date:   Fri Oct 9 06:25:11 2009 +0000

    features/locks: Fix insert_and_merge
    
    Init the list structure, because it will be used later,
    and subtract_lock does not do it.
    
    Also remove the special handling for unlocks, which was
    probably introduced as a workaround for this bug.
    
    Signed-off-by: Corentin Chary <corentin.chary@gmail.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 297 (Posix locks cannot handle a single unlock over multiple held locks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=297

commit 58bc556b84792562ff6cdc60e0e7a48006eb56a9
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Oct 9 02:40:10 2009 +0000

    performance/write-behind: Add enable-trickling-writes to volume_options.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit 72fc9328b1959f2f3e8b24048995cb70a090e0a3
Author: vinayak hegde <vinayak@lw.com>
Date:   Fri Oct 9 02:38:13 2009 +0000

    debug/trace: Check asprintf return value to avoid warning, while build
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 308 (Warning in debug/trace.c, during build)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=308

commit ec7c17bc6f54c2a28353d5b099e6501793eed8f8
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:56 2009 +0000

    performance/stat-prefetch: checking for cache and creation if not present is made atomic.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 9f876873728bc605f68d386e454c922a5305184d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:54 2009 +0000

    performance/stat-prefetch: lookup path in xattrop if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 3fb8e1d67a7d2a4513fa96df726f557fb5aa3df5
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:53 2009 +0000

    performance/stat-prefetch: implement sp_entrylk.
    
    - lookup on path should be sent in entrylk if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 94f24f06644b9e872f4b34f100017672b5d08978
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:52 2009 +0000

    performance/stat-prefetch: implement sp_inodelk.
    
    - path has to be looked up in inodelk if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit ebbe78de0281735f683d5414b34d1418e8c9d5b8
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:50 2009 +0000

    performance/stat-prefetch: lookup path in removexattr if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit f86d713f8e60dbd6d80f25a05fb3a55acc6457d0
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:49 2009 +0000

    performance/stat-prefetch: implement sp_getxattr.
    
    - path should be looked up in getxattr if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 4c83e0c25c39c90723a0c7ba6a706784b651704f
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:48 2009 +0000

    performance/stat-prefetch: lookup path in setxattr if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 506a26985572949525cd8560d77a2fa13332d8bd
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:46 2009 +0000

    performance/stat-prefetch: lookup path in opendir if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit d53db7415fd919b405818864aafa51b53aab7627
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:45 2009 +0000

    performance/stat-prefetch: lookup path in create if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit bbaf6e2d35841c2976855e09e3c744bc6c364821
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:43 2009 +0000

    performance/stat-prefetch: remove stat corresponding to oldloc->path from cache in sp_link.
    
    - ctime of oldloc->path will be changed on completion of link fop.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 7fcb479dc329d9931c0ec975ab8b87450d6d8b24
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:42 2009 +0000

    performance/stat-prefetch: lookup oldloc->path in link if it has not already been looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit aa8323817ebacf664b0e4c68996efa5847342bf8
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:40 2009 +0000

    performance/stat-prefetch: lookup oldpath and newpath in rename if they've not already been looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 5cb21335e3f12815d3e60b93d5edaea8d4ba26da
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:38 2009 +0000

    performance/stat-prefetch: lookup path in symlink if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 153e2fd4f5fc35d23b3dad0cc147f4586b88823d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:36 2009 +0000

    performance/stat-prefetch: lookup path in rmdir if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 9857c10cd6b7b4497f8bc2d96aa559d1191f65d8
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:35 2009 +0000

    performance/stat-prefetch: lookup path in unlink if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 19322c4a2a2c439a7c90dabe07cee07deb9dc79a
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:33 2009 +0000

    performance/stat-prefetch: fix mkdir to unwind with proper number of arguments.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit be267e3449f84b35f749beec7c90e895a231b32c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:31 2009 +0000

    performance/stat-prefetch: lookup path in mkdir if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit d4f0250bc6db1a8462ed05e970e81f02c47673b4
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:30 2009 +0000

    performance/stat-prefetch: lookup path in mknod if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 54990af07b8156bbe7d7686b3aa1e0bd2b7372c1
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:29 2009 +0000

    peformance/stat-prefetch: lookup path in readlink if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 7a4c856af87c024ee8e9ff0164e26e48876380d5
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:27 2009 +0000

    performance/stat-prefetch: implement sp_access
    
    - sp_access should send lookup on the path if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit b49ab8f21d69bf0ffb19f1837cf665a0d63ead7d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:26 2009 +0000

    performance/stat-prefetch: lookup path in truncate if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 063041b55c6375d8253aec4f2d191fb1a90de31a
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:16 2009 +0000

    performance/stat-prefetch: lookup path in setattr if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 31a48a6b868249f01e8a1660469390b2d34969c0
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:14 2009 +0000

    performance/stat-prefetch: implement sp_stat.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit f01de62f519c1cd110bf34a6cf585e8f8f88e4c2
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:12 2009 +0000

    performance/stat-prefetch: lookup path in checksum if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit f114e547b742eb321f7ac4746ba79605289fbe74
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:11 2009 +0000

    performance/stat-prefetch: lookup the path in open if it is not already looked up.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 8260e8c1ec061ea8fadc79695f5269781d543376
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:10 2009 +0000

    performance/stat-prefetch: implement procedure sp_process_inode_ctx.
    
    - this procedure processes inode_ctx to make decisions like whether the
        current procedure can continue (i.e., inode is already looked up),
        or the procedure has to initiate/wait for lookup on the path. It also
        sets up the frame->local and adds the stub corresponding to current fop
        if needed.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit f89f4c64af2d9253dea28504d9f27bf08b544bf0
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:08 2009 +0000

    performance/stat-prefetch: use op_errno instead of errno to store error code.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 2dc9d11fe1c8aaeba972c6fd693de1f32e5e3f1a
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:07 2009 +0000

    performance/stat-prefetch: Add support code to implement lookup-behind.
    
    - change sp_lookup and sp_lookup_cbk to support sending lookups when needed.
        lookups might need to be sent in fops like open, chmod, chown etc which
        operate on a path, since the actual lookup sent to stat-prefetch by its
        parent xlators is not propagated down the xlator tree if the path is
        cached.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 490edcd9f76726e5cc46bf9e7ddd69e496d32d7b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:05 2009 +0000

    performance/stat-prefetch: remove lookup-behind in sp_lookup.
    
    - lookup-behind should be done on-demand basis, in fops like open
        instead of in sp_lookup itself. This would reduce network traffic
        between client and server related to lookup, if the only use of
        lookup was to fetch stat structure.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 5c3bd66db8a911ca4da021d76237970c9eabd66c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:04 2009 +0000

    performance/stat-prefetch: optimizations to sp_lookup.
    
    - if stat cache cannot be found for a path in its parent inode and the path
        is a directory, we can get the cache from the inode corresponding to path
        and look for "." in that cache.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 78da899c5ceac63c424ad3d9e712b6a26abae7ba
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:02 2009 +0000

    performance/stat-prefetch: Add accounting of cache hits and misses.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit b9bfc46a9a26c356bd79a453c6daa77692f0a624
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:21:01 2009 +0000

    performance/stat-prefetch: change behaviour of sp_lookup when xattr_req is not NULL.
    
    - if the xattr_req is empty (fuse just creates an empty dictionary and
        sends along lookup) we can still use the cache prefetched during readdir,
        since we need not fill the reply dictionary.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit f5aa617d7cc4a48bb5e76fc7de763e9c3624e6b4
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:20:59 2009 +0000

    performance/stat-prefetch: change the cache to use rbtree based hashtable instead of list for caching dentries.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 59d4142ff1938e3b327fb81bee49402057ae1382
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 06:20:50 2009 +0000

    performance/stat-prefetch: fix memory leaks
    
    - sp_cache_get_inode uses fd_lookup which internally increases the refcount of
        fd by 1. This needs to be unrefed once we get the cache.
      - for directories, stat is stored in the inode context in sp_lookup_cbk.
        but, while doing so, no check was being done for the presence of context
        in inode, resulting in leak of memory equal to sizeof (struct stat) when
        multiple lookups happened on the directory.
      - path constructed in sp_readdir was not freed.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 3949b2828a78e4ecb95edb06f09fb9e7e3e5ce9b
Author: vinayak hegde <vinayak@lw.com>
Date:   Thu Oct 8 23:35:57 2009 +0000

    debug/error-gen: Feature enhancement of error-gen translator
    
    In debug/error-gen translator 3-options are provided.
    failure - specifies the percentage failure in fops.
    error-no - specifies which error-no to be returned.
    enable - specifies which are the fops to be enabled for this translator.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 291 (feature enhancement of error-gen translator)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=291

commit d160d55c41913de26a43117b00fcab63746ce96d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Oct 9 00:05:43 2009 +0000

    performance/write-behind: Refining the check for fd_ctx in fds
    
    - An fd opened on a directory should not be considered bad if the fd context
        is not set since the context is set only for fds opened on files.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 260 (ls on booster VMP results in error: "File descriptor in bad state")
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=260

commit c74e5ac0a26ad217edc2f6ba1ed4bb0511e49084
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Oct 8 05:59:49 2009 +0000

    liblwfs/defaults: default_readdirp should call fops->readdirp instead of fops->readdir.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit adc495298c22fa3463cdd46a5e3def37878f28bb
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 8 06:31:33 2009 +0000

    performance/write-behind: Change STACK_UNWIND to STACK_UNWIND_STRICT.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit a310d0e6b0754c43c8b89ea5b78dcc4e8f2e0462
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Oct 8 05:48:21 2009 +0000

    cluster/dht: Change STACK_UNWIND to STACK_UNWIND_STRICT.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 1534a696daf25ddea67bd2bc8e2ba1993eb366c6
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Oct 7 13:12:36 2009 +0000

    Initialize local before any call to STACK_WIND to prevent a crash
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 304 (Write behind crashes when a chmod is issued)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=304

commit ef488e7cceea97c4e2750b463000a2b77fc82323
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Oct 7 12:55:54 2009 +0000

    assign client_readdirp to .readdirp in protocol/client & fix 2 other bugs in call_stub
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 305 (Readdirp crashes in client protocol)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=305

commit 6215731b42a4149e78fb56cb62c2f2dc571ea2a5
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Oct 7 06:43:44 2009 +0000

    mount/fuse: Handle FATTR_MODE flag properly.
    
    Handle the FATTR_MODE flag in fattr_to_gf_set_attr.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 0b1197defa255ee533e568c9534bc6a5b5aadc29
Author: Vijay Bellur <vijay@lw.com>
Date:   Mon Oct 5 23:59:13 2009 +0000

    Changed occurrences of JiangNan to LW.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 5ea9f35a538e83ebc50fca81efecbcd8ddd9951b
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Oct 7 04:38:49 2009 +0000

    cluster/afr: Change STACK_UNWIND to STACK_UNWIND_STRICT.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit bb8ea22c3c936254dc4e3a3813f18b78d1aec6b4
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 5 09:25:33 2009 +0000

    mount/fuse: Don't send fsetattr if ATIME or MTIME needs to be changed.
    
    There is no "futimes" call. Hence, if either the FATTR_MTIME or FATTR_ATIME
    flag is set, don't send fsetattr.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 296 (handle futimes correctly in FUSE)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=296

commit 29f81133a6cd95ebc9fac627a4fb0da73977f5a8
Author: Pavan Sondur <pavan@lw.com>
Date:   Mon Oct 5 09:45:52 2009 +0000

    Removed remaining references to chmod, chown and utimens as part of setattr changes.
    
    Removed references to chmod, chown and utimes. Removed utimes references in AFR and writebehind.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit f3e46f2cb44e95c453bfa20c870dca6e42fc9a7a
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Oct 5 07:42:02 2009 +0000

    core: Add rbtree based hash table
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 39243caeca3322801429afcef5094ea734438669
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Oct 5 07:42:01 2009 +0000

    mem-pool: Include stdlib for calloc()
    
    Doing so removes build warnings about calloc and free
    for files that use mem-pool but do not by themselves
    include stdlib.h, for eg., rbthash.c
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit d03e51668d5d0849d7acd7659a3e8028db85b089
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:08:07 2009 +0000

    liblwfsclient: Port directory reading to readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 56bba06b2103aeadf33a7c7a5914f083f4d3b092
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:08:06 2009 +0000

    client: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 6968e06d007c57084414dfd433f005175b5ddc23
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:08:05 2009 +0000

    server: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 4b624979ce50a4fbdb34bc93241b6591d64b7f0a
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:08:04 2009 +0000

    stat-prefetch: Port stat-prefetching to readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 2bcd6ffad9d9445b90627a219ccfff9535a22c6a
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:08:03 2009 +0000

    io-threads: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit e1b3fa2194f0ec63b2206e081f7dc352d842ea53
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:08:02 2009 +0000

    trace: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 95b6af6c355dfd5f705fd152884d6a40c8676b2c
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:08:01 2009 +0000

    io-stats: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit d4bd1b3945d6792f7f8ec05b1bb642adfc824aa6
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:08:00 2009 +0000

    error-gen: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 12947025dd2acd58b233d1c83efcab1038764189
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:07:59 2009 +0000

    unify: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit ee3b60524b49fc02d68c7ba219d8015a0d7c7a97
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:07:58 2009 +0000

    map: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit d3c3d0a8ddc97d7be64a2c2102fab67b8d5e81af
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:07:57 2009 +0000

    ha: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 512dcad823feb199d78f5b66a09bc404ccb899e8
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:07:56 2009 +0000

    distribute: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 02bced30690a5d298f262dce459bfecd001da2fe
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:07:55 2009 +0000

    afr: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 6b5a8b8536a943bd7f3241e1a08de934f7566169
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:07:54 2009 +0000

    posix: Support readdirp fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 55f55db6500835e95b324a2f28144c6a3dc55c62
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Oct 2 03:07:53 2009 +0000

    core: Separate readdirp and readdir fops
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 292 (Separate readdirp functionality from readdir fop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=292

commit 81cc40fee8b9cebcf5fc544c5d0c734fa7dfbb90
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Oct 6 06:45:04 2009 +0000

    storage/posix: Process "lwfs.content" key in lookup only for regular files.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 301 (lookup should ignore ISDIR error when trying to get content)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=301

commit f719a641841a2bbd6f59945e5e32350cfe89f814
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 5 05:38:09 2009 +0000

    features/locks: Change STACK_UNWIND to STACK_UNWIND_STRICT.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 965b74d7d6faeebb17f580cefcadca15dece3b08
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 5 05:37:51 2009 +0000

    storage/posix: Change STACK_UNWIND to STACK_UNWIND_STRICT.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 97b564c708fbb44cf1ac512d7eaca701767120d5
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 5 05:37:31 2009 +0000

    liblwfs: Add STACK_UNWIND_STRICT macro.
    
    STACK_UNWIND_STRICT (op, frame, this, op_ret, op_errno, ...)
    
    The "op" argument is the name of the fop (lookup, open, etc.).
    This macro makes sure that the number and type of arguments
    passed match those of the callback function for the fop.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 269 (Add a specialized STACK_UNWIND macro for each FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=269

commit 7e6c9643e69e1f8172e5be3564213d35332ae099
Author: vinayak hegde <vinayak@lw.com>
Date:   Mon Oct 5 05:21:58 2009 +0000

    lwfsd.c: Pipe is used during daemonization as ipc.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 117 (Wrong command line does not throw error)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=117

commit 8e0f5e7105c0d03b50a9342f4285a985b9cdb090
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Oct 5 04:01:36 2009 +0000

    cluster/afr: Initialize local->first_up_child in AFR_LOCAL_INIT.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 285 ("first up child" can change during a transaction)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=285

commit b441730b5b54fcd9355bef42bd0f45a4147212e4
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:16 2009 +0000

    liblwfsclient: Remove redundant fchown and fchmod
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 23d896068f98538954772dcd90a112b6cac17d63
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:15 2009 +0000

    liblwfsclient: Use fsetattr for fchown
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 1640178a1004cb5a43cdf2e5fb375807812f367f
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:14 2009 +0000

    liblwfsclient: Use fsetattr for fchmod
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 507a4aa75d295f6fa7db04885b65aec0f497b21e
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:13 2009 +0000

    liblwfsclient: Support fsetattr fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 3dc513b108df276b974c0ddc47f7ac9bff907448
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:12 2009 +0000

    liblwfsclient: Remove redundant chown code
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 0778d42be1a463f643994592073837b59d33bd76
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:11 2009 +0000

    liblwfsclient: Remove redundant chmod code
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 52193c0a79cb39b7456a57ff6470000dd39d6420
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:10 2009 +0000

    liblwfsclient: Remove redundant utimens code
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 46c23afc98e3f0c8063c4baada7baa3dd3134727
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:09 2009 +0000

    liblwfsclient: Use setattr for utime
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit a2013f6bc70832c7cbcc1cabbb4d74725c0adac7
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:08 2009 +0000

    liblwfsclient: Use setattr for utimes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit bdeb23cac1edbc7d88978b3676461db462d89c53
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:07 2009 +0000

    liblwfsclient: Use setattr for chown
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit b017bcb852e3549ba7dc1dc6d23e157178bb1305
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:06 2009 +0000

    liblwfsclient: Use setattr for chmod
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 709d46bcdbd006fa92c9d15e7c02ba7bff86685b
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:05 2009 +0000

    liblwfsclient: Support setattr fop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit 25217d43f9786b71de4d86cae122403f2cbaf1e5
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:04 2009 +0000

    distribute: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 398de05aeba82ddfa055e8696521f3d5a4cbabe5
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:03 2009 +0000

    ha: Handle memory allocation failures
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 3e25f229787c1b53ab61333a41345a35c070e089
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:02 2009 +0000

    ha: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 5c61f94b00e4fcc8199126f03816896e015eb511
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:01 2009 +0000

    symlink-cache: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 7c1bdb3aad6063f69338d92490cd4d11d4d578f1
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:59:00 2009 +0000

    io-threads: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 1e0b3920dc0bcb8d15586adceacacedba75b17ab
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:59 2009 +0000

    read-ahead: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit b342852f9d41c8274cdc808c1a481487b44a7ab9
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:58 2009 +0000

    write-behind: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit cc709f8731b81faceab00b6ce18cf129e8ec8e3e
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:57 2009 +0000

    filter: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit b02cf677ff6ec178f35e4300bb83b130c1834b05
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:56 2009 +0000

    stripe: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit ef07ef24562d3fe4355af849d2a50a16b8fb6db7
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:55 2009 +0000

    error-gen: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 5654dc9f93abe195fd4a1d3ed4a4971710db06e4
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:54 2009 +0000

    locks: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit ecf1ea918f206a23c2c74a792ee61f4c5ac799c2
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:53 2009 +0000

    io-stats: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 2bc402003cd4526f74e4b543a717aafb52a8b9ed
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:52 2009 +0000

    trace: NFs-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 26907996756cc17f1a7df30b6f8ef130b7140924
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:51 2009 +0000

    client: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit b5c4ad4cbb7e313f66d22148e93b58c486e32d1b
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:50 2009 +0000

    server: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 9710782e8a42712dfbbea46b50ac3681e57a860d
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:49 2009 +0000

    posix: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit a27e706e3105dc363bcbe3c0e3c91979cc6c89a0
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:48 2009 +0000

    unify: NFS-friendly logic changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit e11d66c8d6dea72d02f9bcdbf65c67bd5c60b5cc
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:47 2009 +0000

    Global: NFS-friendly prototype changes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 145 (NFSv3 related additions to 2.1 task list)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=145

commit 186a86f342625a9dce53fe537f8237c6099d5c54
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Oct 1 06:58:46 2009 +0000

    Global: Introduce setattr and fsetattr fops
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 146 (Add setattr FOP)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=146

commit dca4b2a23cb55e1e15fb393e7cbfd39b59280c9c
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Sep 30 05:48:22 2009 +0000

    Changes to use this->name while using logging instead of explicitly mentioning posix-locks.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 290 (Clean up a calls to gf_log in locks' code)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=290

commit 820b88c3389b59dce190e6846703c267d7113a63
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Sep 30 05:47:49 2009 +0000

    Make changes such that lwfs builds with Werror and fix LONG_LONG_MAX definition.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 289 (lwfs does not build with Werror)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=289

commit 572fb95127a37c3bf45a60083ad247064d634085
Author: Pavan Sondur <pavan@lw.com>
Date:   Tue Sep 29 11:03:54 2009 +0000

    Check if path is valid after call to inode_path before accessing it.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 287 (call to inode_path can result in a segfault)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=287

commit 41c32c84892365c5230a5e61addc44dbfcd2e5cf
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Sep 28 20:58:26 2009 +0000

    cluster/afr: dir-write: Fix inode number handling.
    
    create, mkdir, symlink, mknod: Prefer to return itransform'd inode number
    from the first_up_child. If not, fall back on any other child that returned
    succcess.
    
    link, rename: Return the same inode number that
    was passed as part of loc_t.
    
    Also adds a new member to afr_local_t, local->first_up_child
    which is initialized at the start of the transaction. This
    fixes the race where a subvolume might go down during the transaction
    and thus have the first_up_child change.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 285 ("first up child" can change during a transaction)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=285

commit 03b5a87b2f4d641c798440923b255ca30a13bf47
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Sep 25 02:55:12 2009 +0000

    liblwfsclient: don't destroy the iobuf pool during fini.
    
    - some of the iobufs in pool will be cached by io-cache and hence refcount
        will not be zero. Hence the assertion of ref being zero in
        __iobuf_arena_destroy fails. Commenting out iobuf_pool_destroy during fini, till
        we introduce proper cleanup in all translators, thereby allowing io-cache
        to release the buffers it has held.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 283 (booster aborts complaining the refcount of iobuf is not zero during lwfs_umount_all.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=283

commit 009fc3e3e921517a7b986f7b5a73676f43edb358
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Sep 25 02:55:44 2009 +0000

    liblwfsclient: traverse the vmplist during fini only if any entries are mounted.
    
    - the vmplist.list is inited only during mounting of first entry. Hence doing
        a list traversal when no vmpentries are present, results in a segfault.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 282 (segfault of applications using booster observed when the application does not mount any vmps.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=282

commit 5816d5dcc5e564017c101acb65e496a8d631b4eb
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 24 04:18:18 2009 +0000

    cluster/afr: Fix memory leak in "diff" self-heal algorithm.
    
    FREE sh->private after diff self-heal is done.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 281 (memory leak in "diff" self heal algorithm)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=281

commit 2317913ae5556fe402828d97f7da761124c15ba2
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 24 04:30:06 2009 +0000

    lwfsd/main: Do a sem_post only if running in daemon mode.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 4 (mount --bind fails if run immediately after mounting LWFS)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=4

commit 551782dfd54cb554633de526a0c4e188776c5e78
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Sep 24 00:49:52 2009 +0000

    booster: Cleanup booster_cleanup and register for atexit
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 279 (File written with booster results in self-heal after dd exits)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=279

commit d528f134094d86ec7344875160a41e0ce4ebc1b0
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Sep 24 00:49:51 2009 +0000

    liblwfsclient: Support TRACE loglevel
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 210 (liblwfsclient: Enhance logging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=210

commit cd13c7e7368ec60ec9b6559e2eced41bcc10d6bc
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Sep 24 00:49:50 2009 +0000

    liblwfsclient: Wait for all call pools to be destroyed
    
    This ensures that the process using liblwfsclient does
    not exit before all the fops and calls have been replied to.
    It helps to ensure that the backends are in a sane state when
    the program exits.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 279 (File written with booster results in self-heal after dd exits)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=279

commit 881e5f243d3c56dcaf54595378beb91c45f1ded5
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Sep 24 00:49:49 2009 +0000

    liblwfsclient: Clean up fini and umount code paths
    
    This patch cleans up the umount and fini paths in preparation
    to support waiting for unwind of all pending call frames.
    
    Two misc fixes are:
    1. Fix to avoid deadlock in _libgf_umount by
    using _libgf_vmp_search_entry instead of
    libgf_vmp_search_exact_entry since the latter tries to take a
    lock already help by _libgf_umount.
    
    2. Avoid a crash in _libgf_umount by deleting the vmp
    entry from the list before it gets freed.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 279 (File written with booster results in self-heal after dd exits)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=279

commit 7398c0a694343c15292f076dbb0ae8508004d003
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Sep 24 00:49:48 2009 +0000

    iobuf, logging: Expose existing functions as required
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 279 (File written with booster results in self-heal after dd exits)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=279

commit 5d7db5410fc4a96268dcacf759a3b5ab79c2c28e
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Sep 24 00:49:47 2009 +0000

    liblwfsclient: Reduce logging aggressiveness to TRACE
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 210 (liblwfsclient: Enhance logging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=210

commit 41cd359539cf0b59c4435cbecd38b71bab796449
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Sep 24 00:49:46 2009 +0000

    booster: Reduce logging aggressiveness to TRACE
    
    Internal users feel the amount of logging brought in
    due to a previous logging enhancement patch is a bit too
    aggressive for DEBUG, so this changes it to TRACE.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 210 (liblwfsclient: Enhance logging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=210

commit 03764d0d308b46ebfa53d21df1d49a549c459e64
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Sep 24 01:01:00 2009 +0000

    liblwfsclient: Re-validate root inode on every path resolution
    
    If the root inode's is outdated, send a revalidate on it.
    A revalidate on root inode also reduces the window in which an
    op will fail over distribute because the layout of the root
    directory did not  get constructed when we sent the lookup on
    root in lwfs_init. That can happen when not all children of a
    distribute volume were up at the time of lwfs_init.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 256 (revalidates should be sent on '/' in liblwfsclient.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=256

commit c72b902afce2b977c8d0b9b1a0463f615365d825
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Sep 24 00:59:04 2009 +0000

    performance/write-behind: Add a NULL check for request->stub before checking request->stub->fop.
    
    - for non-write wind requests, the request structure outlives the stub.
        The call stub is destroyed when stack is wound but request is destroyed
        only when the reply has come.
        (for writes, both stub and request are destroyed when refcount becomes 0,
         which happens only when the write operation is stack unwound and a reply
         for the write operation has come from underlying translators, for non-write
         unwind requests the request is first destroyed before resuming the stub).
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 280 (simple stripe, with write-behind set up, when dbench is run client crashes.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=280

commit 155ffe5c5a52a8f52978dc68509e5912b5db7bc4
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Sep 22 07:53:14 2009 +0000

    fuse: emit a flush from release if we didn't get an adjacent FLUSH message from the kernel
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 223 (flush not sent)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=223

commit 334981987010f895594031f8363f481eb7ae6416
Author: Pavan Vilas Sondur <pavan@dev.lw.com>
Date:   Wed Sep 23 06:03:25 2009 +0000

    Implemented inodelks with support for domains.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit 231196910d9d36af9546ddc511b26da5628b3ab8
Author: Pavan Vilas Sondur <pavan@dev.lw.com>
Date:   Wed Sep 23 06:02:55 2009 +0000

    Implemented entry locks and support for domains.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit 435b28132b8f276681d19ae14fa988d26a16f659
Author: Pavan Vilas Sondur <pavan@dev.lw.com>
Date:   Wed Sep 23 06:01:10 2009 +0000

    Removed internal.c and old domain definition in locks.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 222 (Enhance Internal locks to support multilple domains and rewrite inodelks)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=222

commit 5535110f8e760eecb12140aafd70174e7d7bfcda
Author: vinayak hegde <vinayak@lw.com>
Date:   Wed Sep 23 06:19:21 2009 +0000

    Changes for custom daemon function.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 4 (mount --bind fails if run immediately after mounting LWFS)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=4

commit 7df1671b5af320f2c5aaeadfccda2e64d2ff404e
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Tue Aug 11 13:21:11 2009 +0000

    mount.lwfs had a problem understanding when "volfile" was given as one of the mount arguments.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 204 (mount.lwfs mounts to incorrect mount point)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=204

commit 044679501c13024950751cbebe8fd47cc73e8bf9
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Sep 23 00:22:17 2009 +0000

    performance/write-behind: store currently aggregated data size in wb_file
    
    - this helps us to not traverse the request list whenever we need currently
        aggregated data in the queue
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit 3d1f342671bb11159569fd2a4f20b2c9007e7b55
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Sep 23 00:21:51 2009 +0000

    performance/write-behind: store the current window size in wb_file.
    
    - this would increase the performance since we don't have to traverse the
        request list every time we need the current window size.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit 2f1261c194d8735e50dfa3846b3cd23654ed7391
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Sep 23 00:21:31 2009 +0000

    performance/write-behind: reduce usage of iov_length.
    
    - request structure now holds a member write_size which is initialised at the
        time of request creation and used later.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit 35f96c039e8961e48af46af43b6ecf7a335feb15
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:32 2009 +0000

    cluster/afr: Add new option "data-self-heal-algorithm"
    
    option: data-self-heal-algorithm type: string default: "full"
    
    This option allows the user to specify the algorithm to
    be used for data self-heal. Currently supported values
    are "full" and "diff".
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit d2b7e65ec0c35c4ee16f28f449553d90fb88fa6a
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:31 2009 +0000

    cluster/afr: Add the "diff" self-heal algorithm.
    
    The "diff" self-heal algorithm works as follows:
    
      For each block:
        Compute MD5 checksum on source and all sinks
        If checksum on a sink differs from source:
          Read block from source and write to sinks
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8c224de82b9b3e75f2dd9c264d5d3726dd1ef379
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:30 2009 +0000

    cluster/afr: Make the self-heal algorithm pluggable.
    
    Abstract the read/write loop part of data self-heal. This
    patch has support for the "full" (i.e., read and write entire
    file) algorithm.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 356449c0b39d600a16b195df30d0fc37693575f8
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:29 2009 +0000

    cluster/afr: Open source and sinks in read/write mode during self-heal.
    
    Since a self-heal algorithm (e.g., rsync) might want to both read
    and write from both the source and sink files, open them as O_RDWR.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a4d729c7dccd5cdf72f640e39564103412d867ec
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:28 2009 +0000

    protocol/server: Implement rchecksum.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4f9fa11a788dc367f89ca47544f42323c0e73a14
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:27 2009 +0000

    protocol/client: Implement rchecksum.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 45707a5ae95a9154a57fb7bf56f7cd64e2c40896
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:26 2009 +0000

    storage/posix: Implement rchecksum.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit faf97734112ebe11d8a411351d9f23b528b9d616
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:25 2009 +0000

    liblwfs: Add RCHECKSUM fop.
    
    rchecksum (fd, offset, len): Calculates both the weak and strong
    checksums for a block of {len} bytes at {offset} in {fd}.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 239d2cbdb0a4c32df9f21de8385e2c466b934178
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 17 05:56:24 2009 +0000

    liblwfs: Add checksum functions.
    
    gf_rsync_weak_checksum:   Calculates a simple 32-bit checksum.
    gf_rsync_strong_checksum: Calculates the MD5 checksum.
    
    The strong checksum function makes use of Christophe Devine's
    MD5 implementation (adapted from the rsync source code,
    version 3.0.6. <http://www.samba.org/ftp/rsync/>).
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 0def744b2e66e81ac37532b26716e83d3b8bc9dd
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 22 00:22:12 2009 +0000

    booster: implement F_DUPFD command in fcntl.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 277 (running dd on booster returns EINVAL)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=277

commit 8301f05f77aa08f04e249c19576a7c111e586109
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 22 01:39:10 2009 +0000

    performance/write-behind: add option "enable-trickling-writes".
    
    - With this option enabled, writes are stack-wound even though not enough
        data is aggregated, provided there are no write-requests which are
        stack-wound but reply is yet to come. The reason behind this option
        is to make use of the network, which is relatively free (with no writes
        or replies in transit). However, with non-standard block-sizes of writes
        the performance can actually degrade. Hence making this configurable.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit 35d1cabfd1266609ec22f11e5e4ddba13f0ffc56
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 22 01:38:37 2009 +0000

    performance/write-behind: reduce traversal of request list during wb_mark_winds.
    
    - move all the decision making code to __wb_can_wind.
      - don't continue traversing the request list, once we know any of the
        following conditions are true:
        * requests other than write are present in queue.
        * writes are happening at non-contiguous offsets.
        * there are no write requests, which are wound to server but not yet
          received the reply.
        * enough data is aggregated for writing.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit db33e097111ca76f487f087d494984d45d4b3b64
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 22 01:38:50 2009 +0000

    performance/write-behind: reduce list-traversal during wb_mark_unwinds
    
    - don't traverse entire request list to get the window-size, instead break when current
        window size becomes greater than configured limit.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit 32a6898678686df1b2c82a37e548170ba5c3512b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 22 01:38:25 2009 +0000

    performance/write-behind: remove redundant traversal of write-requests in the wind list in wb_ sync.
    
    - no need of getting the total_count of number of requests in the list.
        Even if there is a single request, we need to sync it.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit 8a0d85eb936f9483a5d23d67cf5989351d5f86d7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 22 01:38:12 2009 +0000

    performance/write-behind: Aggregate adjacent contiguous write-buffers into single iobuf.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit ecb8f4dfce0bfdba8d14532231a7596a73def38e
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 22 01:37:59 2009 +0000

    performance/write-behind: fine-tune logic of wb_mark_winds
    
    - remove wb_mark_wind_aggregegate_size_aware, since wb_mark_wind_all does
        the same work (with check for whether current aggregated data size is
        greater than the configured limit before calling it). Moreover,
        wb_mark_wind_aggregate_size_aware called __wb_get_aggregate_size
        redundantly, thereby reducing the performance, since for small
        sized large number of writes, traversing the list of requests takes
        significant amount of time.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 276 (write behind needs to be optimized.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=276

commit fd0b40a2f3e7e1c56b742c9ae081785811030a3c
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Sep 21 05:32:42 2009 +0000

    liblwfsclient: Fix build warnings
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 275 (liblwfsclient: Generic build failure bug for liblwfsclient and booster)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=275

commit 6f7c6c102a418553a109e1b2bb5b1f87578bab58
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Sep 21 05:32:32 2009 +0000

    booster: Fix build warnings
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 275 (liblwfsclient: Generic build failure bug for liblwfsclient and booster)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=275

commit 1fc259cb73cb199052519f548dfbb1b83829b28f
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Sep 21 05:19:47 2009 +0000

    storage/posix: Update nr_files after system call succeeds.
    
    In posix_open(), posix_create(), and posix_close(), update
    stats->nr_files only after the FOP has succeeded.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 248 (Updating stats in posix is incorrect)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=248

commit 578e42399fa86f15dffffd5d35f96f3a248d651d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Sep 18 05:53:52 2009 +0000

    performance/quick-read: refine logic of qr_readv.
    
    - An extra vector was being allocated when the number of bytes being read
        from cache were equal to the iobuf size.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 274 (Memory corruption in Apache running on booster)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=274

commit c98c65c940a8120982aeaf5f15d0522a002c5b80
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Sep 18 05:48:04 2009 +0000

    performance/quick-read: optimizations to lookup
    
    - qr_lookup not to send request for file-content if the cache is already
        present during revalidates.
      - flush the cache in qr_lookup_cbk if the cache is not in sync with the file.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 273 (Code review and optimize quick-read)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=273

commit 4a272e7ba02487b2596814035a266974d57e6b04
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Sep 18 05:48:13 2009 +0000

    performance/quick-read: make a comment more explicit.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 273 (Code review and optimize quick-read)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=273

commit 6f692f0f39f9fe32936135947c91629044ae4d2c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Sep 18 05:47:56 2009 +0000

    performance/quick-read: checking for qr_file in inode-context and creating if not present should be atomic.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 273 (Code review and optimize quick-read)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=273

commit 5de57e490c8e3c2764777da6bf750a4f5e23f2b3
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Sep 18 05:47:43 2009 +0000

    performance/quick-read: refine the logic in qr_lookup.
    
    - a new size has to be set in xattr_req only
        if (quick-read is configured with a maximum file size limit
            && ((xattr_req does not have a request key for getting content)
                 || (the size requested in xattr_req is not equal to configured
                     size in quick-read)))
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 273 (Code review and optimize quick-read)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=273

commit cb596d7e847543906c62eb3b07c88c60acac15ae
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Sep 17 15:08:21 2009 +0000

    protocol/client: access lwfs context from the ctx member of xlator object
    
    - A global context pointer cannot be used with liblwfsclient, since
        there can be many contexts in a single process.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 271 (applications using booster protocol/client crash in client_setvolume_cbk.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=271

commit f0f547f79792af9fe8228f2028bd1dd30d976e68
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Sep 17 00:08:26 2009 +0000

    performance/write-behind: check for the presence of context only in fds not opened on directories.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 260 (ls on booster VMP results in error: "File descriptor in bad state")
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=260

commit bad3de155a3a910c6665a39555aeb823803635c9
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Sep 16 12:33:21 2009 +0000

    client-protocol: fix race-condition encountered while accessing fdctx
    
    - In protocol/client, fdctx is accessed by two sets of procedures,
      protocol_client_mark_fd_bad falls in one set whereas the other set consists of
      all fops which receive fd as an argument. The way these fdctxs are got is
      different in these two sets. While in the former set, fdctx is accessed
      through conf->saved_fds, which is a list of fdctxs of fds representing
      opened/created files. In the latter set, fdctxs are got directly from fd
      through fd_ctx_get(). Now there can be race conditions between two threads
      executing one procedure from these two sets. As an example let us consider
      following scenario:
    
      A flush operation is timed out and polling thread executing
      protocol_client_mark_fd_bad, fuse thread executing client_release. This can
      happen because, immediately a reply for flush is written to fuse, a release on
      the same fd can be sent to lwfs and the polling thread still might be
      doing cleanup. Consider following set of events:
    
      1. fuse thread does fd_ctx_get (fd).
      2. polling thread gets the same fdctx but through conf->saved_fds.
      3. Now both threads go ahead and does list_del (fdctx) and eventually free
         fdctx.
    
      In other situations the same set events might occur and the threads
      executing fops other than flush in the second set might be accessing a
      fdctx freed in protocol_client_mark_fd_bad.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 127 (race-condition in accessing fdctx in protocol/client)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=127

commit c55a0a287b18ace123964e017c759947a5fbac2f
Author: Raghavendra G <raghavendra@lw.com>
Date:   Fri Sep 11 07:42:44 2009 +0000

    performance/quick-read: access lwfs_ctx from xlator instead of using lwfs_get_ctx
    
    - since lwfs_get_ctx gets the global context pointer, there can be
        problems in a multithreaded application running on liblwfsclient
        doing multiple lwfs_inits. Hence use context specific to the
        current xlator tree stored in each xlator object.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 240 (segmentation fault in qr_readv)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=240

commit a767c08c0e92e2e8caf4667d97aa5e5c3a13efb0
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed Sep 16 08:53:33 2009 +0000

    Add iot_fxattrop to io-threads
    
    It was already implemented but not set to .fxattrop
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 267 (Add fxattrop to iothreads)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=267

commit 9fd8f212bc1f6031b9ad7eaaf014d39916881947
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Sep 15 04:47:50 2009 +0000

    Dumop inodectx added
    
    Added dumpop inodectx.
    Support for dumop inodectx added in dht, locks and client-protocol.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit dcfc4bdd5962ad18665d9ad3f3309884c941845e
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Sep 15 04:46:44 2009 +0000

    Changed prototype for inode_table_dump() and inode_dump().
    
    Changed prototype for inode_table_dump() and inode_dump()
    Added support for dumpop inode in mount/fuse and protocol/server
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit 5480b6eca96a8da4b159783a19f2ed5c2f640769
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Sep 15 04:45:08 2009 +0000

    protocol/client: Support for dumpop priv.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit b542a8e5323fad46ce4e5f8921c906a58cff91d2
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Sep 15 04:44:41 2009 +0000

    mount/fuse: Support for dumpop priv.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit db3d9ff328a9ce65db452d628f33c3151e131d5e
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Sep 15 04:43:48 2009 +0000

    cluster/dht: Support for dumpop priv.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit fd9c608193b3318a543f25f75af7b888d85c4405
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Sep 15 04:43:29 2009 +0000

    liblwfs:Acquire lock before accessing fdtable contents during statedump.
    
    Hold lock while dumping fdtable.
    Dump only inode ino instead of the complete inode.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit 58e6643e036bda21f686955d779bb95ac513ab62
Author: Vijay Bellur <vijay@lw.com>
Date:   Tue Sep 15 04:42:09 2009 +0000

    lwfsd: Removing conditional compilation for SIGUSR1 handler.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit 34a7a97b3be80fa8af7d285211ab575a4c00ea79
Author: Anand Avati <avati@lw.com>
Date:   Wed Sep 16 05:43:01 2009 +0000

    io-cache: fix table->max_pri to 1 as the lowest priority
    
    patch http://patches.lw.com/patch/1319/ breaks when no priority
    is mentioned in the config. the patch makes ioc_get_priority() return
    1 as the value when no priority is given, but ioc_get_priority_list()
    was still returning 0 as the max_pri (maximum priority) which would
    result in lru list heads not getting initialized
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 261 (support for disabling caching of certain files)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=261

commit 47b340a0d499d5f9364f763e5794a433be609e17
Author: Vinayak Hegde <vinayak@lw.com>
Date:   Wed Sep 16 02:37:19 2009 +0000

    cluster/stripe, when dbench is run, client crashes because in stripe.c priv is dreferenced without initialising.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 266 (In stripe client crashes after some time when disk space is full)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=266

commit e16fc897aeece7598da195bb9bd050e352ff31ec
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 15 08:06:56 2009 +0000

    booster: use __REDIRECT macro to prevent creat being renamed to creat64.
    
    - nm on liblwfs-booster.so shows only creat64 defined but not creat. This
       behavior is observed due to following reasons.
    
       1. Booster is compiled with _FILE_OFFSET_BITS=64.
       2. fcntl.h when included with _FILE_OFFSET_BITS=64 defined, renames all
       occurences of creat to creat64 in the source code from the point of
       #include <fcntl.h>.
    
       fcntl.h should be included since booster.c uses many of the macros defined in
       that header and lwfs (booster in turn) has to be compiled with
       _FILE_OFFSET_BITS=64 since lwfs uses datatypes (off_t, stat etc) whose
       sizes vary depending on whether this macro is defined or not. Basically, this
       macro should be defined to provide portability across 32 and 64 bit
       architectures.
    
       The correct fix is to make lwfs to use datatypes big enough to hold 64 bit
       variants as well as 32 bit variants (like int64_t replacing off_t) and not to
       define _FILE_OFFSET_BITS=64 at all.
    
       As a temporary work around,
       1. we can implement creat functionality in a function with different name, say
       booster_false_creat
       2. rename this function to creat using __REDIRECT macro. since this renaming
       happens after renaming of creat to creat64 (from the first __REDIRECT macro
       in fcntl.h), we will end up with creat symbol being defined in
       liblwfs-booster.so
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 264 (creat is not resolved properly to the symbol defined in booster)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=264

commit 3508a2d237cee98eb5c890011b569a1820b57f5c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 15 08:07:30 2009 +0000

    liblwfsclient: NULL terminate the vmp entry during vmp_entry_init.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 263 (files are not resolved to lwfs when vmp is not terminated with a '/'.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=263

commit 7bc96160b977345bda80c09e212d9d9c80243e7f
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 15 08:07:15 2009 +0000

    booster: use appropriate conversion specifier during logging in close.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 262 (crash in booster close due to invalid conversion specifier during logging.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=262

commit 8719f88fc85051b706c0fbf2904ace04435b2b05
Author: Stephan von Krawczynski <skraw@ithnet.com>
Date:   Mon Sep 14 05:59:55 2009 +0000

    2.0.6 patch for io-cache pattern-matched non-caching
    
    Hello all,
    
    here is a small feature patch. Its intention is to give the user more control
    over the files performance/io-cache really caches. If the user knows exactly
    which files should be cached and which shouldn't there is currently no way to
    tell lwfs _not_ to cache certain pattern. This patch allows you to
    disable caching by setting the priority of a pattern to "0". If you do not
    give any priority option it works just like before and caches everything.
    Honestly I am not totally sure that disabling caching works the way we did it,
    please comment.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 261 (support for disabling caching of certain files)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=261

commit ece4e80b2d2326aa5fadc46c866947c9644622a7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 15 01:15:14 2009 +0000

    storage/posix: transform inode number in stat structure
    
    - when export directory is configured to span across multiple mountpoints,
        the inode number has to be transformed in order to make it unique.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 254 (storage/posix has to do inode number transformation wherever it unwinds with a stat structure)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=254

commit a5f0b3d7d1b23053ce9327be91323e92ce554b32
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue Sep 15 01:03:56 2009 +0000

    extras: Add LD_PRELOAD test tool
    
    This tool allows us to check the sanity of the LD_PRELOAD
    mechanism so that we can be sure that an application's syscalls
    will be redirected into booster when that library is LD_PRELOADed.
    
    In case of failed syscalls, this tool should be run first
    to see if the calls are redirected as required.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 251 (Improve booster debugging through ld-preload testing tool)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=251

commit ad33df39dec4850c249c453822a99b3038b41389
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 15 00:33:30 2009 +0000

    transport/ib-verbs: initialize fini member of new-transports created during accepting client connections.
    
    - This bug used to cause a memory leak of 2 * sizeof(ib_verbs_private_t) for each new client connection.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 259 (Memory leak on server side when there are large number of disconnections from clients)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=259

commit e73e7afe5630894faa7a2829969cd16ea99e3c71
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Sep 10 07:18:10 2009 +0000

    liblwfsclient: Wait for time ample enough for all the children of distribute to initialize before sending lookup on '/'.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 255 (liblwfsclient should wait till all the children of distribute are initialized before sending first lookup on '/')
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=255

commit 31f0f48130fb68908413e710d960c5d7c6476b45
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Sep 9 12:15:11 2009 +0000

    protocol/server: server_stub_resume should check for failure of lookup when oldloc.parent is NULL.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 215 (crash on ib-verbs in 2.0.6-rc4)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=215

commit aedc8ae261095530e334788afb7191fa3a92e710
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Sep 9 00:39:13 2009 +0000

    booster: Fix fd_t leak in pread64
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 174 (booster: fd_ts, they are a leakin)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=174

commit 6aff97e9698918af6d5e479b0240610d40cbe344
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Sep 9 00:39:12 2009 +0000

    liblwfsclient: Fix incorrect NULL check for fd
    
    We should check fdctx instead.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 253 (Global bug for liblwfsclient NULL checks and CALLOC handling fixes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=253

commit 19f3591e4ac291d48252849e03afd2ac77205316
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Sep 9 00:39:11 2009 +0000

    liblwfsclient: Handle CALLOC failure in libgf_client_lookup
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 253 (Global bug for liblwfsclient NULL checks and CALLOC handling fixes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=253

commit bc94b7e77fffcbcde8f838cae8fee552d5bd1189
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Sep 9 00:39:10 2009 +0000

    liblwfsclient: Handle CALLOC failure in libgf_init_vmpentry
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 253 (Global bug for liblwfsclient NULL checks and CALLOC handling fixes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=253

commit 226c228ff8effd6cc5edcb3326907b1faf69eaea
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Sep 9 00:39:09 2009 +0000

    liblwfsclient: Add inode_ctx NULL check during iattr cache validation
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 253 (Global bug for liblwfsclient NULL checks and CALLOC handling fixes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=253

commit fd418ecf5d1eb4d3b65cff0890f8897592f2e9c8
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue Sep 8 23:39:35 2009 +0000

    liblwfsclient: Enhance logging
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 210 (liblwfsclient: Enhance logging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=210

commit c4feaddee1120985422346eb0ffdfb62c796ad1b
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue Sep 8 23:39:13 2009 +0000

    booster: Enhance booster logging
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 210 (liblwfsclient: Enhance logging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=210

commit b1cb5fce13eb1a31e694f0fcb81002d48455b750
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Sep 8 06:08:00 2009 +0000

    mount/fuse: Set d_type in readdir_cbk using the stat buf for the entry.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 207 ([ lwfs 2.0.6rc4 ] - "ls --color" takes time)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=207

commit b1246773d17fadf93abb54c2fd504b3fc31944a9
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Sep 8 05:06:22 2009 +0000

    cluster/afr: Check op_ret in afr_getxattr_cbk before accessing dict
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 250 (Crash in replicate getxattr)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=250

commit 1eb3fd72b13353fdb93dd0773d9da7aafccdde6b
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Sep 3 09:44:34 2009 +0000

    cluster/afr: Do not try to self-heal "/"
    
    If the root directory does not exist on a subvolume,
    don't try to create it.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 28 (Deleting a backend export directory in an AFR setup can cause a segfault while trying to self heal)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=28

commit 5ce1007f3b9a5234caa5b8a8c168c6b673d37f7e
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Sep 3 04:48:14 2009 +0000

    performance/write-behind: hold locks when accessing members of wb_file.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 243 (Hold locks when accessing members of wb_file_t.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=243

commit bdec7d133963bb94528bfbf5c47dd1eb08bf4b35
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Sep 2 04:54:23 2009 +0000

    performance/write-behind: communicate back the errors in writes to servers, in the next immediate writes from application.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 242 (If any of the writes fail, write-behind should not wait till the fd is closed for reporting errors)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=242

commit c7f757aea81e65980c68b4293836097ce595b5b3
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Sep 2 01:12:39 2009 +0000

    liblwfsclient: handle intermediate path components which are symlinks properly in lwfs_glh_realpath.
    
    - while building the realpath, if the intermediate path happens to be a
        symbolic link, the content of link was being appended at dirname (path),
        instead of appending to intermediate path.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 237 (If any of the path component other than the last one, happens to be a symbolic link lwfs_glh_realpath does not construct correct path.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=237

commit 6f1a9007f4876d46bd2d67e67312c24771d82bf5
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 1 00:34:02 2009 +0000

    liblwfsclient: handle paths terminating with '/' properly in libgf_trim_to_prev_dir.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 236 (Stack overflow due to infinite recursion in lwfs_glh_realpath)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=236

commit 8d696f317ef06e045de380d4408b814a3214ced7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Sep 3 13:42:04 2009 +0000

    liblwfsclient: handle failures in lwfs_glh_realpath.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 235 (Handle failures in lwfs_glh_realpath appropriately)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=235

commit ea8a20f3e68d5ccade465b60d98030c0c1bb4426
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 1 00:19:57 2009 +0000

    liblwfsclient: check for memory allocation failure in lwfs_glh_realpath.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 235 (Handle failures in lwfs_glh_realpath appropriately)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=235

commit b27afdea5d8c594e160a099e2dd814fa33529276
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 1 03:52:20 2009 +0000

    liblwfsclient: handle symlinks properly in lwfs_glh_opendir.
    
    - exclude symbolic links from set of filetypes to which ENOTDIR is returned,
        since a symbolic link can point to a directory.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 234 (Apache-2.2 on booster returns HTTP_FORBIDDEN for a directory which is present)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=234

commit 342100dac9d0e01039b8cd8a0da4426b70d27060
Author: Raghavendra G <raghavendra@lw.com>
Date:   Tue Sep 1 00:00:44 2009 +0000

    liblwfsclient: fix to the way symbolic links are handled in lwfs_glh_realpath.
    
    - don't assume the content returned by readlink while constructing realpath
        of a symbolic link to contain vmp as part of the path. This is necessary in
        case of symbolic links which contain relative paths as targets.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 233 (Crash in Apache running on booster when a client tries to access a symbolic link)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=233

commit 6cd8070af4c83cca9f3f7685a2a04bcb95059dd1
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Aug 31 22:53:33 2009 +0000

    performance/quick-read: if open fails during cache validation, don't continue validation process.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 232 (Quick-read: if open fails during cache validation, don't continue validation process.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=232

commit d6bc71ccb3a5265b01d188497213d797d7217c3d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Aug 31 22:52:34 2009 +0000

    performance/quick-read: Fix access of freed memory in qr_open_cbk.
    
    - It may so happen that current frame might be unwound and
        local might be freed when waiting operations are resumed.
        Hence store the information of whether this frame belongs
        to an open call in a local variable, instead accessing the
        flag from local at the end of qr_open_cbk.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 231 (Quick-read: Fix access of freed memory in qr_open_cbk.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=231

commit 8c95c2b69c08fa5c7d845e73d0e63fb2f001c511
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Sep 4 01:43:43 2009 +0000

    storage/posix: Synchronize access to this->private.
    
    Hold lock on priv while updating variables inside it.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 175 (Statistics for number of open files in Posix incorrect)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=175

commit fdef6f360f0755847d2520d79a4c7f0af35c7b0a
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Sep 7 03:13:50 2009 +0000

    storage/posix: Handle setgid bit on directories correctly
    
    If a directory has the setgid bit set, then any entry
    created under it must have group ownership same as
    the directory.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 241 (LW not honouring SETGID flag)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=241

commit eecce95c2fc4713146e4ba99817abaac94102763
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:37:37 2009 +0000

    performance/stat-prefetch: don't check for a non-null parent and inode in newloc during rename.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit ef073ee5430e1f3af3bd580dd99a72352889756b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:37:26 2009 +0000

    performance/stat-prefetch: minor bug-fixes.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 6bf11bf0dee3d3e70536a96cb8f8a4b01c26b445
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:37:16 2009 +0000

    performance/stat-prefetch: update design document.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit a5c829a3aa1d2f66dc85350bd4c163ef12507d44
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:37:10 2009 +0000

    storage/posix: handle dentries from different mount points in readdir
    
    - If posix translator is configured to have export directories to span accross
        different mount points, inode number is transformed in the dentry returned.
        Otherwise, the entry is not added to list of entries returned in readdir
        callback.
      - storage/posix returns ENOENT if the file is on different mount point other
        than that of exported directory and is not configured for export directory
        spanning across multiple mountpoints during lookup. But, since stat-prefetch
        shortcuts lookup calls, its necessary that readdir return only valid
        dentries.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 727c933a62e6b436c0aabcf80b6cd67620ee5429
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:37:02 2009 +0000

    performance/stat-prefetch: implement release callbacks.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 1d8f96e8c88b698a6cd1ec1f1a54f1b8aef70504
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:36:57 2009 +0000

    performance/stat-prefetch: implement sp_fxattrop.
    
    .../performance/stat-prefetch/src/stat-prefetch.c  |   37 ++++++++++++++++++++
     1 files changed, 37 insertions(+), 0 deletions(-)
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 5e89bf62f8fb7a2a863f8b0c08ee1815a5aa5b38
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:36:47 2009 +0000

    performance/stat-prefetch: implement sp_xattrop.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 284b42546e01f81e53b45695de1b4c893c98f418
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:36:37 2009 +0000

    performance/stat-prefetch: implement sp_checksum.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 251c9d6e83d4bdcc8180fc9f612fbef7ff4d39c3
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:36:28 2009 +0000

    performance/stat-prefetch: implement sp_getdents.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 26be5dc52d771b37d4e9da8814111448e4e68148
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:36:17 2009 +0000

    performance/stat-prefetch: flush stat corresponding to directory being read in readdir
    
    - delete the entry corresponding to basename of path on which fd is opened
       from cache stored in parent. This is necessary because readdir changes
       st_atime.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 155e6342d4f72d3be500510277b0808859ae2d2c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:36:08 2009 +0000

    performance/stat-prefetch: implement sp_setdents.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 9d30a68082659c27a9dac6e4d1a98e2be8bf5bf8
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:36:02 2009 +0000

    performance/stat-prefetch: implement sp_removexattr.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit a3449caf58d7e4876cf0246e22b044a8de8bde2b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:35:52 2009 +0000

    performance/stat-prefetch: implement sp_setxattr.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 52c34af5f4814b0b85efdc3c4d23638b6ca5514c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:35:36 2009 +0000

    performance/stat-prefetch: implement sp_rename.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 42d7559e8de1ca9c35dee6f731350c01a53932ad
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:35:02 2009 +0000

    performance/stat-prefetch: implement sp_fsync.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 562e2afbc6540d093086d4b41c6acedb48e1b0c5
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:32:06 2009 +0000

    performance/stat-prefetch: implement sp_writev.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 4b4b44960f5b6ccf1b0c5a222708654ae1d32a53
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:32:00 2009 +0000

    performance/stat-prefetch: implement sp_readv.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 1a2db6ed799d9ce05232422f5d5094da4fd5c35c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:31:53 2009 +0000

    performance/stat-prefetch: implement sp_rmdir.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 29c282b1605afe6d6016660e21018e1954ce0a79
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:31:45 2009 +0000

    performance/stat-prefetch: implement sp_unlink.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 22ec7a4cb2e05f2c3c4512d80256008caa8b994b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:31:37 2009 +0000

    performance/stat-prefetch: implement sp_readlink.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 4538285776eeaa5383d7473438440d953fd9e232
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:31:28 2009 +0000

    performance/stat-prefetch: implement sp_utimens.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 4d305aa59877b52a6818e87630c3ee7f5b050d5b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:31:19 2009 +0000

    performance/stat-prefetch: implement sp_ftruncate.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 464f92cac5cd932386bb3b816c207e16c88cfe06
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:31:12 2009 +0000

    performance/stat-prefetch: implement sp_truncate.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit e5097a05fb2b95c53c24ab891e54259e6c5f4378
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:31:04 2009 +0000

    performance/stat-prefetch: implement sp_fchown.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit d943335cf06c6569d6517e073b1619a8ea013298
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:30:58 2009 +0000

    performance/stat-prefetch: implement sp_chown.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit cde006b0f117944761e97e81d44362a046676422
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:30:47 2009 +0000

    performance/stat-prefetch: implement sp_fchmod.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 724f869021f7d673ed5b0993e39e93687587ee8d
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:30:39 2009 +0000

    performance/stat-prefetch: implement sp_link.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 81d858f16cba61dfdf9f4b1348703d2e5358a0ad
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:30:32 2009 +0000

    performance/stat-prefetch: implement sp_symlink.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit ff9a9eae29edc7927fea9d6bf006c8b181e2bbd7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:30:25 2009 +0000

    performance/stat-prefetch: implement sp_mknod.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 385faf46a6878c7a42a1a2cb2c7c68c92cc0cc3b
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:30:15 2009 +0000

    performance/stat-prefetch: implement sp_mkdir.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit acb388c4c584cbc601bee69b0ca297eb3a9ef296
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:30:06 2009 +0000

    performance/stat-prefetch: implement sp_opendir.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit b18aa9cd570cb20680aa3d5bac11a2674d2a2f78
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:29:54 2009 +0000

    performance/stat-prefetch: implement sp_create.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit ded6f40765a34dce2ec49d1b643770f110882b15
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:29:41 2009 +0000

    performance/stat-prefetch: implement sp_open.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit b0d3d94b8ca94d1a133f74050d078a4bd6fa5260
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:29:29 2009 +0000

    common-utils: introduce new macro GF_VALIDATE_OR_GOTO_WITH_ERROR
    
    - the existing macro GF_VALIDATE_OR_GOTO sets errno to EINVAL
        which may not be appropriate in all cases.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 2cbc63ca8bbfcb91bce775651e1acc0994a18ac0
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:29:19 2009 +0000

    stat/prefetch: free cache if it cannot be put into context of fd
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 8c110d0aba119d199e2e8d29418ed45119aeb30c
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Aug 26 01:36:53 2009 +0000

    performance/stat-prefetch: introduce sp_fd_ctx_t to hold context of fds
    
    - we need following extra members along with cache
        1. basename of path on which fd is opened. This is necessary to search
           for cached entry in fd based fops.
        2. inode corresponding to dirname of path on which fd is opened. This
           is necessary to get cache where entry corresponding to file on which
           fd is opened.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 3a0317982bfc8c507cfaf8dc919d5f4bab4371f7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:28:55 2009 +0000

    performance/stat-prefetch: implement sp_chmod.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 517c1997f5cb1ee7b62cc925f943b33e91e7b974
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:28:42 2009 +0000

    performance/stat-prefetch: implement sp_readdir.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit ebc5d9888dfd7fcc000fac82dcfbad9fb91a9082
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Aug 26 01:36:11 2009 +0000

    performance/stat-prefetch: implement sp_lookup.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit bcd092a21f4284277a7f59c58715bb253ed90ff7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Sun Aug 23 22:28:18 2009 +0000

    rewriting stat-prefetch translator
    
    - stat-prefetch aims to optimize operations like 'ls -l' where a readdir
       is immediately followed by stat calls on each of the directory entry read.
       More details on design can be found in doc/stat-prefetch-design.txt
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 221 (stat prefetch implementation)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=221

commit 314eb5fecf61b61ae9ba6bd76a44ea14bbd04513
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Sep 2 05:13:21 2009 +0000

    mount/fuse: Include missing header files in Makefile.am
    
    Compilation fails in a new lwfs tarball due to missing fuse headers.
    Including them in Makefile.am.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 244 (compilation after make dist fails because of missing headers)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=244

commit cf1005c9f650069a22d443dec32f33129431990a
Author: Raghavendra G <raghavendra@lw.com>
Date:   Mon Aug 31 22:35:28 2009 +0000

    ib-verbs: handle failure of ibv_create_qp gracefully.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 217 (crash in ib_verbs_create_qp)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=217

commit addf1c713a017a7b1b4a871243f599267255e815
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Aug 28 00:17:01 2009 +0000

    liblwfsclient: Compare compcount with path not maxentry
    
    When searching for an exact entry we need to compare the
    component counts in the candidate VMP and the count in the
    path being searched. This is opposite to the current
    situation where we compare the component count in VMP
    and the component count in maxentry, which will always
    be same.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 209 (VMP parsing through fstab has issues)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=209

commit 22e0167d054c6880a66d51a7d86695fe2dd97f44
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Aug 28 00:16:50 2009 +0000

    liblwfsclient: Enhance VMP searching logic
    
    Another attempt to enhance searching for VMP entries.
    There was a problem of returning the longest prefix match
    from all the VMPs without checking whether the number of
    matched components were same as the number of components
    in the candidate VMP.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 209 (VMP parsing through fstab has issues)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=209

commit d165f43bb127e2a055721aa7793743fd55e94ed3
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Aug 28 00:16:42 2009 +0000

    booster: Support backward compatible options
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 209 (VMP parsing through fstab has issues)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=209

commit c50ead8d5318d759207543ea040baaf8ddadc628
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Aug 27 01:53:32 2009 +0000

    core: Fix build failure on non-Linux systems
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 230 (Bulid fails on Solaris and Mac OS due to Linux specific flags)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=230

commit bc1bacb14650809f4685025c9fb4b799f9510df9
Author: Raghavendra G <raghavendra@lw.com>
Date:   Wed Aug 26 05:08:18 2009 +0000

    liblwfsclient: don't use pointer returned by basename while freeing allocated memory.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 228 (Segmentation fault in lwfs_getxattr)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=228

commit 4d479650245d15e6bb5d6993919ebd3eaa68f089
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Aug 25 05:09:28 2009 +0000

    fuse: protocol fix: fix bogus parsing of MKDIR message
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 226 (mkdir after rm of regular file of same name fails)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=226

commit 8572d0ced5db512620f515704e2a9c05d6a4589c
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Aug 20 13:49:03 2009 +0000

    changed booster fstab to parse the arguments same as mount.lwfs
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 209 (VMP parsing through fstab has issues)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=209

commit cb539b0b65d1868410a10266edb042bdaf867301
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Aug 20 18:51:10 2009 +0000

    protocol/client: 'connecting' event is properly notified.
    
    when there are no servers available to client, and transport init is
    not successful, send 'connecting' event once to parent so it doesn't
    hand in there.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 224 (Client hangs if none of the servers are up)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=224

commit 45883c74f2c3b11b77fa94be714341ccf0e21198
Author: Krishna Srinivas <krishna@lw.com>
Date:   Sun Aug 16 14:34:08 2009 +0000

    in server_rename if we do_path_lookup on the newloc and parent directory is not found, the server crashes.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit b4d6c3d1bb461d2c8a396c9ed3881a4da40fc6ab
Author: Vijay Bellur <vijay@lw.com>
Date:   Sat Aug 15 12:58:08 2009 +0000

    TAKE2[PATCH BUG:213 1/1] Support for Process State Dump
    
    Support for process state dump.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 213 (Support for process state dump)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=213

commit a31b0016347b3bc9b341fa0f4541ed137224f593
Merge: 862cbb3 1082475
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Mon Aug 17 15:25:44 2009 -0700

    Merge branch 'fusilli' of /data/git/users/csaba/lwfs-fusilli
    
    Conflicts:
    	xlators/mount/fuse/src/fuse-bridge.c

commit 862cbb38375f0176582b06019ba406818d236828
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Aug 4 19:43:31 2009 +0000

    added log message when server fails to send the reply frame
    
    As of now, if a frame submit fails on server, there are no logs,
    and clients will have missing frames (which leads to 'hangs').
    Supporting situation like this very tricky without proper log
    messages. As a step to make our log message lean and meaningful,
    this log is important.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 190 (missing frames due to larger reply message size.. (ib-verbs))
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=190

commit a55616242a4f883a864ac03b5282a12c6b8da03e
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Aug 13 02:57:18 2009 +0000

    liblwfsclient: Sync access to VMP list on new entry addition
    
    Some weeks back, I'd separated the big lock into vmplock and mountlock.
    See commit 304e4274ca9b0339539581c5413e3339078c1182 in mainline.
    
    At that time, we did not have a solution to the problem
    of when to init the vmplist in a thread-safe manner, since
    there was no lock to protect the vmplock specifically, and that
    when libgf_vmp_map_ghandle was called inside lwfs_mount
    so the "lock" was already being held.
    
    Now that we have separate mount and vmp locks, the
    accesses can be synced correctly.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 211 (liblwfsclient: Race condition against vmplist in libgf_vmp_map_ghandle)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=211

commit 425f895f0f89831221451c5aa8e0a7e31e95f2aa
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Aug 13 02:57:17 2009 +0000

    liblwfsclient: Enhance VMP search logging
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 210 (liblwfsclient: Enhance logging)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=210

commit e3a4b55920bf6620f5635a6785ae6f2eaf6eba2d
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Aug 13 02:57:16 2009 +0000

    liblwfsclient: Use components for VMP searches
    
    Till now, we've been doing a character by character comparison
    between a given path and the VMP, to search for the lwfs
    handle for the given path.
    
    This does not work for all cases and has been a known bug.
    This commit changes the byte-by-byte comparison into a more
    accurate component based comparison to fix search
    failures.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 209 (VMP parsing through fstab has issues)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=209

commit 53430bbd47dd61544e10596ca490e64cb2a4e85f
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Aug 11 04:59:29 2009 +0000

    features/locks: Fix reverse logic in posix_lock_to_flock
    
    if the lock's end point is LLONG_MAX, the corresponding
    struct flock's len must be 0.
    
    Previous code had LLONG_MAX and 0 reversed.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1e7a880cecfb4df0bb560f8d071cafda4889b6df
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Aug 11 01:43:33 2009 +0000

    mount/fuse: Don't log setlk returning EAGAIN as a GF_LOG_ERROR.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 70b1a8670152187bc4fb06d6a11437abe8481a9b
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Aug 11 01:42:14 2009 +0000

    features/locks: Set the right log level in a few places.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 95ee2689a6684e8e2436d5e8256c170ab3161673
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Mon Aug 10 02:17:43 2009 +0000

    lwfs log prints "TLA Revision" tag, remove it and reflect git instead
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 10824751f8669e7c39ebd46ab698ed0abd4e5165
Author: Csaba Henk <csaba@lw.com>
Date:   Sun Aug 16 15:51:23 2009 -0700

    fuse: a compat fix for older protocol revisions

commit 15d85ff1fb518ddd15e03daa297f59457376725f
Author: Csaba Henk <csaba@lw.com>
Date:   Sun Aug 16 07:02:27 2009 -0700

    fuse: optimize request iov aligment for writes
    
    Idea by Avati.

commit 3d894362ae0b8d346f29e9c3ea98e325d83a083a
Author: Csaba Henk <csaba@lw.com>
Date:   Fri Aug 14 15:51:37 2009 -0700

    fuse: switch off direct I/O mode if big writes are supported

commit a91679b605ffbe71fa7124964df8aea08ccba464
Author: Csaba Henk <csaba@lw.com>
Date:   Wed Aug 12 04:17:59 2009 -0700

    update user guide wrt. FUSE requirements

commit 901ba842cd6c42ff24e0539a1b8231b3e802e1ce
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Aug 11 18:26:11 2009 -0700

    bring in fusermount

commit fbb636390fe51dc6aa52ec7523a36b183434a28c
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Aug 11 06:24:40 2009 -0700

    fuse: add proper mounting support, based on libfuse routines

commit 472ac9944b2e99b8dd4a7e33f8dc4ae0f111b0cc
Author: Csaba Henk <csaba@lw.com>
Date:   Mon Aug 10 19:46:45 2009 -0700

    fuse: move libfuse derived code over under contrib/

commit ab5df475c5c7e9e0f3268fe94a6280e71d34c1db
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Jul 14 17:10:38 2009 -0700

    upgrade FUSE protocol to 7.12 and add support for older versions of the protocol

commit d5910898f1602dc16ab158b06c37abcd98a0588a
Author: Csaba Henk <csaba@lw.com>
Date:   Mon Jul 13 22:28:07 2009 +0200

    basic version of direct FUSE interface (ie. not relying on libfuse)

commit 57a6cb9806ad9d99e6866a21d16fcb1bafef000c
Author: Anand Avati <avati@dev.lw.com>
Date:   Thu Aug 6 21:51:33 2009 +0000

    protocol/client: fixed registration of saved_fds
    
    In client_open_cbk, client_opendir_cbk the list_add_tail macros were invoked with wrong
    ordered arguments, causing the existing registered fd list to get unlinked from the
    saved_fds list. The effects of this is far fetched - when transport disconnects, open
    fds are no more marked bad as they are not reachable from the saved_fds list. After
    reconnection, resumed access on this fd causes reference to invalid fds on the server.
    It could appear in the form of 'unresolved fd' error, readdir happening on a file fd,
    files reading from other files, etc.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 192 (sefault in posix-readdir)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=192
    
    BUG: 126 (Immediate segfault when used for rootfs)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=126
    
    BUG: 173 ([ lwfs 2.0.6rc1 ] - "server SEG fault")
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=173
    
    BUG: 194 (Apache+Booster results in inconsistent download size using wget)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=194

commit cce2f6f690b2cac2ed7383fb9306c0dd8b5d3aa6
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Thu Aug 6 00:55:53 2009 -0700

    Removed BRANCH: tag

commit 546390e845166ffcfcce6e47e105a453c3ac565c
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Aug 4 18:56:52 2009 +0000

    server-lookup: added path info from header to log message
    
    in the previous commit, the path info was removed to prevent the
    segfault, which instead could have been provided from request
    header directly. More specific information is required for debugging,
    and hence adding the path log.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 189 (segfault in server-lookup)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=189

commit e981886cb1da8cbde1f93a9ab249130e8be163f5
Author: Anand Avati <avati@dev.lw.com>
Date:   Tue Aug 4 18:15:23 2009 +0000

    dht_stat_merge - use the highest uid when ambiguous
    
    When directories on different subvolumes have different ownerships, use the highest uid/gid till self-heal resolves the inconsistency
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 191 (random Permission denied errors)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=191

commit aaf483185e6fdd1b0102ee2ae27e53826efdfc21
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Aug 4 18:15:45 2009 +0000

    add check for making sure 'fd' belongs to directory in posix-readdir
    
    The root cause of this error is not found yet. But this check will
    make sure that there is no crash when the situation happens.
    Segfault can happen when a readdir() call comes over file's fd.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 192 (sefault in posix-readdir)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=192

commit 33b5ce10ef7b5c6db6e73f6070fd4579c2765c94
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Aug 4 17:51:58 2009 +0000

    logging related bug fix in server_lookup()
    
    When 'dict_unserialize' failed, the log message was trying to
    print 'state->loc.path' and 'state->ino', which gets filled in
    later stages in flow. Caused segmentation fault when there was
    a failure.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 189 (segfault in server-lookup)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=189

commit edd633f30adba95c65d29c58a2562ccbb18c3495
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Aug 4 17:51:44 2009 +0000

    increased ib-verbs buffer size
    
    Noticed that in few cases, where ib-verbs doesn't handle a bigger
    sized buffer to be sent across, which happens without problem in
    tcp. Caused frame losses in the case where server's reply msg was
    bigger, hence the msg got dropped at the server end. With this patch
    ib-verbs buffer size is fixed to 512KB. (4 x page-size)
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 190 (missing frames due to larger reply message size.. (ib-verbs))
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=190

commit 2c056117b6cfe4bf3f62c791d2c6514bae8655d9
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Aug 4 17:51:31 2009 +0000

    adding an option to mount.lwfs for server failover to fetch volume files.
    
    With this option, 'single point of failure', in case of volfile server can be
    avoided
    
    Thanks to Cory Meyer <cory.meyer@gmail.com>
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 185 (Request to support secondary volfile-server option in mount.lwfs)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=185

commit e26e9b861d92edfb7c00aa1b7c8c3a4126a563fb
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Aug 4 04:39:34 2009 +0000

    cluster/afr: inode-read: Check stat buf for NULL before attempting to set inode number.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 184 ([ lwfs 2.0.6rc2 ] - Client Segfault while running fs-perf-test)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=184

commit acb06b282a64b2751d33424e4e833c0c7dcf87d7
Author: Raghavendra G <raghavendra@lw.com>
Date:   Thu Jul 30 23:08:42 2009 +0000

    client-protocol: log messages at WARNING loglevel when client_bind on privileged port fails.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 140 (use appropriate loglevel to log in case of failure to bind to privileged socket)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=140

commit b63f69cdf40ef5bd79abdcd641b3dcc4bcb3cb1a
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Jul 31 12:38:36 2009 +0000

    liblwfsclient: Bind fd on fd creation code paths
    
    When an fd_t is fd_create'd, we need to call fd_bind on it to
    ensure that any fd_lookup on the inode gets us this fd. We're not
    doing this so translators like write-behind were not able to order
    path-based requests at all resulting in some fops like stat, which
    could be issued after a writev, overtaking a previous writev which
    is still being written-behind.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 179 (fileop reports miscompares on read tests)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=179

commit 2f8a834e7b6acef73795237d6c6269eb9838de53
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Jul 31 04:14:48 2009 +0000

    liblwfsclient: Invalidate iattr cache on reads
    
    Earlier we have invalidated the iattr cache on writes. Now
    we need to do so for reads also, so that we are not updating
    the iattr cache with 0-filled stat received from io-cache.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 180 (fileop fails at chmod with stale file handle error over unfs3)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=180

commit fdbc5cf320fe85d128d498184135df10146047ba
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jul 30 12:05:11 2009 +0000

    replicate: Return ino from first subvolume on inode creation fops
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 177 (replicate: On file/dir creation, replicate returns inode from random subvolumes)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=177

commit 83ef3c8211282a9ef66659bfbde25116e4949b71
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jul 30 12:04:05 2009 +0000

    liblwfsclient: Use iobufs for storing application write data
    
    Till now we've been creating an iovec, storing references in it
    to the application data and simply passing it on to the translator
    tree. This means that the buffer being passed to the translators is
    not at all associated with the memory ref'd by the iobref argument
    to write fop. This is a problem when write-behind is a translator in
    the tree since it assumes that the memory in the iovecs passed to
    write fops is already refcounted by the iobref and so it simply copies
    the address of the application data. The problem is that the application
    can continue using this buffer, free it or over-write it destroying the
    data that write-behind may write at a later time.
    
    The solution involves copying the application's write buffer into
    an iobuf which will be referred to by the iobref.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 178 (liblwfsclient: Data corruption on using write-behind in translator tree)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=178

commit 9beaccbee6b9e3356e04887c2f3e3f6e8d781228
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Jul 29 08:02:57 2009 +0000

    booster: Fix fd leak due to incorrect NULL check
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 174 (booster: fd_ts, they are a leakin)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=174

commit a4c6e7c816fa9dfbed07a30af56a4ada824ce40b
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Tue Jul 28 00:52:56 2009 +0000

    lwfsd: handle logfile path specification appropriately.
    
    when logfile path is not specified as absolute path, the symbolic
    link created to the logfile (only in invocation of lwfs with
    --run-id) might end up as a broken symbolic link.
    
    for example, command-line invocation like below will result in
    broken symbolic link:
    lwfsd -f /home/lwfs/volfiles/nufa/nufa.vol
    -l ../home/lwfs/logs/nufa.f1.log --run-id nufatest /mnt/nufa/
    
    symbolic link will be created at $PWD/../home/lwfs/logs/nufa.f1.log
    will have a value of ../home/lwfs/logs/nufa.f1.log.<date>.<time>.<pid>.
    this symlink might be broken.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 156 (Broken symbolic link when relative path is given for a log file)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=156

commit 8225fd2307d8a5a9bba4f21b5534b8469f679605
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Jul 27 16:48:37 2009 +0000

    server-protocol: fix in server-loc-fill()
    
    to continue with 'hashed' inode, even if inode_path() on the inode
    fails. This will is needed for few lock operations, to unlock the
    lock held on inode. (ie, it fixes 'rm -rf *' hang issue, seen from
    multiple clients).
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 112 (parallel deletion of files mounted by different clients on the same back-end hangs and/or does not completely delete)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=112

commit 152e36883a79c0d73e0725357a4a2870b06eb75b
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue Jul 28 04:51:35 2009 +0000

    liblwfsclient: Fix solaris build error
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 115 (./configure adds liblwfsclient when it shouldn't)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=115

commit ed80e78aecf5f46e29e5cb9034f2b2c06836b8d4
Author: smyczek <smyczek@simplito.com>
Date:   Mon Jul 20 18:44:00 2009 +0000

    liblwfs: fix SuperFastHash function used in dicitionaries in fact it always returned the value of second parameter (len) as a result.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 155 (The SuperFastHash function used in dictionaries is broken.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=155

commit 1b89e8689c070ceeeafa24e03c8aed6e17540aef
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jul 23 11:25:01 2009 +0000

    cluster/afr: Use user-supplied struct flock to STACK_WIND
    
    afr_lk_cbk:
     Use the original struct flock supplied by the
     user to do further STACK_WIND's, and not the flock returned
     by the previous STACK_WIND.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 159 (Client hangs when coherent byte range locks is attempted in replicate setup)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=159

commit f33cdc33e28fa8364691a853e3bee84b335a4f9c
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Sat Jul 25 12:59:14 2009 +0000

    liblwfsclient: Workaround for local memory corruption
    
    There seems to a reproduceable corruption specifically of
    the liblwfs_client_local_t that is allocated for
    the read call. Therefore, the subsequent access to fd inside
    local leads to a segfault. This is a temporary fix.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 164 (liblwfsclient: Segfault due to memory corruption of frame local in libgf_client_read)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=164

commit ccd93eb64c0f2f73f83e025d3efae794803aaa4c
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Jul 27 09:30:48 2009 +0000

    cluster/afr: Return same inode number in stat buf for readv_cbk
    
    Remember the inode number that had been returned in lookup_cbk
    and set the stat buf->ino to the same.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 166 (liblwfsclient: Cached stat buf inode is different from ino in inode_t)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=166

commit ffa5118b2eec9cd12e43ca10d86e91d02a9090a8
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Jul 27 04:29:26 2009 +0000

    cluster/afr: Set inode number in unwind_buf in the inode-write calls.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 166 (liblwfsclient: Cached stat buf inode is different from ino in inode_t)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=166

commit df868214c077065cfeafcfdadb6bbf5151d20b3d
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jul 23 16:19:26 2009 +0000

    liblwfsclient: Avoid overwrite of inode found through ino number
    
    In libgf_client_loc_fill, there is a possibility that all
    the ino, par and name are specified as non-NULL,non-zero args.
    
    So if an inode is located in the itable using the ino and the
    subsequent search for the inode using the par-ino and the file
    name does not result in an inode being found, the current
    code over-writes the inode that was found through the ino. The
    correct behaviour is to stop further searches if inode
    was already found using ino.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 161 (unfs3 crashes on link system call by fileop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=161

commit 955c6e0c87b501501d87806f1e69ece8f0559dd6
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jul 23 16:18:43 2009 +0000

    liblwfsclient: Fill new loc with target's ino on link
    
    In the loc_t of the link being created, we must fill in the inode
    of the old/target loc since this is a link operation. The
    inode_link to the new parent is called in libgf_client_link.
    
    This fixes a crash while running fileop over a fully-loaded
    dist-repl vol file.
    Ref: Bugzilla 161
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 161 (unfs3 crashes on link system call by fileop)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=161

commit 48755d7eaf9d22e4707b7abc7b3df46256fa6069
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Thu Jul 23 15:38:32 2009 -0700

    enable liblwfsclient build by default
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 03d6dae5a4003bcaf86eb887f63444c0565ad32c
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Jul 20 01:25:12 2009 +0000

    liblwfsclient: Fake a fsid for every VMP
    
    This is needed to work around the replicate behaviour of
    possibly returning device number for the same file from
    
    different subvolumes.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 148 (replicate: Returns st_dev from different subvols resulting in ESTALE thru unfs3booster)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=148

commit a12f332cff050db3aa3905436158cbd339fa6963
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Sun Jul 19 03:26:13 2009 +0000

    liblwfsclient: Move DHT root-lookup workaround to init
    
    The workaround for the DHT requirement for a lookup on /
    needs to be done only once when the xlator graph is inited.
    Doing it on every path's lookup results in a major performance
    penalty when using distribute subvolumes upwards of 16, as reported
    by Avati.
    
    Ref: bug 152
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 152 (liblwfsclient: DHT workaround is a major performance bottleneck)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=152

commit 1a56bed50190e20999d28b7da8418927ecb8b041
Author: Amar Tumballi <amar@lw.com>
Date:   Sat Jul 18 00:37:51 2009 +0000

    added timestamp to crash dump log.
    
    also did some minor enhancements in formating
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 151 (crash dump log should be in 'logviewer' friendly format)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=151

commit 7b8d2b38a12ed7e0a63ad9b1c38bfa20d8317b11
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:44:24 2009 +0000

    fix build warnings in 'liblwfsclient'
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 130 (build warnings)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=130

commit 500d114032c0d6f92abd25fbf6786b866a0b3dd5
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:44:11 2009 +0000

    fix build warnings in 'afr'
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 130 (build warnings)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=130

commit 0af7bd9a1f590a17490663869420bd8777189b97
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:43:56 2009 +0000

    fix build warnings in 'server-protocol'
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 130 (build warnings)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=130

commit 793ca3c52a9ba6a1723e5ad767449f8b69ac19a8
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:43:19 2009 +0000

    fix build warnings in 'client-protocol'
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 130 (build warnings)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=130

commit 05211cdaff7ac117095c2213722b386c0f172ed0
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:42:55 2009 +0000

    fix build warnings in 'io-cache'
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 130 (build warnings)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=130

commit d62362acd64a2d495431f6c4ff7dffc8d47856df
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:42:33 2009 +0000

    fix build warnings in 'auth' module
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 130 (build warnings)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=130

commit ca859dfe78e3da853181e5e9e314586bf9300204
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:42:10 2009 +0000

    fix build warnings in lwfsd
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 130 (build warnings)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=130

commit 632cce5e720acaa28ab680a6850f2aa8289d4628
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:41:44 2009 +0000

    fix build warnings in 'liblwfs/'
    
    return value of 'asprintf' was not checked, and the flow was
    continuing without returning error, which could cause potential
    segfaults in code (mostly possible during ENOMEM case).
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 130 (build warnings)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=130

commit 5be3c142978257032bd11ad420382859fc204702
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 17 22:09:17 2009 +0000

    posix getxattr supports new key 'trusted.lwfs.location'
    
    which can be used to get the file location by 'hostname' of the
    machine where file resides.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 131 (provide a way to get the file location in clustered storage)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=131

commit 2105226253d4fe8cca2e31de76960ddc1a47a8c3
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Jul 15 20:06:02 2009 +0000

    removed mod_lwfs from the build
    
    future plan is to have httpd use booster and liblwfsclient
    instead.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4b3633cde1bb9a9a692eade129e4a45dbf82d8ec
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Jul 17 08:48:10 2009 +0000

    liblwfsclient: Invalidate not update iattr cache on writev
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 149 (liblwfsclient interacts incorrectly with write-behind on writev)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=149

commit 847e02d901a5cedf4f28d34fa2431b41a07b9a2a
Merge: 2a385c2 5dfa1eb
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Thu Jul 16 00:40:33 2009 -0700

    Merge branch 'master' of ssh://git.sv.gnu.org/srv/git/lw

commit 2a385c2984a8dd670c4b77361d8a24c3567138f5
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jul 14 17:38:42 2009 +0000

    server: don't check for 'loc->parent' in entrylk and inodelk calls
    
    the lock operation on entry or inode is going to happen on only one
    inode, and it doesn't need dentry (with info on parent) for the
    lock operation to complete. Hence, in server_{inode,entry}lk() calls
    after server_loc_fill, we -should not- be checking for parent inode.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 112 (parallel deletion of files mounted by different clients on the same back-end hangs and/or does not completely delete)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=112

commit bdcdc8dd18dda19af698f147e3f32ed7f9e5efd5
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jul 14 17:38:08 2009 +0000

    change mount.lwfs.in to work with non-bash shells too.
    
    removed 'fuction ' prefix to function definitions which was very
    much /bin/bash specific.
    
    Thanks to Brent A. Nelson <brent@phys.ufl.edu> for the patch.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 139 (tiny glitch in mount.lwfs in 2.0.4)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=139

commit 41986e06d0e8e5f66f20944bc8d8abeca1d73ab1
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jun 23 19:08:46 2009 +0000

    iostat to have more io details
    
    classified stat for write/read fops based on their block size.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit eb4d32ae6b30e5a6aaebf068cc07e7ad2c6ea6d2
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:29:06 2009 +0000

    quick-read: implement release and forget cbks.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8a184d6f5674b3d5ec50eeaf089ded3c9c14300f
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:28:45 2009 +0000

    quick-read: implement qr_lk.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 5c95b6568201a6b9e0043ad838892599ab0e0d90
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:28:34 2009 +0000

    quick-read: implement qr_ftruncate.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 56428dbbbdd802d2d8cf4377d4f03a59caab7c8b
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:28:22 2009 +0000

    quick-read: implement qr_fsync.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 689f87e0db1eaa6ccc0b311b4e469fd922e4237f
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:28:08 2009 +0000

    quick-read: implement qr_finodelk.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ed9687b7fc050b6fcd8ef79eab977d1ef2f1e801
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:27:57 2009 +0000

    quick-read: implement qr_fentrylk.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 206e1af66adea885fcaf5ad02a510ac0deb36870
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:27:46 2009 +0000

    quick-read: implement qr_flush.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit cd945c716fdbd430d575f43732801163b076b258
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:27:34 2009 +0000

    quick-read: implement qr_fgetxattr.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit aa42833f33952aae55afb6e02376d7f2a766f438
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:27:23 2009 +0000

    quick-read: implement qr_fsetxattr.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit aa0902f9d18bdc72e5d0ed2add15962a02b0b40f
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:27:11 2009 +0000

    quick-read: implement lc_fchmod
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c744ff99b5e72f7b6ee1909b90649333b6ffc98d
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:26:58 2009 +0000

    quick-read: implement qr_fchown
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8579b0edbc8c6d14614777aa7ca7de6d42fb1662
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:26:47 2009 +0000

    quick-read: implement qr_fstat.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 01ccfc375925a1643afbd5ce2eb8078a617db881
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:26:35 2009 +0000

    quick-read: implement qr_writev
    
    - writev on any fd opened on a file invalidates the cache stored during lookup
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 493e712940fd4c1ce621db0c970597b11446da3e
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:26:14 2009 +0000

    quick-read: implement qr_readv
    
    - pseudo-code of the algorithm is given below
        if (content is cached) {
           validate-contents ();
           if (content cached is valid) {
              stack unwind with cached content;
           } else {
             goto read-from-storage;
           }
         } else {
            goto read-from-storage;
         }
    
         return;
    
    read-from-storage:
         if (open is already done on fd) {
              stack-wind read;
         } else {
           add the current readv to list of operations waiting on completion of
           open;
    
           if (open on the fd is in transit) {
             do nothing;
           } else {
             stack-wind open;
           }
         }
    
         return;
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit eaac497bfe4dd95a5d5ea34bf59c16bf946960e9
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:26:00 2009 +0000

    quick-read: implement qr_open
    
    - The file is opened actually only if it is not cached already in lookup.
        This adds responsibility for fops operating on fds to make sure that a
        valid fd actually opened on a file is used to complete the fop.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 06f02a48e0632469a7fd3ab1d7b5364a0de82d91
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:25:45 2009 +0000

    quick-read: add qr_lookup.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1b4e68977c43b8d432d28d7301add35b01464ae5
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 00:25:28 2009 +0000

    Implementing quick-read translator.
    
    lookup can fetch the entire file in xattr dictionary using the key
    "lwfs.content". We set the maximum size of the file that can
    be fetched so in the xattr_req dictionary using the same key. If file-size
    is less than or equal to the value set in dictionary, the content is stored
    in the dictionary using same key in lookup_cbk.
    
    For small files, we can do an optimization wherein we do not really send the
    calls open, read and close to the storage translators. Instead there can be
    an xlator which fakes open, read and close calls. For reads, it sends the data
    it has cached during lookup and hence saving the time for open, read and close
    calls to reach storage translators (this time can be significant if calls have
    to go through network to reach storage translator).
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 3e3be6de2d954bcd134e8f377ea1af4cab682e04
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Jul 15 09:36:36 2009 +0000

    Return stat from read subvolume in dir-write ops.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 138 (create family calls do not return stat buf from read child)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=138

commit e07a362a54c6f1bff5b87ce30a5302f0cd01c086
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jul 14 08:05:14 2009 +0000

    Return stat info from read-child in all the inode-write ops
    
    Also modifies the inode-write ops to wait for the call
    to read-child to return (whether success or failure)
    before unwinding.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 125 (stat information not returned from the same subvolume always)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=125

commit 3ce764351c0cdf01637eb0f19ec9846e91ca3f35
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Jul 15 01:38:33 2009 +0000

    add strict validatation of GF_OPTION_TYPE_PATH option type.
    
    Make sure that users don't provide "../" in the path value in volume file,
    which should be considered security issue.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 141 (GF_OPTION_TYPE_PATH should check for presence of ".." in path)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=141

commit 61d9179fd8e884e3ace5b1ffd38f89e5032dbb42
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue Jul 14 09:43:23 2009 +0000

    fuse-bridge: Export user.lwfs-booster-mount xattr
    
    This needs to be exported in order to have the booster
    Mount Point Bypass technique work through liblwfsclient.
    Booster uses the mount point to register with liblwfsclient as
    a VMP. Subsequently, all file operations on the mounted LWFS
    mount point get redirected to liblwfsclient.
    
    This fixes bug 136.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 136 (booster does not redirect ops on LWFS mount point into liblwfsclient)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=136

commit f2ba42e4c6e44db9274d051065a233d9ed622959
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Jul 13 16:59:18 2009 +0000

    break inode_path if the length of the path crosses PATH_MAX
    
    a given search for path can't exceed the length of PATH_MAX in any case.
    Hence, its best to make sure by adding a check inside the for loop of
    inode_path, so that it won't enter an infinite loop.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 134 (infinite loop in inode_path ())
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=134

commit 106f0e848a6ae3a04ee9d1c1752badf60767d039
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jul 10 13:39:10 2009 +0000

    cleanup 'ctx' from inode and fd
    
    Removing unused 'dict_t *ctx' from both inode and fd structures.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 128 (cleanup unwanted ctx dictionary in 'inode' and 'fd' structures.)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=128

commit 22c076cadc04e15aa84f86bca621d38fbf111932
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jul 9 23:59:26 2009 +0000

    ib-verbs: don't append ioq_entry to pending_list if first attempt of writing to network fails
    
    * fix to bug #101 - When a buffer bigger than ib-verbs-work-request-send-size
        was attempted to write to network, ib-verbs returns ENOTCONN. Neverthless,
        the ioq_entry corresponding to the write was appended to the pending lists
        of ioq_entries waiting to be written to network. This resulted in double
        free of header, once in protocol_client_xfer and again during cleanup of
        transport. The transport cleanup happened due to the timeouts of
        subsequent operations, since ioq_entry corresponding to writev
        was blocking any other operations from reaching server.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 101 (ib-verbs config crashing while dd'ing with a big mtu size)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=101

commit 359e87e72fcfc30909b0131a5e559466713245ed
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Jul 14 06:41:33 2009 +0000

    fuse_bridge: handle failures in init() more gracefully
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 132 (fuse-bridge could do with some cleanups)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=132

commit fc4aa3ee763e8f05a8bd649d414fb8c278fe7380
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Jul 14 06:40:09 2009 +0000

    fuse-bridge: formatting cleanups
    
    - use PRIu64 for printing "unique"
    - use fcntl defines instead of explicit numeric values for querying open flags
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 132 (fuse-bridge could do with some cleanups)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=132

commit 1253692116532433d04d606ec81fbccd4db8a50a
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Jul 14 06:38:34 2009 +0000

    fuse-bridge: further allocation failure handling fixes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 132 (fuse-bridge could do with some cleanups)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=132

commit e16068f9e62b2812e4e78ed25b0b05fa67c5f3c8
Author: Csaba Henk <csaba@lw.com>
Date:   Thu Jul 9 12:17:54 2009 +0000

    fuse-bridge: handle state allocation failure
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 124 (state allocation failure not handled)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=124

commit a81ffd3b4eb53f57ef360872a85241d86b6c46ad
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jul 9 06:47:14 2009 +0000

    Added NULL checks in a few places.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 119 (filter + replicate crash..)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=119

commit 161188e919968f1d782e857151f2f4dca1fdfc22
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jul 9 05:33:54 2009 +0000

    Return inode number always from the first up subvolume in AFR.
    
    Also fixes a bug in the "KLUDGE" part. It was setting lookup_buf
    when it should have been setting local->cont.lookup.buf
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>
    
    BUG: 116 (Replicate: Need inode number from first subvolume on fresh lookup)
    URL: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=116

commit c276dfe936dbb48cd5569099c5cc142122d160f8
Merge: 964cb91 dd6635d
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Thu Jul 9 14:08:44 2009 -0700

    Merge branch 'master' of ssh://git.sv.gnu.org/srv/git/lw

commit 5dfa1ebac3eab4f0ff8fab6936e6678bb76c5f60
Merge: 964cb91 dd6635d
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Thu Jul 9 14:08:44 2009 -0700

    Merge branch 'master' of ssh://git.sv.gnu.org/srv/git/lw

commit 964cb91e0341f1a15dd57e8487e0c01490b804d8
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Wed Jul 8 23:54:48 2009 -0700

    Added format-patch.sh. This script is to be used as a replacement of "git format-patch" with similar arguments for submitting patches to the LWFS project

commit dd6635dc3763979a63d37cb8232324e4bd2d605e
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Wed Jul 8 23:54:48 2009 -0700

    Added format-patch.sh. This script is to be used as a replacement of "git format-patch" with similar arguments for submitting patches to the LWFS project

commit fffaec58ea396cd8cf3303e38f331c25a4feaad1
Author: Csaba Henk <csaba@lw.com>
Date:   Wed Jul 8 06:55:09 2009 +0000

    detabify fuse-bridge.c (and other whitespace fixes)
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 45dc9a636f085d0cc2a86b949e86afedca411203
Author: Anand Avati <avati@lw.com>
Date:   Tue Jul 7 20:42:42 2009 +0000

    protocol/server: use translated flags in protocol/server open and create fops
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a2205684e2ea21e33dac00b40a0314af045ad6be
Author: Anand Avati <avati@lw.com>
Date:   Tue Jul 7 20:42:21 2009 +0000

    protocol/client: use translated flags in protocol/client open and create fops
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 9ec22fd9fc28684b7e2093b4c67d449c7f021623
Author: Anand Avati <avati@lw.com>
Date:   Tue Jul 7 20:41:59 2009 +0000

    protocol: add functions gf_flags_from_flags and gf_flags_to_flags
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bde0032cfbe51383c697247831e26394ca6cd913
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Jun 30 01:14:44 2009 +0000

    write-behind: set default window-size to 1MB.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 80c769b54ed8e95ae3f51e19d2ef8c2e8ea5e44d
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Tue Jul 7 07:58:05 2009 +0000

    use fuse_reply_iov() in fuse_readv_cbk
    
    changes come in two places.
    
    configure.ac - define HAVE_FUSE_REPLY_IOV if fuse_reply_iov is
                   available in libfuse.
    
    mount/fuse - use fuse_reply_iov() in place of fuse_reply_vec(), if
                 HAVE_FUSE_REPLY_IOV is defined.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 54f5ccceca2531f1a88cb4d0404f92edffa09cae
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Jul 7 02:33:43 2009 +0000

    filter: use O_ACCMODE for checking file access modes.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4e9757859750eb3625828f83681845f1352af356
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Jul 7 02:33:31 2009 +0000

    read-ahead: use O_ACCMODE for checking file access modes.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ecc844dc15fffacaf37916e4570e520534f2545c
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Jul 7 02:33:15 2009 +0000

    write-behind: Use O_ACCMODE while checking for access modes.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c8ef6e541f4dacd58258b0448046d4fae2c511be
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jul 2 06:20:21 2009 +0000

    liblwfsclient: Update attr cache on read/write
    
    We werent updating the attr AKA stat cache on read and write
    on files so every stat on the file before the timeout was returning
    stale attr from the cache. Yuck!
    
    This fixes it. Turns out there is a good aspect of unfs3's notoriety
    when it comes to doing stat()s for every operation.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 41027a22054af821caeb2b47a7b93ff028ecaedf
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 22:08:21 2009 +0000

    liblwfs/defaults - send CHILD_UP notify only to the parent which has been init()ed.
    
    fixes bz# 12
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8d74fe9ba6c3c2f68f71cacd56fad9328b8b0090
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 04:27:10 2009 +0000

    liblwfs/logging - fix memory leak
    
    in _gf_log(), free 'msg' before returning.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 346b7f0c63920a73fd70b88d683c6a033e6b8abd
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Jul 6 05:59:47 2009 +0000

    Set timestamps properly when creating missing entries.
    
    In AFR self-heal set timestamp of a freshly created missing entry
    to that of the source entry.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit fd70ec76469204ffa7c8145c978f2fba6dca9a7a
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 05:47:25 2009 +0000

    liblwfs - remove definition of ZR_FILENAME_MAX
    
    to maintain uniformity of maximum length of file name, through out
    lwfs, use NAME_MAX.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit fe3d249f1aec607aed5895d66a869620ba30f9cf
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 05:47:32 2009 +0000

    cluster/afr - replace ZR_FILENAME_MAX by NAME_MAX
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit d538b139fb197d7397e45b4bc5a9446823186568
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 05:47:31 2009 +0000

    cluster/unify - replace ZR_FILENAME_MAX by NAME_MAX
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bf70c1361f8eb82607f5fd9396edfad62ced7b89
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 05:47:30 2009 +0000

    protocol/server - replace ZR_FILENAME_MAX by NAME_MAX
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit f0314a6b781126dbbb25edf37460f68750d88896
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 05:47:29 2009 +0000

    protocol/client - replace ZR_FILENAME_MAX by NAME_MAX
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8fae42f8203df6a49b33eb7341def9782251f269
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 05:47:28 2009 +0000

    storage/bdb - replace ZR_FILENAME_MAX by NAME_MAX
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 28760cc3d37318e7e90ec65bf2ce6376916e8a3e
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 05:47:27 2009 +0000

    storage/posix - replace ZR_FILENAME_MAX by NAME_MAX
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 6abd0c49267973f57b8cf98f25e61ec587b2533a
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jul 6 05:47:26 2009 +0000

    liblwfs/call-stub - replace ZR_FILENAME_MAX by NAME_MAX
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a70f38f15a115cc258f297d6634dab90bc30f4dc
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Mon Jul 6 03:39:19 2009 +0000

    Updated man page with log-server options
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c78658544870e06ff399b9cee7ef22a1c18e5e4d
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Mon Jul 6 03:39:11 2009 +0000

    Added new man page for mount.lwfs
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 552c392449eb5ed3d249bea8d4467f817781caf0
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Mon Jul 6 03:39:03 2009 +0000

    Modified mount.lwfs to print usage in case of no mountpoint provided and "-o" options to be agnostic of their position.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 7261ef381a2c3c7bf5ef0ecd2392f7cab9e60e37
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Sat Jul 4 05:10:28 2009 +0000

    mem-pool: Do not perform chunkhead2ptr on MALLOCed memory
    
    Memory allocated from the heap instead of the mem-pool
    need not under go the chunkhead to ptr conversion when returning
    to a mem-pool user since this address can be use directly.
    
    This fixes a crash in io-threads.
    
    Ref: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=102
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c3f24c43a4cfb576a23de689c6107c4479e51307
Author: Csaba Henk <csaba@lw.com>
Date:   Thu Jul 2 11:03:57 2009 +0000

    booster: automake 1.11 compatibility fix
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 94f62eb4d50c7917c7c1ca36386045b110b30eda
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jul 2 00:52:28 2009 +0000

    liblwfsclient: Use O_ACCMODE for access mode checks
    
    Ref: http://www.gnu.org/s/libc/manual/html_node/Access-Modes.html
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 52d0ae7bc35680bcec094be39f119d966ea9a77f
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jul 2 07:08:47 2009 +0000

    Print volume file after printing other details.
    
    This makes the log format compatible with earlier
    versions. Fixes bug #105.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ebfcb5368c225aed11c007aee1e362c5d345c2b0
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Jul 2 01:55:29 2009 +0000

    performance/write-behind - bug fix in open() and create().
    
    open() & create() calls should reset frame->local to NULL.
    
    bz# 104
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4d176f44ce7b251794159371232954f810cfae02
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Jul 1 00:49:54 2009 +0000

    server protocol forget cleanup
    
    as client now doesn't send forget at all to server, it should take care
    of forgetting the inode when there is a successful unlink and rmdir fops.
    
    also cleaned up unwanted forget fop's code.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8301e2ffc44beb09cec7e01aa8672e857c6c3977
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Jul 1 00:47:29 2009 +0000

    cleanup client_forget
    
    upon detailed inspection of 'forget' behavior, it became evident that
    forgets from client should not goto server side, as server keeps its
    own purging mechanism to forget its inodes.
    
    if client sends all forget to server, many highly used required inodes
    may get freed up (it will surely effect io-cache buffers on server side)
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit e2a6e26f446605cabf89a402a851cfaf5c5f6036
Author: Harshavardhana <harsha@sunway.com>
Date:   Wed Jul 1 04:13:09 2009 +0000

    rpm spec file updates (removed mod_lwfs and respective dependencies)
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c284d5e73760aef176eefa25ee2054a67662bf98
Author: Harshavardhana <harsha@sunway.com>
Date:   Wed Jul 1 04:13:29 2009 +0000

    fuse 2.8 support for xlator/fuse
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 5feb0ccb6efc006b2b17d29509b63a41fa14293c
Author: Harshavardhana <harsha@sunway.com>
Date:   Wed Jul 1 04:13:23 2009 +0000

    fuse 2.8 version check at configure level
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 88f907af098c2876ca8777783098dae9ad624540
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jun 30 17:48:59 2009 +0000

    build warning fixes
    
    integer typecast warnings fixed
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 9d16a33e6171adf7512df839af6f6ffbab96799c
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jun 30 13:50:54 2009 +0000

    enhancement in write-behind
    
    Write calls should not be pushed to background only when the
    mandatory locking is enabled, in all other cases (eg: O_SYNC,
    O_DIRECT etc), we should not be 'caching' any data, but the
    calls can be pushed to the background.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 193b0e696fb7612998e23e21628023e9fffd08ee
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jun 30 17:08:50 2009 +0000

    version changes in GIT repo to differentiate between branches
    
    package-version: because master is undergoing changes for 2.1.x release,
    protocol-version: because of addition of mops 'log'
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 141d78e170b1e35b8897fe583cb5955646c8c211
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Jun 30 00:15:34 2009 +0000

    client_xattrop: use dict_allocate_and_serialize during serializing xattr
    
    - though the previous commit fixes bug #29, this patch fixes bugs
        arising in similar situations where xattrop is initiated by
        xlators other than afr.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit eeeffd41703003be30b3f1811fa54f5f8047ed73
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Tue Jun 30 00:43:56 2009 +0000

    cluster/afr - use different dictionaries for sending xattrop requests to each of the subvolume
    
    - This patch fixes bug #29.
      - Using separate copies of dictionaries also eliminates a potential bug in a
        setup consisting of afr with a posix and client, each having io-threads on
        top as children. Since posix_xattrop after performing required operations
        on the xattr array passed in dictionary, sets the result at the same key
        and in the same dictionary passed as input argument,
        there can be race conditions where in the results of the operation on
        posix-child can be sent to the other child as input argument for xattrop,
        which ofcourse is wrong.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a3ece0caa52ad2eacf8a8691aaca53295cde972f
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Jun 29 09:38:29 2009 +0000

    booster: Fix build problems with various libtool versions
    
    We've been facing a problem on some test systems where the
    booster.so is built by libtool as an executable rather than
    a dynamically loadable library.
    
    This problem is probably caused by it seeing a _init function in
    the source. This is the name of the libc initiliazation
    function so it could be the source of the problem.
    
    In any case, ld-preloadable libraries must not have a function
    called _init, instead they need to have __attribute ((constructor))
    as the attribute for any and all functions the library wants
    executed before the program's main(). Our earlier approach was
    inherently problematic.
    This commit also cleans up the booster Makefile for better
    build behaviour. Credit: Harsha.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 304e4274ca9b0339539581c5413e3339078c1182
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Jun 26 13:05:00 2009 +0000

    liblwfsclient: Fix lwfs_mount-vmp search deadlock
    
    It is possible that the only translator in the liblwfsclient
    tree is the posix. In that case, inside lw_init, the graph
    init routines will need to call lstat on the posix subdirectory.
    
    Since even the lwfs stack is running over booster, those
    calls will also first require vmp searching. BUT, the vmp lock
    is the same as the mount lock that was already taken when we entered
    lwfs_mount, so a deadlock occurs.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit d6ce087395220ea0b6e4bff4d3e561de624447a3
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jun 25 14:31:30 2009 +0000

    booster: Another attempt to fix 32 and 64 bit interoperability
    
    With this patch, we might have finally arrived at a solution
    to the problem of function definition conflicts between
    our functions and those of libc while over-riding the libc versions.
    
    This commit defines functions which do not conflict with libc,
    then it uses libc's own macro to redirect/rename these functions
    to the actual sys call names in the binary.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit f5ec3b6a9597bb50fe4d8b6a4c9d92a3b46306dc
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jun 25 14:31:29 2009 +0000

    liblwfs-fd: Simplify gf_roundup_power_of_two
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit e3e880180165efffbc0866eeda2154004f7d64f5
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jun 25 14:31:28 2009 +0000

    booster: Remove gf_fd_unused_get2
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 76aa99422562a500c3b82cb826ce582576065a83
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jun 25 14:31:27 2009 +0000

    booster: Add new booster-specific fd-table
    
    The reason we need a booster specific fd-table is because
    the liblwfs fd-table has come to a point where it is
    optimized for liblwfs-style of fd allocations.
    This conflicts with the way booster requires fds to be allocated
    so this commit brings in a re-based version of a booster-specific
    fd-table written by Raghu.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4fd96085c5a029e7be9e24e0c33b13268b290d6b
Author: Erick Tryzelaar <idadesub@users.sourceforge.net>
Date:   Fri Jun 26 13:36:00 2009 +0000

    Fix some trivial typos.
    
    I noticed that there were some minor spelling mistakes/typos in some
    of the source files. This patch fixes the ones I've found.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 75da95d8419dd209d879194e1b73a6190129a504
Author: Harshavardhana Ranganath <harsha@lw.com>
Date:   Thu Jun 25 23:12:00 2009 +0000

    Added new options for log-server and log-server-port
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 66224718ab57238e16b30d8b461c380d64df237c
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Jun 25 16:11:44 2009 +0000

    version check between client/server made more specific to protocol only.
    
    This patch is a step towards giving compatibility between the versions of
    LWFS. Now onwards, the protocol-version won't depend on release
    versions. In general, multiple lwfs versions can have common
    protocol-version.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit dc321571317b911faa31eed8b3bd4ce396963179
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Jun 24 18:31:10 2009 +0000

    dht_readdir_cbk: use stat attributes in the READDIRPLUS dirents to
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 622636c6e18a1013261bf924084d7a78a7cc86b1
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Jun 24 18:31:09 2009 +0000

    rename dht_first_up_child to dht_first_up_subvol
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ad7909163aef151b15638110119fb9adaf3dbcee
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Jun 24 18:31:07 2009 +0000

    posix_readdir: fill stat structure into dir entry
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c4cf372fbc70e7354597692b385691149f163d2a
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Jun 24 18:31:06 2009 +0000

    gf-dirent: add support for stat attribute in dir entry (to work like
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 5052d8e23d2e3b33a185d3bd5f9eca8264238acb
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Jun 24 13:31:11 2009 +0000

    mount script to take arguments like nfs
    
    Ref: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=37
    
    earlier instead of path, it used to take port number, which is an
    option (-o server-port=<port>), now.
    
    new syntax is
    
     bash# mount -t lwfs <hostname>:<path/key> [mountpoint]
    
    [This patch is backward compatible with earlier syntax]
    
     bash# mount -t lwfs <hostname>:<port> [mountpoint]
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c15ab84a1dd687e9e97b17fb7250ba945857026e
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jun 23 13:41:26 2009 +0000

    server-protocol: interpret the 'op' value properly when a packet is received.
    
    Ref: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=35
    
    The check done earlier was not handling the case when a 'op' is == MAX_VALUE (which
    is not defined), and used to skip to the next array (like gf_mops[MAX] == gf_cbks[0])
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 60aaf35a044357b3a639e0d8f46102a3272b5c65
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Jun 23 10:13:04 2009 +0000

    check if the 'key' is the volume file name itself.
    
    With this patch, one can fetch any volumefile which is not pre-defined in
    volume file with 'option' in server protocol volume, instead clients can
    fetch the volume files based on the key name itself [From the confdir only]
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1bd3a412d01c2d0cbbcf91e7983e2d4c9c8bbec4
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Jun 22 19:26:06 2009 +0000

    mount.lwfs.in correctness in case of duplicate mount
    
    mount.<fstype> script/program should return success in case when it finds
    duplicate mounts. It was returning failure earlier. Someversions of
    automount programs had issues with this behavior.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit e7b8470623ff647a6fe2740b555bf1ce2dae7d21
Author: Csaba Henk <csaba@lw.com>
Date:   Tue Jun 23 04:25:22 2009 +0000

    Fix typos in my previous commit 6010e2a4e
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 384ee312ba44e3d8c456ab0c93d74274597d71f4
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Jun 22 07:53:03 2009 +0000

    lwfsd - build proper mount/fuse structure.
    
    while appending mount/fuse to a translator tree, make sure
    that <xlator_t-of-fuse>->next points to the first xlator in
    the list of xlators and not the subvolume of mount/fuse.
    
    NOTE: tree traversal should always happen through <xlator_t>->children
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 6010e2a4e14a850469f0977e43245e64a33301fa
Author: Csaba Henk <csaba@lw.com>
Date:   Mon Jun 22 00:56:13 2009 +0000

    fuse: instead of having a fixed option list, assemble it using "fuse_opt_add_arg"
    
    This makes it easier to adjust the option list, and also reduces redundancy.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 96896689b4e774af6460905b30adabec6e1fa540
Author: Vijay Bellur <vijay@lw.com>
Date:   Sun Jun 21 01:28:51 2009 +0000

    Avoid accessing local unconditionally in trash_common_*_cbk functions.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ae1201785ca7f14690d19c533bb8a7f5150ea29b
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Jun 18 15:58:22 2009 +0000

    local->loc should be filled in dht-mknod()
    
    local->loc should be properly filled while creating a linkfile. otherwise
    this causes the segfault in underlying volume layer (mostly client-protocol).
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 93c8ce0e3fc295087775185c0f8594f06244098d
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jun 16 05:25:17 2009 +0000

    Add command line option to specify central log server.
    
    Added two command line options:
    
    --log-server SERVER
    --log-server-port PORT
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit cc931ebf51e7a810e08155ba0b916b10f25d7f16
Author: Harshavardhana <harsha@sunway.com>
Date:   Tue Jun 16 10:34:44 2009 +0000

    Remove the trailing "/" which fails build with new version of automake
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a3864e8054cd047a004c7705c27b64b28912d947
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Jun 18 14:21:15 2009 +0000

    making dht and nufa's 'min-free-disk' option to take both percent and disk-size
    
    Originally from Paul Rawson <plrca2@gmail.com>
    
    http://patches.lw.com/patch/391/ : patch re-submitted with patching guidelines.
    
    cluster/distribute, and cluster/nufa uses new option PERCENT_OR_SIZET for its
    option 'min-free-disk'.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit d3e1a3d453c358f2b5a6b86805767c8361fde2ee
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Jun 17 20:58:20 2009 +0000

    adding an extra xlator option type, GF_OPTION_PERCENT_OR_SIZET.
    
    Originally from Paul Rawson <plrca2@gmail.com>
    
    http://patches.lw.com/patch/391/ : patch re-submitted with patching guidelines.
    
    with this patch, the xlator volume options get another type which can take
    arguments either in 'percent' or in 'bytes', which is useful in many cases.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bb451c37bc05c8a33130e6b93020378d742f0ca2
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jun 18 05:33:27 2009 +0000

    liblwfs: Prevent gf_fd_put'ing of unallocated fd
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 617de1c718d4f082c8a8cf86c258284f5c918b2c
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jun 18 05:33:20 2009 +0000

    liblwfs: Chain newly allocated fdentries.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 804e34cc4955cf5f176e70381da08cc617b6f79b
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu Jun 18 05:33:13 2009 +0000

    liblwfs: Change GF_FDENTRY_ALLOCATED constant
    
    This change is being brought in so that we can
    
    differentiate between fdentry_ts when debugging using
    gdb.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 80485e438268251f734936139d8239c59f70de54
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Jun 17 20:56:52 2009 +0000

    change the log level of disk full message in dht-diskusage
    
    the current msg is getting printed in warning level. Instead changed
    it to debug, as the msg specific each node being full is already getting
    printed in higher priority, hence this msg looks excessive.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 84bfdfee65be197a8aeb8d8378e135147152761f
Author: Harshavardhana Ranganath <harsha@sunway.com>
Date:   Tue Jun 16 11:04:10 2009 +0000

    Booster build should not depend on if mod_lwfs is disabled
    
    Thanks to Erick Tryzelaar
    
    Sending this patch on behalf of Erick Tryzelaar <idadesub@users.sourceforge.net>
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 7437305962f485074cf643fec8161925e9bd5225
Author: Vijay Bellur <vijay@lw.com>
Date:   Wed Jun 17 11:52:13 2009 +0000

    Removed the swap being done for __noswap functions.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 9286a599f62289e8630ee28ea7da7308396d8fdf
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Jun 5 17:51:59 2009 +0000

    change ha-statfs() to handle the case of loc->inode being NULL
    
    This fix is needed in ha_statfs(), as the current code doesn't handle
    the case of loc->inode being NULL, which is a valid case in statfs()
    [Remember its stateless call]. This was causing 100% disk full logs in
    distribute or nufa as the logic of checking whether the subvolumes have
    enough disk space on them used to fail.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bb4e14b213a39e9d403be9790ef0a75388496dee
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Jun 15 13:05:52 2009 +0000

    client: Replace saved_fds dict with list
    
    Thhie change removes a huge inefficiency in file open
    path where every open resulted in dictionary operations
    in order to let the client maintain a list of fd_t's being
    used over a particular client context.
    
    Resolves: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=16
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit efcce990960fb91d422630fc7b310b216a500fed
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Mon Jun 15 13:05:39 2009 +0000

    liblwfs: Turn fd-table O(1)
    
    This commit reduces CPU usage of gf_fd_unused_get drastically by
    making it O(1) instead of O(n).
    
    Related to: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=16
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 7006ae207c9e8ab9685d8e2e7455bd4e3b217c97
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Jun 15 04:12:42 2009 +0000

    write-behind: fix memory corruption
    
    - wb_sync did not set local = NULL after stack_wind. It also used to free
        local if its not NULL as part of cleanup process. Hence there was a double
        free in STACK_DESTROY done in wb_sync_cbk.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4eac667d30bce0768bc7e220614f703d45ee6f81
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Jun 15 04:12:21 2009 +0000

    write-behind: check for memory allocation failures and take appropriate action
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8f29c29480ad4f716229d480ada7fc2b6711f22e
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Jun 15 07:16:31 2009 +0000

    Do stat to check mode of the export directory in storage/posix.
    
    Doing an lstat means init fails if the export directory
    is a symlink pointing to a directory.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit e298a2183a8a294abda9c656879dc30f6c17f027
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Jun 15 00:02:57 2009 +0000

    booster: fix build error in fcntl implementation.
    
    - F_DUPFD_CLOEXEC is defined only in linux kernel versions >= 2.6.24
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c3cf6a57c0b241fa768a57ee2fb294196d03f4a0
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Mon Jun 15 02:58:36 2009 -0700

    io-cache: fix warning by initializing conf = NULL

commit 65f52bfa965bcffca1157a3ce0711133dc28161b
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Mon Jun 15 02:57:25 2009 -0700

    read-ahead: fix warning by initializing conf = NULL

commit 26fbb96e454df1844fc73c1122c08c8ae405f824
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Fri Jun 12 05:11:53 2009 +0000

    liblwfsclient: Call inode_lookup to prevent pruning
    
    This bug shows up while using unfs3 with replicate. The absence
    of an inode_lookup on a looked-up/created inode results in it
    getting pruned from the inode table. Consequently, a subsequent
    lookup for the inode results in a different inode number being
    returned by replicate. This breaks unfs3 because it tries to remember
    the inode numbers returned by two different stat-family calls.
    
    Resolves: http://bugs.lw.com/cgi-bin/bugzilla3/show_bug.cgi?id=11
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 7aa062466f34cd1eee911d34bdb87591d410c399
Author: Amar Tumballi <amar@lw.com>
Date:   Wed May 27 17:50:32 2009 +0000

    strict check of extended attribute flags while opening a striped file
    
    Added a fd_ctx structure for stripe, which takes care of understanding the
    extended attribute flags, and opening the right blocks in order (to make
    sure the read/write operations happen in order).
    
    Helps to handle situations like accidentally adding subvolumes to stripe, etc
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a20d4929663ccbfa45d574d62240a5277b47ab39
Author: Amar Tumballi <amar@lw.com>
Date:   Wed May 27 17:49:10 2009 +0000

    stripe: don't allow entry modification operations when any node is down
    
    if entry modification operations (like create/mknod/rename) happen when there is
    a node down, there will be inconsistency in striped fs. rather than curing it,
    prevent the issue from happening
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit d918b28cf3df2826656fef868f1825f4e6c45723
Author: Amar Tumballi <amar@del.lw.com>
Date:   Wed May 27 17:46:29 2009 +0000

    stripe cleanup
    
    stripe.c:
     indentation cleanup
     log messages cleanup
     coding standard guidelines
     removed ERR_ABORTs
    
    stripe.h
     moved the structure definitions here
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1125e8cbc072753fab78ba735bed3f29db61fcc4
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jun 11 01:46:04 2009 +0000

    io-cache: handle memory allocation failures
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 180cfc0c4b6b9a46da35a536a565f010babfa4a7
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jun 9 05:08:59 2009 +0000

    Initialize central logging in lwfs main().
    
    Modified from patch 522 (made a function extern) -- Avati
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 181ab58c6adeda6f99eb9330ed8ce720ab0f2818
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jun 9 05:09:01 2009 +0000

    Implemented LOG MOP in server-protocol.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 2943c77d88eccc195c59ded0aa9a377fcef906d9
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jun 9 05:09:00 2009 +0000

    Log to a central server.
    
    Several functions to support centralized logging:
    
     - create a logging thread upon init
     - gf_log submits log messages to the logging thread which
       in turn sends it to the server using the MOP log
    
     - on the server side, log messages from a client are written
       to the filename <log file name>.client-<transport-identifier>
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit e7e6144a7688b35255ef5d69b060bd90e319679f
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jun 9 05:08:59 2009 +0000

    Functions to store a central log flag in TLS.
    
    The flag is set in TLS so that a re-entry into
    gf_central_log does not deadlock.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit f7ca417394aeb5a8c2144e3b2ae6493ef172b32d
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jun 9 05:08:59 2009 +0000

    Include lwfs.h in dict.c
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 7db5c60ded012414f323029da263979e20215e5f
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jun 9 05:08:58 2009 +0000

    Implemented LOG MOP in client-protocol.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1a6989613914cc86a64c3eb21cfddba15ce372d9
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Jun 9 05:08:58 2009 +0000

    Added MOP log to liblwfs/*
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 77d8cfeab52cd19f3b70abd9c3a2c4bbc9219bff
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jun 11 08:47:06 2009 +0000

    Do not fail over readdir in replicate.
    
    If readdir fails on a subvolume, do not
    fail-over to the next subvolume, since the
    order of entries and offsets won't be same
    on all subvolumes.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 998a1e0f740b6730f7885ad8c74afaad503d3256
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jun 11 08:46:40 2009 +0000

    Do itransform on every entry in readdir_cbk.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 3b99c6d82f9259db54f2d2d0a2520f88e7b12843
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 07:02:27 2009 +0000

    booster: fix memory corruption in booster_cleanup
    
    - calling lwfs_umount_all leads to memory corruption.
        hence commenting out for timebeing.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 943a38e9f8beaaaa7fe741398c573fc458037723
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 07:02:15 2009 +0000

    liblwfsclient: reset the vmplist and vmpentries to 0 in lwfs_reset
    
    - Generally lwfs_reset is called after fork in child to empty out
        vmplist.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4a31c02a568464cc4030b20cefe71ccb007b45bf
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 07:01:59 2009 +0000

    booster: implement fcntl.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 5dcbc0563f10cf68db2af10665953425ed262906
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 07:01:45 2009 +0000

    liblwfsclient: implement lwfs_fcntl.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8ebb4499d0bf568ea58562708f8baaedfe9fa58a
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jun 11 04:59:00 2009 +0000

    booster: implement readdir_r and readdir64_r.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 75f555fd89d2bf3dbd5aceeb112b748f4a8966e3
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 07:01:16 2009 +0000

    liblwfsclient: implement lwfs_readdir_r
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ac53b60bc29831cecfa7d5919278afc6c7053392
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 07:00:59 2009 +0000

    liblwfsclient: update offset in lwfs_read_async_cbk only if offset stored in fd_ctx is used.
    
    - this helps in implementing sendfile(2). manpage says that
        "If offset is  not  NULL,  then sendfile()  does  not modify the current
         file offset of in_fd"
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 157469a43272d06f63f0d4eaa15bd994c9cc0ba0
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 07:00:44 2009 +0000

    booster: call lwfs_umount_all during cleanup
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit e0650e53ca9df6e86272efb0a2e2587e42f24a53
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 07:00:26 2009 +0000

    booster: implement sendfile.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ee22651f34b467859959b17b881da465001c6bc8
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jun 11 04:58:30 2009 +0000

    liblwfsclient: implement lwfs_sendfile.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 29a3619d6bb5680213c817b13dad7d8ad6e2903b
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 06:59:50 2009 +0000

    liblwfsclient: add lwfs_umount_all.
    
    - unmounts all the entries in the vmplist.
      - this api helps booster to cleanup all the mounts in a single call.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 82130d7ef5e4e4842dba44f0283336d98035a590
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 06:59:34 2009 +0000

    liblwfsclient: make lwfs_umount thread safe
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 54976b687227e5e12d4138e29a64640318a2db3b
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 06:59:14 2009 +0000

    liblwfsclient: make lwfs_mount thread safe.
    
    - this patch also checks for the presence of vmp before adding
        an vmpentry.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit dfff100cc31ad1343d8ecb76b72ec650c2b8b5b4
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 10 06:55:32 2009 +0000

    booster: remove mount table which maps a path to lwfs handler.
    
    - if there are any lwfs mounts(real, not virtual) which are not specified
        through booster-fstab those mounts are also added to the virtual mountpoint
        list of liblwfsclient. This also removes the mount table in booster and
        all the mounts whether they are real or virtual are handled by
        liblwfsclient.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8f4e5ace5d95535266a0ad1d6cec5f59325148c4
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Jun 11 04:36:14 2009 +0000

    Filter out changelog xattrs in replicate.
    
    The AFR changelog xattrs, "trusted.afr.*" are now
    filtered and prevented from being visible on the
    mountpoint.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1c4d58fe57162a5247356dc95aa6204f26cbf4fe
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Jun 10 01:25:38 2009 +0000

    io-threads: Fix missed notification in sem_timedwait
    
    We're performing a calculation for skewing idle time
    that resulted in a timespec.tv_nsec value becoming larger than
    1000 million or less than 0, forcing sem_timedwait to return
    with an EINVAL instead of waiting for a request notification
    from sem_post in iot_notify_worker(). This resulted in a missed
    notification that resulted in a hang followed by a timeout
    on the protocol/client side.
    
    This commit avoids the over- and under-flow in tv_nsec by
    skewing the tv_sec value instead.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bd2b529fd3d1965ccfe8cc03f9223ed1e98f7e79
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jun 11 01:45:45 2009 +0000

    read-ahead: handle memory allocation failures
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit b930b38a2ab16b3d25b4bf2441e584f7fc882a17
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jun 4 06:14:31 2009 +0000

    read-ahead: return with error code EBADF for fops on fds without file set in their context.
    
    - since a successful open/create will _always_ set a pointer to ra_file_t in
         context of fd, this fix makes sense.
       - an example of operations on bad fd can be afr sending read on the child
         which was down during open.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 3f4362cedee499beb6a872b3dbb3ac920aa51d21
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Jun 4 06:13:58 2009 +0000

    read-ahead: unwind with a return value of -1 and error code of ENOMEM on memory allocation for ra_file in open/create
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit cc2c0b53566584279f624d49bd1cb70936bbf5ea
Author: Amar Tumballi <amar@lw.com>
Date:   Fri May 29 16:08:04 2009 +0000

    removed unused option 'page-size' in io-cache
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 5b90d71324802e88c72947b807884036cfd32b78
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Jun 8 07:18:18 2009 +0000

    Print PID after daemonizing lwfs.
    
    PID used to be printed before lwfs became a daemon,
    which is incorrect since becoming a daemon involves
    forking and thus the PID changes.
    
    Fixes bug #8.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 7c42fd0f2059329d620225962146cdd0414a8f69
Author: Anand V. Avati <avati@dev.lw.com>
Date:   Tue Jun 9 06:17:37 2009 -0700

    configure.ac: print summary to stdout

commit e98d3808478c09fb4058a53a7dc215d8fae1553f
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Jun 3 00:38:26 2009 +0000

    server-helpers: cleanup connection only if there are no active transports.
    
    - thanks to Ioannis Aslanidis <iaslanidis@flumotion.com> for reporting.
      - breakup the server_connection_cleanup into smaller procedures.
      - do following operations in a single atomic operation.
          1. conn->active_transports--
          2. collecting pointer to lock table and all fds if there are no active transports
        this will avoid any race conditions.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1d940e5ab2baeb901792f4b60a3abf3fcec19491
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Jun 3 02:17:19 2009 +0000

    Fix crash in afr data self heal. Bugzilla ID: 3
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a4a0054caee6c75ae442d4984b95bf9753eded36
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Jun 3 01:05:42 2009 +0000

    liblwfsclient: Avoid dirent copies in readdir cbk
    
    We can avoid memory allocation, de-allocation and
    data copies by just using the entries passed to us from
    a lower layer and by de-linking the entries from the original
    list.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4c0b91a5a045e3f03a049320d26542ab9fec4745
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Jun 3 01:05:34 2009 +0000

    liblwfs: Add empty and NULL dirents list checks
    
    These checks are needed in case a higher layer intends to
    delink the dirent list and passes a NULL pointer to
    fop_readdir_cbk_stub for the entries parameter.
    
    Consequently, the gf_dirent_free must guard against an empty list
    because the stub that is passed to it mgiht have an empty
    dirent list.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 08d46effee3b5e07b89a3a04251714383cf02eec
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Jun 1 17:58:41 2009 +0000

    ib-verbs error log enhancement
    
    Earlier it was thought that only not having 'opensm' running will cause
    handshake errors in ib-verbs.
    
    Recently understood that even having a wrong 'ib-verbs.port' option can
    also cause the same behavior, and it took more than 5-6 e-mail iterations
    with the user and lot of brain cycle in support team to understand the
    problem. Made the log message more descriptive, so user can be find the
    cause, or can send us email without wasting time.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 2dc70c22bdd25362a95f19ab551d39e99f76ebfb
Author: Anand Avati <avati@lw.com>
Date:   Fri May 29 13:52:07 2009 +0000

    io-cache: prevent frames from getting woken up while page is getting validated
    
    1. A page will be put on the inode waitq if the 'freshness' has to be verified with an fstat()
    
    2. while the fstat is in transit, other calls (like lookup) can update ioc_inode->tv, resetting the freshness (page still on inode waitq)
    
    3. Another read request on the same page, after the updated freshness, will wake up the page frames neglecting the fact that the page is also waiting on the inode (waiting for the fstat completion)
    
    4. once the page's frames are woken, the page becomes elegible for purging and can get destroyed for various reasons, leaving a destroyed page pointer in the inode's waitq
    
    5. fstat returns and hits the destroyed page pointer causing a crash
    
    The fix is to all together disable cache hits when any page of the same inode is under validation. The otherwise cache hit will now be subjected to the ongoing validation by getting queued to the inode waitq.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 834efc91985b7a572e5acd9be463eb8ffdf3ba11
Author: Amar Tumballi <amar@lw.com>
Date:   Fri May 29 16:09:05 2009 +0000

    unify getdents count reduced to 512 (from 1024)
    
    Thanks to Krishna <krishna (at) lw.com> for pointing this out.
    
    When a unify self-heal of large directory (directory with lot of entries)
    is done, the getdents_cbk used to fail because of new limit of buffer size
    (128KB). Noticed that earlier it used to streach upto 4MB, hence the value
    1024 worked fine. By reducing it to 512, noticed, we can fit in well within
    128KB limit, and hence unify self-heal goes through.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 3c1fa49fb56c3a35f82bc25e4553431fe04f5231
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu May 28 04:43:05 2009 +0000

    liblwfsclient: Increase readdir block size
    
    This improves the potential for pre-fetching a larger
    number of dirents. Consider that, with 255 chars as the max
    name length for each dirent, in the worst case scenario, where
    we actually have files with such large names, we're not getting
    more than 4 entries with the current block size of 1024.
    
    Generally also, increasing the size to 4k provides us
    with a higher chance that directories with low to medium
    number of dirents will be pre-fetched in a single readdir fop.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit b6434aadbe3e862815f4237fdf4c97284680a134
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu May 28 04:42:58 2009 +0000

    liblwfsclient: Add dirent pre-fetching and caching
    
    The fop interface is such that we're able to extract more than
    1 dirent in a readdir fop. This commit now enables liblwfsclient
    to read multiple entries on a lwfs_readdir call. Once these
    have been pre-fetched, they're cached till either lwfs_closedir
    ,lwfs_rewinddir or lwfs_seekdir are called.
    The current implementation is beneficial for sequential directory
    reading and probably indifferent to applications that do a lot of seekdir
    and rewinddir after opening the directory. This is because
    both these calls result in dirent cache invalidation.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1fea167f86ed4501ed01b5c678cddc7c815f1a5b
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu May 28 04:42:51 2009 +0000

    booster: attr_timeout: Read timeout from booster fstab
    
    In order to expose the timeout values for stat and inode
    caching, this commit introduces a new fstab option "attr_timeout"
    that defines the number of seconds for which a looked up inode
    or a stat()'ed structure is valid in the cache.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bc99744f209d2c6905f858e9ab44d09fb661e94a
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed Jun 3 01:31:37 2009 +0000

    liblwfsclient: Simplify inode and stat caching
    
    There is a mechanism for caching the inode numbers got from a lookup
    and a struct stat got from a stat or fstat but I wasnt sure if it worked.
    This commit simplifies cache updates and checks and the accompanying
    tests have made sure that the cache does work.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit f47f568aa0fd8d12c211e3b249fcf7a67ec56f9e
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu May 28 04:42:37 2009 +0000

    liblwfsclient: Allocate right sized structure
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a29ec1f1484902400f08b24ed777ea984923ffea
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Sun May 24 23:05:26 2009 +0000

    booster: Clean-up handling of log/fstab env variables
    
    Handle two cases when deciding log/fstab file:
    1. It turns out that that strdup or strlen doesnt actually
    check for NULL before trying to do its thing with the string
    so it seg-faults on seeing a NULL char pointer.
    
    2. getenv can return an empty string if the
    env var was exported as:
    $ export GLUSTEFS_BOOSTER_LOG=
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit f888b3f5be4be893323b644dba0668ae3d40228e
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Sun May 24 23:05:18 2009 +0000

    booster: Eliminate lw context creation race
    
    When multiple threads try to create a lwfs context using the
    lwfs_init function, those threads end up using the global
    vairables in the vol file parser in an non-synchronized manner,
    resulting in a seg-fault.
    
    There is now a big lock around searches and additions from the mount
    table in do_open. This lock granularity could be reduced.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 380cd4e6d296cde9d203ce6c4fa01be189fbf34c
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Sun May 24 23:05:11 2009 +0000

    booster: Clear up env var usage
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit a7e5888508a2f08e6891eb5a472b7edf737e15da
Author: Amar Tumballi <amar@lw.com>
Date:   Thu May 28 20:12:05 2009 +0000

    bug fix in dht-diskusage when statvfs->f_blocks is 0
    
    This can happen when 'option export-statfs-size off' is given in
    posix volume. Caused divide by 0 error.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit f5d0e815b43b3957396dd6c4a768ba87db2ae9c5
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu May 28 02:46:45 2009 +0000

    Remove absolute path for init scripts.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 4e89da5054837a2266fe1732a309c341dd6cd663
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 26 09:02:29 2009 +0000

    socket: New option: Set receive and send buffer size
    
    ..and hope for a chance to improve performance on
    high speed links like 10GigE.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 23976ec1e8554963d5e6a868c3982a8baa3d361a
Author: Pavan Sondur <pavan@lw.com>
Date:   Wed May 27 10:39:38 2009 +0000

    Fix mismatch in size of used buffer to prevent an infinite loop
    
    A mismatch in the size of the used buffer, between reading and then further writing caused an infinite loop and big files(1Mb, 10Mb etc) could not be downloaded through the lighttpd web service using mod_lwfs. This is because the big file which is broken up into chunks, has a read and a subsequent write.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit b84ab58d8c849347fc6a337a4e897c365c0b08ae
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue May 26 05:02:27 2009 +0000

    Do itransform in AFR readdir.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 696428efb6195374bfd07c1b483871e1fdb68a55
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue May 26 05:01:35 2009 +0000

    Always do itransform of the inode number from the first up child.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 0af126294a1eeb89383a4e477962f908f003026f
Author: Anand Avati <avati@lw.com>
Date:   Tue May 26 04:31:28 2009 +0000

    add booster_fstab.h in noinst_HEADERS to fix build breakage after 'make dist'
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 2951b04c7ac8a2888fffb2ebc127ecc1ec617d79
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon May 25 05:02:25 2009 +0000

    Preserve atime/mtime during data self heal.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 8b56178a7928bc7d30f408096303eaff3fe6d823
Author: Anand Avati <avati@lw.com>
Date:   Fri May 22 03:33:41 2009 +0000

    fix crash in __socket_reset. Previously iobuf_p was an allocated pointer, but since introduction of IObuf it is no more. Now iobuf has to be unref'ed instead.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit abb075def55110f606ff43e64933afee61dea261
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:32 2009 +0000

    THIS: use xlator_init() for initializing xlators
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 6d5aff7bfd2403aa132d41c659c76abaf58f0503
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:31 2009 +0000

    THIS: add xlator_init() API to set @THIS
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bbce052d47e5f17a476379f5de6925ae795465bb
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:30 2009 +0000

    THIS: bootstrap @THIS in fuse thread
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bebe16ae8db873474d43d751cca484cca6ed2715
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:29 2009 +0000

    THIS: unify now uses xlator_notify for setting THIS
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 17cf09641d81f02094288ef9de52cdf720fc516f
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:28 2009 +0000

    THIS: protocol/client now uses xlator_notify for setting THIS
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit f0fed682ecca92c1ade5076637c4cbd450ce19f3
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:27 2009 +0000

    THIS: ib-verbs now uses xlator_notify for setting THIS
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ad3fdbb2e15e1590efe955c3561aff964c972353
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:26 2009 +0000

    THIS: socket now uses xlator_notify for setting THIS
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 61e343c72b384faa56e034750bd5bb5b4667681b
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:25 2009 +0000

    THIS: default_notify to use xlator_notify for THIS compatibility
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 9cec4a0a790cc74106f92375506d7a16e09bdb10
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:24 2009 +0000

    THIS: xlator_notify API to be used for propagating notifications with proper THIS setting
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 99bf8da4764f425ac4022c9854acbd4247b6fdfc
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:23 2009 +0000

    THIS: set appropriately in call stub resumes
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit b7c1bcb4ea5ddd498f04b178f60209abbc9f01ed
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:22 2009 +0000

    THIS: set appropriately in STACK_* macros
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 207fb347ed24716ac4f443bab2d1daeb9ae5ccf4
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri May 22 02:10:21 2009 +0000

    globals: add globals.h/c THIS: macro to access thread specific current xlator CTX: macro to access lwfs global context (lwfs_ctx_t)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit bd297be1d1fedc85d70b9b1f3e4d4aa7b9980c76
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu May 21 02:20:26 2009 +0000

    Check for returns when apxs fails and disable mod_lwfs
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c7fd9f1df36a01ac9a1509d1001b0d259005b0f9
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Thu May 21 01:37:05 2009 +0000

    mem-pool,io-threads: Destroy mem-pool on deallocation
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ef7fcc0d7c2695ab3b10477b3e1290e43831da99
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Wed May 20 22:50:10 2009 +0000

    booster: Move fstab parsing into booster from liblwfs
    
    This is another attempt at fixing build problems on Solaris.
    I am told that booster build is disabled on Solaris and I know
    that it is disabled on Mac OS X also. Getting it to work
    on both these systems is now on my TODO list, mainly
    because on both these systems, we can have a lwfs client
    running without requiring FUSE.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 5bb6653c434c74b5f2d5b706f60f8d4149a40a2d
Author: Csaba Henk <csaba@sunway.com>
Date:   Tue Apr 28 10:22:03 2009 +0000

    add xlator debug/io-stats
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit d734a305d534d6430d1401ec358100f28547ca09
Author: Amar Tumballi <amar@lw.com>
Date:   Wed May 20 13:36:01 2009 +0000

    add 'non-blocking-io' to the options array in sockets.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 0961d301dd74a133a16425b10be02787a499e453
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 12:42:31 2009 +0000

    io-threads: Use boolean enums instead of integer 1
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 693e4f912b618d35b85fe6521d87fb7f683421d0
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 12:42:22 2009 +0000

    io-threads: Change mutexes/condvars to spinlocks/semaphores
    
    It seems that use of mutexes is resulting in pretty high thread
    sleep and wake-up cost. What is worse, if a worker thread has
    acquired a  lock, there is a possibility of the main lwfs thread
    being put to sleep. We change the use of mutexes into spinlock.
    At the same time, we cannot anymore use condvars for notification since
    the condvar interface depends on mutexes itself. Semaphores come to
    out rescue. Luckily, even the pthread semaphores have a timedwait
    interface to allow our idle worker threads to make an exit decision.
    
    Further, it is possible that spinlocks are not available on all systems
    so all this is curtained behind #defines so we can fall back to
    mutexes and condvars implementation.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 62a920642a54eac6e4b24a3590f17d628202a210
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 12:42:14 2009 +0000

    io-threads: Reduce default max for threads to 64
    
    We've had complaints from users who've used
    autoscaling option with default settings for min and
    max threads, about high memory consumption because of
    the large default value for max-threads.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 9a916de3f35dbbfe4399696891a0937d650bf72e
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 12:42:06 2009 +0000

    io-threads: Support mem-pool allocator for iot_request_t
    
    This commit brings in support for allocation of iot_request_t's
    in io-threads through the use of the mem-pool. We're hoping
    that the overheads of hundreds and thousands of small allocations
    can be avoided through this.
    
    The important point to note is that the memory pool is not
    for the translator as a whole but there is one small memory
    pool for each worker thread. Not only does that help us
    avoid malloc overheads for small allocations like iot_request_t
    but also avoid contention on the heap data structures when multiple
    threads want an iot_request_t from the pool.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ef0af3ca33a007f2aae2016cc27b6d828367c987
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Fri May 15 05:50:09 2009 +0000

    io-threads: Add graceful shutdown of worker threads
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit c22810911149506d972133c4e87dbcab01330daa
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu May 7 00:51:39 2009 +0000

    io-threads: handle memory allocation failures
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 7f001813bc04ede65b05d588f16e0a6c68a94cfe
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon May 18 08:19:10 2009 +0000

    Change errno to EAGAIN in readv/writev
    
    When mandatory locks are enabled and a read/write
    would block due to a lock and if the fd is opened
    with O_NONBLOCK, return EAGAIN (previously EWOULDBLOCK).
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a9d0be4f1b78d9c03e9379fc5cea0ead6114c1d0
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 04:34:11 2009 +0000

    mem-pool: Restructure mem-pool behaviour
    
    This commit changes mem-pool behaviour to return a directly usable
    address by performing the required adjustment on the address
    being returned.
    
    This is different from the previous behaviour where we're trying to fit
    into the requested size, the list_head*2 also. This is not efficient
    enough in terms of space but hopefully works better than not having any
    mem-pool at all. Besides, I am not comfortable with mem-pool meta-data
    and caller-useable memory area being the same because of the potential for
    mem-pool's data structure corruption.
    
    PS:
    Please do read the comments in the code for more info during review.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 25dc191c51efb97ec970b137edfe4557302b7357
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 04:33:58 2009 +0000

    mem-pool: Fix #define spelling
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3aea8a66a457349e19bde40eb33510edd0597cff
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 04:33:48 2009 +0000

    mem-pool: Remove hard coded value for pad boundary
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit acf28ed1ef3565ca1321fe9647d9b065a24fa46a
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 04:33:37 2009 +0000

    mem-pool: Fix memory leak in mem-pool init phase
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d71a5601fb2cf661d973a08a4cef9a15a9ec2363
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 17:57:02 2009 +0530

    booster: Fall back to remaining real_* functors
    
    It is possible that some of the real_* functors for stat
    family of syscalls are NULL. I've seen this on libc. In that
    case, this commit attempts to use any available function that
    performs an equivalent operation.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 87b938d02b51a0b4c864fc5deba1a1f177a05a4c
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 17:56:54 2009 +0530

    booster: Dont de-init fd tables on VMP-init failure
    
    In case the init procedure for VMP fails, we want to
    continue using booster through the old approach, which means
    leaving the fd-table intact.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9189418db9e50fa20c31ac5c7c5b6aaa16a9fa1e
Author: Shehjar Tikoo <shehjart@lw.com>
Date:   Tue May 19 17:56:47 2009 +0530

    booster: Do not read info for non-lwfs mount points
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c5b90f75951faddf55c61f2fe57f1c26070a63b6
Author: Harshavardhana Ranganath <harsha@dev.lw.com>
Date:   Tue May 19 06:39:42 2009 -0700

    Appropriate changes to statvfs struct for Solaris host.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 35fc174ea3a37546d7c90be8fa6076b8f9416d73
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:24:43 2009 +0530

    liblwfsclient: Comply with EEXIST rule on rename
    
    During a rename, if the new file exists, the old name needs to
    over-write the new name. We're returning EEXIST, which is wrong
    behaviour.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 95ce0a87f5fbb139f7002360d63a005bfb9c097d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:24:34 2009 +0530

    liblwfsclient: __do_path_resolve: Fix pathname resolution bug
    
    In __do_path_resolve, we need to use the new_loc.path as the input
    for resolution rather than the resolved variable, simply because we're
    not interested in resolving the names that have been resolved, as
    pointed out by the variable name 'resolved'. Instead, we need to resolve
    new_loc, which stores the next component in the path to
    be looked up.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fe06790a3637c30dc8d5e0be7367f27ee24c36bd
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:24:21 2009 +0530

    liblwfsclient: Wipe loc->ino in libgf_client_loc_wipe
    
    Not cleaning up the ino member of a loc_t results in SIGABRT
    in __inode_link because in some cases, the loc->ino is
    different from loc->inode->ino. This happens especially in code
    blocks which re-use a loc_t structure for pointing at different
    inodes/files. For eg, if a loc_t has been assigned an inode and
    an ino, and followed by a libgf_client_loc_wipe, then re-use of this
    loc in say libgf_client_lookup results the SIGABRT because
    libgf_client_lookup calls inode_link with the same loc_t. However,
    this loc_t has just been assigned a new inode pointer but the ino
    member still contains a previous inode's inode number. This difference
    in inode numbers results in an assertion failure, so the SIGABRT.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1279d7398c63bdad448cf0418579f6df1d9f6f34
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:24:08 2009 +0530

    booster: Add telldir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e3e7f850eda010ab8c84417e57a4fbace4073022
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:23:58 2009 +0530

    booster: Add seekdir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 358f5ba40866545ce240ed8fda77c4d2e57a4262
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:23:38 2009 +0530

    booster: Add rewinddir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e420eb2206aa773eb32f1a7146cba4d6da5d9d03
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:23:24 2009 +0530

    liblwfsclient: Refine readdir entry parsing logic
    
    Here I am only refining the entry parsing code in order
    to clarify the exit conditions from the loop. There were
    a few workloads where this loop went infinite.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e1ae573f73d69fe1a244ed1493793961dd4cf811
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:23:14 2009 +0530

    liblwfsclient: Add telldir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 35bf3f058473b61605fd28cd9cbee7726adedf9d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:22:57 2009 +0530

    liblwfsclient: Add seekdir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit dddcf498610ebd332992e9600dd728cc87e6355d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:22:42 2009 +0530

    liblwfsclient: Add rewinddir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit aeda0a31977e8da295b913e6a306ff01ccf0ce0a
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:22:29 2009 +0530

    liblwfsclient: Revert and re-do readdir conformance
    
    This commit basically reverts the previous readdir conformance
    patch I sent a few days back. That commit had a completely retarded
    and broken way of maintaining per-directory dirent.
    
    It was broken for two reasons:
    1. Creating a wrapper structure around the directory's fd_t
    only for storing a struct dirent is not clean enough. This commit
    takes a better approach by storing the dirent in fd_t context.
    This dirent is valid only if the fd_t refers to a directory.
    
    2. That commit was made and tested under the assumption (..stupidity
    is a better word..) that only opendir call is used for opening a
    directory. That is not correct. Directories are also opened using the
    open syscall. The point is, lwfs_open returns an fd_t and so did
    lwfs_opendir. The previous patch actually changed opendir to
    return a new wrapper structure. That is fine, if we go by the POSIX
    definition of open and opendir because, they're both supposed to
    return different types, an int and a DIR*. However, in
    liblwfsclient, all other code assumes that directory handles
    corresponding to DIR* and file descriptors corresponding to int types
    are the same type, resulting in use of the same locking and fd context
    addition/extraction code. So a directory opened using opendir returned
    a wrapper structure which went down into the liblwfsclient stack
    where some function called a lock on the handle assuming it was an
    fd_t, since it is not and dereferencing of the supposed fd->inode->lock
    results in a seg fault.
    
    Obviously, this didnt show up till unfs3 used open() to open a
    directory and not opendir.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4f1a87a245b960f1cd1fb4fe40b4254ac3793213
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 18:22:19 2009 +0530

    booster: Supplement fstab option parsing
    
    Previous fstab option parsing logic was completely
    retarded and did not handle all cases. This fixes the situation
    so we now work without any problems.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a5301c874f978570187c3543b0c3a4ceba143c25
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Mon May 18 17:24:16 2009 +0530

    workaround for not including sys/cdefs.h -- including sys/cdefs.h breaks build on solaris and other platforms

commit 0346e3e889d854f6f96d9f9b162a8d65ddb35f52
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon May 18 03:02:54 2009 -0700

    Bug fix in pl_readv/writev to handle the mandatory lock case properly.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 49523c834f075007352d07bf09463af9499b59f5
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Fri May 15 03:56:22 2009 -0700

    client-protocol: Fix memory corruption in client_lookup
    
    - memory corruption was due to new members being added between allocation
        of buffer for serializing xattr_req dictionary and dict_serialize of
        xattr_req.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 254f770af6ae6ff207fc567b6576a31469c84f67
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Fri May 15 03:55:50 2009 -0700

    dict.c: make dict_serialized_length and dict_serialize to hold locks.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9669c70c901474dc21ef08e49478b5f5dead8f64
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Fri May 15 03:55:20 2009 -0700

    dict.c: Add dict_allocate_and_serialize
    
    - this procedure atomically allocates a buffer and serializes dict into it.
      - this procedure helps avoid memory corruptions due to race conditions where
        in new members are added into dict between allocating a buffer for
        serializing and actually serializing buffer into it.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit dec2674685da30d6cef157748bcf52454ec97208
Author: Csaba Henk <csaba@lw.com>
Date:   Sat May 16 04:28:40 2009 +0200

    make getxattr fail with ERANGE if reply is bigger than what was requested
    
    Edited by avati: make the function signature of fuse_xattr_reply_buf() use 'const char *value' instead of 'char *value'
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b4651c4b8c7ebbcee7bfc7ef50afebf7e25d5744
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu May 14 00:21:02 2009 -0700

    apache/2.2/mod_lwfs: port to use new lwfs_readdir interface.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 43a568d732962c8e095d3072f672451bcbe95f47
Author: Amar Tumballi <amar@del.lw.com>
Date:   Wed May 13 12:46:29 2009 -0700

    avoid duplicate mounts while using mount.lwfs
    
    This change is needed as the format of how the /etc/mtab entry of lwfs
    mount looks is now changed.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ce653eadc2d13e9f4d3748d217ef7614539a2f34
Author: Harshavardhana <harsha@sunway.com>
Date:   Fri May 15 02:39:15 2009 -0700

    modified init scripts to honour @prefix@
    
    fixes http://savannah.nongnu.org/bugs/?26581
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 11cae446e0c115bbfa5ee3e6b18ef0e2c45b84fe
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu May 14 02:12:20 2009 -0700

    Edited log message for --volfile-check
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 19a1ce89421b7f066168059e972c906b8c194e54
Author: Amar Tumballi <amar@del.lw.com>
Date:   Wed May 13 01:26:24 2009 -0700

    minor log enhancement in 'ib-verbs' transport.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 92a84f8c0f0925f85ad40db1212ff5ef0c1fc809
Author: Amar Tumballi <amar@del.lw.com>
Date:   Mon May 11 13:19:49 2009 -0700

    replace BIG_FUSE_CHANNEL_SIZE with 'this->ctx->page_size'
    
    Send the struct stat's  'blksize' variable same as LWFS's page-size,
    instead of BIG_FUSE_CHANNEL_SIZE.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4f7552c23bc4d0691062bd6a90fa76aa53bdf97c
Author: Amar Tumballi <amar@del.lw.com>
Date:   Fri May 8 01:33:02 2009 -0700

    default log file different per mount (or if server, per volumefile)
    
    This feature is required becuase when more than one lwfs process
    is started with default log file, all logs will be going to same file,
    which after a while gets more confusing.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f4fbc7200c32c50501df7a84b4ddeb4eeb0f5525
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon May 11 11:25:40 2009 +0530

    posix: Fix build warning on incorrect type
    
    This fixes a build warning due to use of incorrect
    type for size_t, for Core 2 Duo.
    
    Extra fix from avati: change %ld to GF_PRI_SIZET
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5c1d9108c1529a1155963cb1911f8870a674ab5b
Author: Amar Tumballi <amar@del.lw.com>
Date:   Thu May 7 17:21:21 2009 -0700

    stripe init 'block-size' pattern parsing bug fixed.
    
    ref: http://savannah.nongnu.org/bugs/?26416
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 20e8fc7a61fd22af1657cffa674c287ad29a7699
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu May 7 04:16:28 2009 -0700

    scheduler-nufa: fix initialization of refresh-interval
    
    - refresh-interval was being reported as not provided in the options
        even when configured.
      - fixes bug reported in rt #1007
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 124f02ed49615e8337d249a2c56e95a5298a856b
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu May 7 05:05:03 2009 -0700

    Set op_errno properly in afr_flush.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b3f7efe247ad114b6071ba6a2d6816f783d4aa15
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri May 8 15:45:24 2009 +0530

    booster: Add fstab parsing support
    
    This commit changes the booster.conf format from a
    simple custom format to that of the /etc/fstab.c
    
    See booster_mount(..) for the mount options supported/required
    for LD_PRELOADing booster. I'll write a small help doc soon.
    
    This commit also brings in fstab parsing code into liblwfs
    because Darwin libc only supports reading the hardcoded /etc/fstab.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5f4c102297bae265a7c9a16a86ee032ffbd44830
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri May 8 15:45:09 2009 +0530

    booster: Standardize conf file and env variable
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit adb56cb5e0f0d718764b25f1b37397be720f8750
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu May 7 15:02:09 2009 +0530

    backend-xattr-sanitize.sh: script added to extras/
    
    Run the script as:
    
    sh$ ./backend-xattr-sanitize.sh /data/export0
    
    and it will remove all the known stale xattrs on the backend files and dirs

commit babc4dfb08504e41a35cf06e8c297a19c87ac397
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu May 7 13:28:21 2009 +0530

    valid_host_name(): accept string lengths upto 75 chars (the limit accepted by glibc resolver)

commit fd2e7d9ebb94ccf5faf5c9d9891978e09fce0b05
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed May 6 05:40:15 2009 -0700

    symlink-cache: fix return value of readlink
    
    - sc_readlink wrongly returned strlen (link) + 1 when link was present in
        cache.
      - this fixes rt #828. Since fuse_readlink_cbk does link[op_ret] = '\0', there
        was a memory corruption.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 542d9ed6c1758df85fc0e252952cfb80669f4a70
Author: Amar Tumballi <amar@lw.com>
Date:   Wed May 6 08:59:21 2009 -0700

    fix in mount.lwfs for proper direct io mode option.
    
    fixes the bug which causes LWFS not to have valid 'direct-io'
    option through mount command or /etc/fstab entries.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 92a84a43e057ce2448c235d3bf66a0b694338d65
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu May 7 11:59:23 2009 +0530

    protocol/client: indentation fixes

commit 2ff188571e94831b389f5677e06b94d11eb5fc62
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu May 7 11:06:34 2009 +0530

    protocol/client: removed conf->child

commit f9f5519b66a25651eb03de577f68d481abdd4c40
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu May 7 01:24:41 2009 +0530

    transport shortcut b/w client and server
    
    This patch makes the server pass back the transport pointer of the client. If the UUID matches, the client makes the local transport 'shortcut' with the remote transport (pointer received from server)
    
    The shortcut simulates a socket queue. Instead of serialized messages going over the network and getting queued in the tcp socket queue, the messages get queued in a transport specific queue picked by a polling thread.

commit 12eb832e255a1abb90434ab3e0d1e1632ae7ce03
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed May 6 14:40:45 2009 +0530

    fix log message from transport-timeout to frame-timeout

commit cba961e9f4ff3452f5e8e6152c632a258b737576
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed May 6 12:23:54 2009 +0530

    liblwfsclient: Improve readdir conformance on re-entrancy
    
    readdir is supposed to be non-re-entrant only with respect to the
    given dir stream, not the whole process.
    
    What that means is the static struct dirent that we maintain in
    liblwfsclient should be per-directory handle and not
    process-wide.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f82651ef4ff5a9e94fa9c0d1f9cf091345440b56
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed May 6 12:23:14 2009 +0530

    liblwfsclient: Fix large directory reading bug
    
    As of now, we use 1024 bytes as the buffer for reading directory
    entries. If a directory as many files, then its possible that it does
    not fit into this buffer, thereby requiring more than one call to
    readdir. Now suppose the last bunch of directories fit more or less
    exactly int the 1024 byte buffer. If this happens, the offset
    extracted by the current logic(in libgf_client_readdir) never gets
    updated beyond the first entry in this last block, because the last
    block's first entry always remains same. This explanation is
    convoluted, I know, but I too found out the hard way.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8d1b62393b58ff3ac5b157e0adea15578c949bbf
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 20:45:48 2009 +0530

    booster: Use CONFDIR as booster.conf default location
    
    This commit changes the default location of the booster.conf
    file from /etc/booster.conf to a directory defined
    during the build process.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit faef6fded892c310a3debdce273a382286a4ec19
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 20:45:26 2009 +0530

    booster: Change booster conf env var name
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f6862d75d1ca50b12372d5f9c3e651d6f74c5900
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed May 6 11:43:33 2009 +0530

    afr self-heal: update file size of the returning stat buf with source file's size

commit 3f3dea5f23e2b49ac8ad14bf8dd34dfadf6a72f5
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue May 5 20:04:50 2009 +0530

    log level fixes in read-ahead

commit 9cb93f58be9d032bec12ca04275e84904bf22c0b
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue May 5 20:03:36 2009 +0530

    log level fix in storage/posix

commit f62628af61f5ef72c6af2b807c1bba71f291a366
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue May 5 19:19:30 2009 +0530

    io-cache logging level fixes

commit e9800f8915257f8e3fc94dea8257e20a5561dfd7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:57 2009 +0530

    liblwfsclient: Add 0-byte size/count guards
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fe94d6e4992d7b7f2bcee73dfd2b0af76e1f2611
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:50 2009 +0530

    booster: Add lchown API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8a3495e7d4b2273746d9e38aefbae583131951ca
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:43 2009 +0530

    booster: Add remove API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit bddbe5f7a4437fc4c295b7830fa2916011ab799a
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:37 2009 +0530

    booster: Add getxattr,lgetxattr API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ad8e8fa72f287da034027bf26fc1fbfb1437d47e
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:29 2009 +0530

    booster: Add readdir64 API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c803febb9b013e384bcccf37a2c68dc90deea444
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:23 2009 +0530

    booster: Add statvfs API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fe6a39da3cd7370e9a7d9f7908e06cbdce64ce6a
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:15 2009 +0530

    booster: Add statfs API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4de7dc7151d307021177107fcf8dd636b306bb59
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:08 2009 +0530

    booster: Add lstat API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 13a58f94a781d91ab3d7854996df66c9802d972b
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:04:00 2009 +0530

    booster: Add fstat API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 938191c57f0ef3a657a764033f70df6595dc736c
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:03:52 2009 +0530

    booster: Add stat API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cec18ef672700dea563a8c899170ece4730257e5
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:03:42 2009 +0530

    booster: Add closedir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit abeec15e1da0c40bee134253035af88739e09960
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:03:32 2009 +0530

    booster: Add readdir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 792cd732264d751895e8469e7c5f3cb172574180
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:03:24 2009 +0530

    booster: Add opendir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fc602c0c17064dfbd81d3d85141b55a40c45d8d9
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:03:16 2009 +0530

    booster: Add realpath API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e749da85ec67dfa62af5702d199b8f1bcc53d1d7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:03:09 2009 +0530

    booster: Add readlink API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1504e1d50c7efcf20fe55fc7db526bb1d364244a
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:03:02 2009 +0530

    booster: Add symlink API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 48e30d6715574c34bc760798e1657b5900129c25
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:02:55 2009 +0530

    booster: Add unlink API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 62b29b0db6f7d417a3281c3937bd5af20e1bf201
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:02:48 2009 +0530

    booster: Add mkfifo API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7d87f8f5ce56278f56427196b5e2c5e4c0be02ad
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:02:38 2009 +0530

    booster: Add mknod API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4311e7f01dc244baa1a1b8fc50f74a823dbd38c4
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:02:31 2009 +0530

    booster: Add utime API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 48ee90ab87cf0c01fee0188728d70d67c6724b97
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:02:24 2009 +0530

    booster: Add utimes API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit acac22c87374310544b3a4bb301e9bfa3ea26001
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:02:17 2009 +0530

    booster: Add rename API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 11cdc6e5282d4c7d906da3e20b50df78ddba2efd
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:02:10 2009 +0530

    booster: Add link API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9b012b098915c8bdbdcb8a4c38fb353fa39e82d4
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:02:02 2009 +0530

    booster: Add ftruncate API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e4e97f2bdaf6d98c5a133491efdffebb64fae4d6
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:01:54 2009 +0530

    booster: Add fsync API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e6f4a6879a6f9bb11e6774182b211b57f1a827fa
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:01:47 2009 +0530

    booster: Add fchown API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8fa2a984c315418b940c481ea7729c00ed0b033a
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:01:40 2009 +0530

    booster: Add fchmod API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ad4f864c448a3bbcec67d3fb3c44e07993cd70e7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:01:32 2009 +0530

    booster: Add chown API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 13610ba31d3b5a60c4d03343438f696725558e65
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:01:24 2009 +0530

    booster: Add chmod API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 76aa5e491dc3577bf8471cb649fee7b3d0a3dc9d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:01:16 2009 +0530

    booster: Add rmdir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 93c3a887695fc4fa7a65d6556398cffcf22d099e
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:01:09 2009 +0530

    booster: Add mkdir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 358d3e7f99ecdc48c044f11f9f6011805d061ec4
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:01:02 2009 +0530

    booster: Add log message
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 83ae751616ce18d3010664f13ac8b8ecf8dd313d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:00:56 2009 +0530

    booster: Clean-up pwrite64
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 00b1e268fb0d3696820bd2e849c42deebe80a3cd
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:00:49 2009 +0530

    booster: Clean-up pwrite
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6696009a6662cc77458246ffc3dccc22f8d6c185
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:00:41 2009 +0530

    booster: Clean-up lseek64
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 513a2d15c16a9b5c96ceb321bed08d34d659e12b
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:00:34 2009 +0530

    booster: Clean-up lseek
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 24b360d865dbf344f8369e656d282739f07c18e8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:00:27 2009 +0530

    booster: Clean-up write
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8cacf5455bc97e84f62605df60a6ae5f66b61a1c
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:00:20 2009 +0530

    booster: Clean-up writev
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 0c86f9686f2c91ef8838972ad038ba0c587cd09d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:00:12 2009 +0530

    booster: Clean-up pread64
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2763f86eea23898501c5299f58edc37e2c1262e5
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 16:00:04 2009 +0530

    booster: Clean-up pread
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a35a80b79702d3a81a9d62fc200ae61c6ec67b74
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:59:55 2009 +0530

    booster: Clean-up readv
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 61201d40bc22f1299bc49202433664664ec23ce6
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:59:47 2009 +0530

    booster: Clean up read
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f0bef18b788c8beadc4131c5a6534761857c7f46
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:59:40 2009 +0530

    booster: Support VMP-based creat
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d470dd599c8dbf609411e52e587ea5c171214b21
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:59:32 2009 +0530

    booster: Add VMP-based open support
    
    In brief, when an open is called the VMP-based open is called first.
    If that fails, the fallback is the Mount-Point Bypass(MBP) technique
    which uses entended attributes to determine if the given
    path is a lw mount. If it is, it goes ahead to create a
    lwfsclient handle. All subsequent calls to this real mount point
    get redirected to the lwfsclient handle. The other fallback is
    the actual open syscall on the local file system itself. This happens
    when the absence of an extended attribute tells us that the path is
    not even a lwfs mount point.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3364e5eb2d5f5110e86924112dfe3f10597c9c9f
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:59:25 2009 +0530

    booster: Remove fcntl.h from include path
    
    We define the O_CREAT, etc. flags so that we can remove fcntl.h from the
    include path. fcntl.h has certain defines and other lines of
    code that redirect application's open and open64 calls to the
    syscalls defined by libc.
    
    For us, thats not a Good Thing (TM).
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 313713a254e193623807d019f4c0e17e637ed316
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:59:18 2009 +0530

    booster: Integrate VMP-based mounting
    
    This commit brings into booster the use of VMP based operations
    which will allow users of booster to specifiy a VMP and use it
    for transparently operating on a lwfs client context.
    
    Since applications are oblivious to booster's presence, because it is
    LD_PRELOAD'ed, we need to specify the VMPs and the corresponding
    options like volfile, logfile, loglevel, through a conf file.
    
    By default, this conf file is the /etc/booster.conf. This can be
    over-ridden through the GLFS_BOOSTER_CONF environment variable
    for the application.
    
    The format of the conf file is very simple for now. Each VMP is
    described on a single line with space separated fields.
    
    Format: <Virtual Mount Point> <volfile-path> <log-file> <log-level>
    
    <log-level> takes the string representation of the usual lwfs
    log levels.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 42d5355a6221ea473372c891544e4cc7b265bbe9
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:59:11 2009 +0530

    liblwfsclient: A Fix deadlock in ftruncate
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7eb61fb44986fc834a19d9f38754f1be54d07e09
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:59:03 2009 +0530

    liblwfsclient: Conform'ify lwfs_readdir
    
    This commit does two things:
    1. Changes lwfs_readdir prototype to conform to the POSIX
    readdir().
    2. Uses a 1024-byte value instead of sizeof(struct dirent) for the
    @size for libgf_client_readdir. This allows even larger names to fit
    into a single readdir request to the server.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b48df70c58f52878d58f3e1a0adc870688cdfcdc
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:58:56 2009 +0530

    liblwfsclient: Add VMP-based lchown
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit dec408299ea7a2cb9aa9aa3ea3a3c72ee79169de
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:58:48 2009 +0530

    liblwfsclient: Add remove API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4353ba5cdf0dab29e30997ce5b67055c8f1e1cba
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:58:38 2009 +0530

    liblwfsclient: Add lightweight path resolution
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e57175c0177ecc8b9ff80d3ce6c5f9a3f8248214
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:58:30 2009 +0530

    liblwfsclient: Add lgetxattr API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d18d2550484f3d930557fed038a6bf9ffa23de48
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:58:23 2009 +0530

    liblwfsclient: Add setxattr,lsetxattr API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 84d5566fab6daaffe3ad5da76d87a9c9e20e7170
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:58:16 2009 +0530

    liblwfsclient: Make stat resolve all symlinks
    
    We want to resolve even nested symlinks when calling stat,
    therefore, we need to depend on realpath-like functionality
    and not just a readlink.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a0cd85c307f3576291829beb825323d43aeca7f8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:58:09 2009 +0530

    liblwfsclient: Fix realpath operation
    
    This commit does two things:
    1. Ensures we go on to traverse nested symlinks by calling realpath
    recursively on the symlink.
    
    2. Makes lwfs_realpath, a VMP-based operation, return a resolved
    /real path that actually has the VMP pre-fixed to the resolved path.
    If this is not done, we'll be returning a path that is valid only
    within the lwfs context, i.e. the path will point to a real
    file/dir only if a lwfs handle identifies which lwfs context
    the file is in.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d1e74d7faa8670d6a7bf47ab9105af03d7dcf9a6
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:58:03 2009 +0530

    liblwfsclient: Dont lookup oldpath on symlink
    
    The target of the symlink does not have to be interpreted in
    any way. It should be sent across as it is.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5cfa7a3a5ee9199399137e217597b1b97f7a4e38
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:57:56 2009 +0530

    liblwfsclient: Improve path matching heuristic
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b46296282155281768407c93f878ba3823118463
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:57:49 2009 +0530

    liblwfsclient: Guard against un-inited VMP searches
    
    On my system, an selinux module gets inited before
    booster even though the FS calls from the selinux module
    get routed through our LD_PRELOAD'ed wrappers. In this
    scenario, the VMP list is un-inited, resulting in a seg-fault
    if it is dereferenced. The list_empty check does not help
    because the pointers in the list have non-NULL values.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4ecd27aed126b20012abe1449bc49b4c646cb9d0
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:57:42 2009 +0530

    liblwfsclient: Add comments to API
    
    Some of the functions have also been moved within
    the header to reflect the order in which users will
    read through and try to understand how to use the lib.
    
    For eg. the init, mount and umount functions have been moved to
    the beginning to clarify how to start by init and de-initing.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 90f854f470b354bc36d46397d39a065cbe89e27d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:57:34 2009 +0530

    liblwfsclient: Expose a few remaining APIs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b12fde2b06c4701970201aaebc7f45a8b964812c
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue May 5 15:57:27 2009 +0530

    liblwfsclient: Add VMP-based rename
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6fdf8f4c7d5cced776c925052eb8a81c332a3573
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon May 4 10:59:18 2009 -0700

    Do not lock entire file for metadata operations.
    
    Metadata operations now lock only a single byte at offset
    (LLONG_MAX - 1) instead of the whole file, to avoid contention
    with writev().
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1a5bcf508b22c1f9f5bd2f555e290f6725035cd2
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon May 4 10:50:48 2009 -0700

    Made afr_flush a 'quick-unwind' transaction.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9aea45a0e1338a10558c4f3f434d172c4bc8c209
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Sat May 2 14:37:04 2009 +0530

    io-threads: Clarify thread count range
    
    This patch cleans up io-threads behaviour regarding the
    range values that can be specified for min-threads
    and max-threads. THe major change is that the min threads
    have been reduced to 2 to signify that io-threads needs minimum
    two threads for its operation, while keeping the default number of
    threads at 16. The idea is to decouple the default thread count
    from the minimum thread count.
    
    Note to Avati:
    This applies over Raghu's indentation and logging take-3 patch.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 80c30634da16f7b333d07eeff9839b70d577e39f
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon May 4 10:33:11 2009 -0700

    io-cache: indentation and logging fixes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5d417f0f8853e4f17caf25255f98c559f3670434
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Apr 30 07:09:42 2009 -0700

    io-threads: indentation and logging fixes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit bed4717a1b41e3e9af47ff1673e28925ba351f92
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Apr 30 10:42:14 2009 -0700

    Cleaned up log messages in storage/posix.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f9d689ef3dd7040e09f704d24696b268ac1bdff6
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 29 05:23:17 2009 -0700

    write-behind: indentation and logging fixes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 60d91b69768bd97cd83adc6edb4e1f7d6c13b6ba
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 29 04:21:59 2009 -0700

    read-ahead: indentation and logging fixes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 946436dc17f7df47608b9a64aa11b77d7caf309d
Author: Harshavardhana <harsha@sunway.com>
Date:   Fri Apr 24 05:47:39 2009 -0700

    Fix a conditional during dependency check
    
    Conditional was wrong and dependency check would fail.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ce6fa580af849b03c4641baf77bf07c590be934a
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Apr 29 08:51:41 2009 -0700

    bug fix in server protocol segfault when the volume file key is NULL
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 78aa2ee7d2f646a41f19858db9c48a8afc82e83f
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Apr 29 03:23:55 2009 -0700

    Cleaned up log messages in features/locks.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d22b495e0c4c180de63082add3e3e3168f1a0e1f
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Wed Apr 29 02:16:51 2009 +0530

    cluster/unify - unify_forget() should not try to access inode->ctx, if inode->st_mode is not set.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2de8717247d3dc1dcda4e3e8b3c260887c3e5891
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Sun Apr 26 22:51:18 2009 -0700

    mod_lwfs/apache/2.2: fix segmentation fault
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3e3fa81c3465bc329d448aac78de8e556d9d513f
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Sun Apr 26 21:36:33 2009 -0700

    memory leak fix in auth/login.c
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f827d1536635c53dbee27ade459f1e207c1115e8
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 28 19:29:50 2009 +0530

    protocol/server indentation fixes

commit 604f38b8df4ac8427f55bc708bb72d8700924122
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 28 16:02:22 2009 +0530

    protocol/server log level fixes

commit 7bbbc9c8786d079055138ac4f8ea98b576c73ce0
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 28 15:11:21 2009 +0530

    protocol client log cleanup

commit 7ce91b4e860b7c077c64e54f49943b2f77972967
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 28 15:11:05 2009 +0530

    fuse-bridge log cleanup

commit d2ed893e3a526506ef302281d6bc936e6219063d
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 28 15:10:38 2009 +0530

    socket transport logging cleanup

commit 702affac485649f9509b1d6912e1a7737dbb23ca
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 28 15:10:16 2009 +0530

    dht logging cleanup

commit a76ce13ce29249f4622fcfef39bcd087c1cd050a
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 28 15:09:57 2009 +0530

    afr logging cleanup

commit 34f9a0b30043cf7836601cb620b4bcc4239357ac
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 28 15:09:22 2009 +0530

    liblwfs log cleanup

commit 29f111a22fe574eaa6938bf0bd3516796abe597d
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 21 19:39:24 2009 +0530

    log message cleanup in distribute
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 53f4af3aad6601ded97b5ef19d2383fe8efa7984
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 21 21:36:27 2009 +0530

    log message supressing in DNS resolution
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3699c3b966dec936bbbe9ec610d48feb41e0880a
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Apr 21 21:34:38 2009 +0530

    cleanup of logs in socket and ib-verbs transports
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9c540ee5bf8a620db3855814db7b0f0f71644aac
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:34:08 2009 -0700

    Cleaned up log messages in replicate.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 04532fe34c582f551ec7d81b3fa6168f3a4a4d21
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:34:07 2009 -0700

    Cleaned up log messages in client-protocol.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f99f41b67e500a38015b61781b59224a8395dd98
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:34:06 2009 -0700

    Cleaned up log messages in mount/fuse.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8825c34d14e76914f7357c773c86b89ff03592cc
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:34:05 2009 -0700

    Cleaned up log messages in xlator.c
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit add02343dd4d9a095552a703f8fa732455b0ff8d
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:34:04 2009 -0700

    Cleaned up log messages in spec.y
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 0651c3a12c30f21067111498e9710864698c028b
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:34:03 2009 -0700

    Cleaned up log messages in inode.c
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c3e4bb1bc8c7aac727a236f101c5d9f36a536c5a
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:34:02 2009 -0700

    Changed logging format to remove line number & function name from NORMAL and higher levels.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b52a5a408b82496a295c1065f2286c6755a04689
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:34:01 2009 -0700

    Introduce new log level GF_LOG_TRACE.
    
    TRACE is the most verbose log level, meant to have a
    full trace of operation.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 174872b3644d36f6d0f8a34d9c06092abc126e4f
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 21 02:18:38 2009 -0700

    Remove log level TRACE and the macro GF_TRACE.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e0c284c6e7c98b3a2fbd5c60d59b928d6e7af88a
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri Apr 24 15:28:40 2009 +0530

    iobuf: Define MAP_ANONYMOUS
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7b2e459db65edd302aa12476bc73b3b7a17b1410
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Apr 24 15:18:15 2009 +0530

    rename transport-timeout to frame-timeout, and set default to 30mins

commit d892c56c1d0b1de466ee4cf4071ab7b722808c00
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Apr 24 00:57:42 2009 -0700

    Revised README
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 689347f278e5acfda95a24f7804a1450043311f3
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Apr 23 06:53:02 2009 -0700

    Do not fail lookup() in case of split-brain.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 99351618cd15da15ee875f143154ea7f8e28eaf4
Author: krishna <krishna@lw.com>
Date:   Wed Apr 22 23:43:58 2009 -0700

    "option unhashed-sticky-bit on/off"
    
    "option unhashed-sticky-bit on/off" will configure distribute to set or not
    the S_ISVTX bit in the stat.st_mode of the actual file in case it is
    pointed to by the link file. This can be enabled during migration.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b6f634f602559cfe0c4609f16c9f33a32243b578
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu Apr 23 11:20:17 2009 +0530

    fix build warning in locks translator

commit d886ceb9cbf45434ea0218f0098862daafb26ecb
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu Apr 23 11:09:37 2009 +0530

    minor build fix - set EXTRA_DIST to point to MacOSX/Portfile instead of Portfile

commit b0acbf09c21ff898ad3315811974e49cc80e6f2b
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Apr 23 04:05:00 2009 +0530

    fix bdb_db_get() to return exactly read bytes and to copy the read data to given buffer only when needed.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e5686c440f3c03fbb24759342e5badf102579634
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 22 07:33:59 2009 -0700

    mod_lwfs/lighttpd/1.4: port to use virtual mountpoints.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5f0bf570069770ee5c98fea728f0231f93eaab5c
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 22 07:34:10 2009 -0700

    mod_lwfs/lighttpd/1.4: ensure each line is no more than 80 characters
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7a77bad6d583ee9266e6e3f566bf19d579177e3e
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 22 07:32:30 2009 -0700

    mod_lwfs: port apache/1.3/mod_lwfs to use virtual mount points
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e26b63ccfc3aa0b29afb7235b863b7b4a7c8ae95
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 22 07:32:42 2009 -0700

    apache/1.3/mod_lwfs: ensure each line is of maximum 80 characters.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3c68984b6f8dbb772a858fcf829d6c6f81503912
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 22 07:32:53 2009 -0700

    liblwfsclient: implement lwfs_umount
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b817670c609dda2a1038fb94bd5a7dc6fa522518
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 22 07:33:03 2009 -0700

    mod_lwfs: port apache/2.2/mod_lwfs to use virtual mount points
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 725a1fcb1e84507c28f009d0f83692e0b57e474b
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 22 07:33:15 2009 -0700

    mod_lwfs: coding guidelines related changes
    
    - make sure code fits into 80 character lines.
      - proper indentation of declarations.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c8e9a96e2c3801701e7f218f1b12fef16071b088
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu Apr 23 10:20:06 2009 +0530

    replicate dir self-heal - when creating a missing dir/file, set pending xattrs on source subvolume for that dir/file

commit bb592b1a8465fa078d0cd5f445f08280b78a93e4
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu Apr 23 02:18:52 2009 +0530

    fix in afr directory self-heal (partial healing)
    
    impunge loop was 'continued' on a different subvolume in certain cases, resulting in healing of partial files

commit 86fff0e75b445dee3cda6b788699930eb649334e
Author: Harshavardhana <harsha@sunway.com>
Date:   Tue Apr 21 02:24:22 2009 -0700

    Add MacOSX based packaging file into repo
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 38a6a5b1a12eff04f26ded17ce4585a6ebdc7986
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Apr 22 04:31:36 2009 -0700

    Bug fix in releasing inode locks when transport gets disconnected.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit df6d9e16817d952c17700d44ab478e6d6af704a0
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Apr 22 01:02:09 2009 -0700

    Release all pending locks in pl_forget().
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7eb63e30f22f7a9d785f6620be22d2b3aab77ada
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Apr 22 12:55:47 2009 +0530

    iobuf_pool->arenas_cnt should be incremented in iobuf_arena_alloc, and not iobuf_pool_add_arena (to avoid counting of unpruned arenas)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4877476fa1a591c51f4b3ee76082766f38a33b23
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Apr 22 04:01:06 2009 +0530

    0-byte write guard
    
    guard server_writev from 0-byte writes from client where iobuf will be NULL. This is possible only via liblwfsclient (not fuse)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit bc1dff620cc185c3e08853b9b7fb4c5a04c48ebe
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Apr 22 03:59:30 2009 +0530

    handle iobuf NULL return case in fuse-bridge, by waiting 10 seconds and trying again
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cf508025fe506a507fe16ed52df74dc7e0ca7c64
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Apr 22 03:44:01 2009 +0530

    fd leak fix
    
    steps:
      - server_finodelk uses req->volume pointer into state->volume
      - finodelk is queued by locks translator
      - c call returns from server_pollin and hdr is FREE'd
      - now state->volname is pointing to FREE'ed region (junk)
      - server_finodelk_cbk calls gf_add_locker
      - gf_add_locker remembers lock with junked path along with fd_ref
      - gf_del_locker from new server_finodelk cannot string match with junked volume thus
        lock is not deleted, hence fd_ref remains as a leak
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8d2e5d8062361df451be7c6f748a23884f1cf315
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Apr 22 02:21:46 2009 +0530

    afr_lookup_cbk - self-heal getting missed
    
    compare for mismatching sizes and attributes before overwriting local->stbuf for read-child subvolume. This causes files with differing sizes on backed not to get self-healed if xattrs were missing.
    
    Also add the ESTALE check for compulsorily failing revalidates in case of 2nd unwind and beyond
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 07f1524165f864e09033b7f78e921c5375d4e2d6
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:50:33 2009 -0700

    posix: Ensure EINVAL return on NULL args
    
    Initing op_errno to EINVAL ensures that this is the value
    that gets returned on STACK_UNWIND, in case any of the VALIDATE macros
    result in exit from "out" due to a NULL argument. If this is not done
    , we get op_ret as -1 with errno set to 0 in the application's
    syscall.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 27e1c9fbd3fb6eda4f7d64ff04dad9d306c237e7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:50:20 2009 -0700

    call-stub: Check for NULL in the correct variable
    
    It looks like the argument fd was meant to be checked here instead
    of the fd in the call stub. This fixes a NULL fd bug that results in
    an EINVAL on opendir.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 31643eb227a5dfba11d23068e9626bf9546283bd
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:50:08 2009 -0700

    io-threads: Add fxattrop fop
    
    -- added some indentation fixes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e246a3131676197aff0430429db1e7d7cc00be65
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:49:55 2009 -0700

    io-threads: Add xattrop fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a9b4360d889097e8ea25497eb669daebcaf1e381
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:49:45 2009 -0700

    io-threads: Add readdir fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d1eb9b13d2e50485e69301ade12afe5ea8636af8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:49:24 2009 -0700

    io-threads: Add removexattr fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 609c5aff6faa21cf3aaefa6b7a2a31a91590d726
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:49:10 2009 -0700

    io-threads: Add fsetxattr fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a77340b94147a078918536a5297746803c846809
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:48:56 2009 -0700

    io-threads: Add fgetxattr fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d7753849cc66c3aef66dc1270920389d3c42e7ce
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:48:45 2009 -0700

    io-threads: Add getxattr fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6b426bc53e2e6106e32568f09354d4e4ce382f11
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:48:33 2009 -0700

    io-threads: Add setxattr fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1cb8064b2a653f06062c226dc12d524d8f1a2da2
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:48:21 2009 -0700

    io-threads: Add statfs fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d769066ddcb7b3fab456a57704b184d0617b8d52
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:48:08 2009 -0700

    io-threads: Add fsyncdir fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 282a39c19ee15f8908eb28f0b2d6983b665d57a7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:47:56 2009 -0700

    io-threads: Add opendir fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cdbeb01abbfc26345df98e5a98a0e5ed513b7cf8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 21 04:47:42 2009 -0700

    io-threads: Add link fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6bff99a8f92befa78ddea62519a05f945db5cdfa
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:36:44 2009 -0700

    liblwfsclient: Add VMP-based realpath
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cf22fd1d0430705e226d61ff8d9492925ce95d46
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:36:21 2009 -0700

    liblwfsclient: Add VMP-based readlink
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a9febb4bd30f41681755a0ee925ae3de6f0fa292
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:36:05 2009 -0700

    liblwfsclient: Add VMP-based symlink
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cb95018adab1377c862dca32f58825b336adafd0
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:35:50 2009 -0700

    liblwfsclient: Add VMP-based unlink
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6f91c9dc86be9c10467ccb5bc3edde2c5d767b9f
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:35:32 2009 -0700

    liblwfsclient: Add VMP-based mkfifo
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit bcc9a67fc22147f54a27a81ee35f4c081a0e6b73
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:35:17 2009 -0700

    liblwfsclient: Add VMP-based mknod
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a7205e78bfb962d9e5ff11db2a0b394e6db03256
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:34:58 2009 -0700

    liblwfsclient: Add VMP-based utime
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e707afad9f6282bc425f8b0262ea5a6db018ec92
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:34:41 2009 -0700

    liblwfsclient: Add VMP-based utimes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b4259400090a28a5dbe27922ad8bc309db2a7c4a
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:34:20 2009 -0700

    liblwfsclient: Add VMP-based statvfs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6cb3159ef38428572b81160e91e7c685ed44acb0
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:34:02 2009 -0700

    liblwfsclient: Add VMP-based statfs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit de2192ea754883ea6ae643f63c44c2cbeb20f981
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:33:43 2009 -0700

    liblwfsclient: Add VMP-based link
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 12d9b4cccd559776f125440a232ff5b944ab3442
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:33:26 2009 -0700

    liblwfsclient: Add VMP-based opendir
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e2ba80403c3e73220a2b48b813df1561a9081e09
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:33:06 2009 -0700

    liblwfsclient: Add VMP-based chown
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 74a46284e17045db302e5bcde0052ea6c7b4c038
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:32:46 2009 -0700

    liblwfsclient: Add VMP-based chmod
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 721783da4f9705331356328b8082873aec1ced0e
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:32:29 2009 -0700

    liblwfsclient: Add VMP-based rmdir
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 07da4292a8678a415acfec130c40febc9a63b6b4
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:32:06 2009 -0700

    liblwfsclient: Add VMP-based mkdir
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit dc53183708d6d9ff998487427312000f30dcb7ee
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:31:49 2009 -0700

    liblwfsclient: Add VMP-based lstat
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 84eb262529ea5389df2296d182ecd5e0582602a7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:31:31 2009 -0700

    liblwfsclient: Add VMP-based stat
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit aa1e2fd37ab93b194308f94edd8ab0a342c7830e
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:31:09 2009 -0700

    liblwfsclient: Fix stat cache bug
    
    The way stat cache gets updated was not consistent across
    all syscalls. Consequently, I was running into a bug that
    returned a 0 st_ino. The fix actually resides in the hunk
    that changes the lines in libgf_client_lookup but similar
    changes were also required in other users of stat cache.
    
    This commit fixes the bug and also cleans up the way stat
    cache is updated.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f29383ef35d210f2a72883cb6157e915200f7c7c
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:30:51 2009 -0700

    liblwfsclient: Add VMP-based setxattr
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4074769dd2435ab3521ab39eb2775c3e80fc32b4
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:30:36 2009 -0700

    liblwfsclient: Add VMP-based creat
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d875df0c5c095488db29a202eac74d10d540aa3b
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:30:15 2009 -0700

    liblwfsclient: Add VMP-based open
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit bb2ca0ec0da700f600d1fa30d111c2aa42804f70
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:29:57 2009 -0700

    liblwfsclient: Add VMP-based getxattr
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6cd656152901ba19ef52f762d000e329e3f7dbc6
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:29:40 2009 -0700

    liblwfsclient: Add VMP-based get
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 86a1c646eeea353643bd6bd5eb040cf584b407c1
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:29:21 2009 -0700

    liblwfsclient: Add virtual mount point support
    
    One part of the lwfsclient library requires users
    to use a handle to address a particular lwfs context.
    This can become cumbersome for applications that need to use multiple
    such context. For such applications, we make it easy by letting them
    define virtual mount points(VMPs), which are just paths that identify
    a particular lwfs context. This is done through a new
    lwfs_mount(..) interface.
    
    Subsequenly, any path based operations, that pre-pend a VMP before
    the files and directories inside the lwfsd export, get internally
    routed to the correct lwfs context. This helps users do away
    with the need to maintain their own path-to-lwfs_handle_t
    mapping.
    
    The old handle-based interface still exists for whoever wishes to use
    it.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7c7fd9039b0d0ba17190677f864c5a22d46ab4d6
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:29:00 2009 -0700

    liblwfsclient: Must return size from readv
    
    The line being removed made libgf_client_readv return
    a 0 on successfull return when the return should really
    be the size of data read.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7bc1747de75d7a65059fbcb191c3776210de1491
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 20 12:28:40 2009 -0700

    liblwfsclient: Expose lwfs_realpath
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 82394d484803e02e28441bc0b988efaaff60dd94
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Apr 20 03:54:04 2009 -0700

    Check return value of afr_sh_select_source.
    
    If select_source returns -1, abort self-heal.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fbefbfee743a01b5ad9977ad24de372258aeb65c
Author: Harshavardhana <harsha@sunway.com>
Date:   Mon Apr 20 04:59:54 2009 -0700

    change errno EINVAL to ENOENT in case of all fuse_* calls for fuse_reply_err ()
    
    Seen "rm -rf" returns EINVAL in case fuse_loc_fill fails when there is a race condition which can happen when multiple "rm -rf" are done on a same directory listing from multiple terminals.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2f5ee29248f4eafcd1c2f5cc31432d22739349d0
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Apr 20 03:38:15 2009 -0700

    Minor fix in afr_sh_build_pending_matrix.
    
    Remove incorrect check for xattr[i] being NULL.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit aa085b10678c01693d0f7222bd4054bb8e8836cc
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Mon Apr 20 13:15:12 2009 +0530

    inode.c - NULL check for the extra __inode_search performed, when presented inode is not hashed.
    
    This bug fixes #967

commit 8660bb2bef59c00df194087ed75ba81f34555a73
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Mon Apr 20 12:00:50 2009 +0530

    afr-transaction: handle double flushes
    
    __if_fd_pre_op_done - reset fd_ctx->pre_op_done to 0 so that double flushes do not result in two xattrop() calls

commit 3b8f7ed4c080dc45da02dc751478863007199c26
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Mon Apr 20 08:08:26 2009 +0530

    client_protocol_reconnect - do not send notify of CHILD_DOWN event if errno from transport_connect() was EINPROGRES
    
    This bug was racing between a CHILD_UP from poll thread resulting from the event_register() of the new socket called in fuse thread. CHILD_UP would sometimes overtake the CHILD_DOWN for EINPROGRESS. So replicate would receive CHILD_DOWN as the latest event. This resulted in self-heal not happening etc.

commit 42617775a2821dc74300b89dd14a08b068575b2b
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 18 13:27:21 2009 +0530

    keep ctx->page_size fixed at 128KB but only add the margin for iobufs which are created

commit fb5cc405ae45b4e573d6acbe3383349a278f2bdf
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 18 11:19:34 2009 +0530

    enhancement to migrate-unify-to-distribute.sh

commit 093141a74962f11654c44fe2292605f9cf65e709
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Apr 17 16:07:00 2009 -0700

    added migration script from unify based setup to distribute based setup
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9a4a2e2286cb372ca462f6f25f78de686ea3e4ce
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 18 02:49:03 2009 +0530

    pruning buffer margin - do not destroy if no other non-filled arenas are in the pool

commit 307528ef9a33a4d294b3ea49bbf5f0b16b27aa0f
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 18 01:09:31 2009 +0530

    disconnect transport peer if system is out of memory while allocating iobuf

commit 50b2291e3b046ea6b8fdfcb7e206c772eae64f0e
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Apr 17 23:35:43 2009 +0530

    iobuf - account with iobref_size() instead of iov_length (vector)

commit 1d6dfe94fb970b51d96653da6c3361533d697fc3
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Apr 17 23:12:37 2009 +0530

    added 2 APIs iobuf_size and iobref_size to return the system memory usage by an iobuf, and by all iobufs in an iobref respectively

commit 7867577b346c7f003be67ad202f4085cf35fdf7c
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Apr 17 06:15:16 2009 -0700

    Destroy old ping timer before setting new one.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7b1beca0a3b60a8b9347a3122d77aea081ccb773
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Apr 17 05:42:23 2009 -0700

    Fix two memory leaks in afr self heal code.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 98a872df828aa2786c7bf595d430ef64351f4192
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Apr 17 17:52:07 2009 +0530

    add 4KB margin in iobuf to accommodate fuse header

commit 0b20c24a399eb03fdc431ea2761e1334e0032651
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Apr 17 04:23:58 2009 -0700

    Fixed parameter to finodelk in STACK_WIND in dht
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4e3eae6561b38b53bef2d20177ab62602db45c14
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri Apr 17 02:33:01 2009 -0700

    liblwfsclient: Fix typecast to fix build warning
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4a632ea96be3012c583165865bbde392f99a327b
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Fri Apr 17 14:19:18 2009 +0530

    protocol/client - set remote inode number in inode context for root inode also, during lookup_cbk().
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6bd53940d198e55780cbc7d8678da6d67df80265
Author: Harshavardhana <harsha@sunway.com>
Date:   Fri Apr 17 01:08:00 2009 -0700

    Renamed abs_top_srcdir to top_srcdir for older versions of autotool
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4e68cf7c4d912556e25eb1226669d7b438ff8a3f
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:59:02 2009 -0700

    liblwfsclient: Remove unused variables
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 27d73ca503b2e508c682fca2848f8ae38390a146
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:58:50 2009 -0700

    liblwfsclient: Add realpath API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4ada36f9bd6e008dfea65d708d785907b993b946
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:58:39 2009 -0700

    liblwfsclient: Add lstat API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7cd3cc24c8f3178382074c8a3a319df17b85769d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:58:26 2009 -0700

    liblwfsclient: Add readlink API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a6f0446541e917979a697edd06dd28634bf3ec6d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:58:13 2009 -0700

    liblwfsclient: Add symlink API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7aff8936f9c86677ee205e1cf9cb41f4ea9edecd
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:58:00 2009 -0700

    liblwfsclient: Add unlink API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 42528875cdaee764070e54b8fcd5e91ba8733e98
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:57:40 2009 -0700

    liblwfsclient: Add mkfifo API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 933c3eee81f843db1fb8a2eda491d49cfc04efea
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:57:24 2009 -0700

    liblwfsclient: Add mknod API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 169976dfafeb714f3c94b9a2f635f36759334b9c
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:57:13 2009 -0700

    liblwfsclient: Add utime API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c9017ae0de2531342125eaf2a6aca3b9a251b16e
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:57:01 2009 -0700

    liblwfsclient: Add utimes API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 366bd140f3f0fbc6b343aab067713c398ae601af
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:56:51 2009 -0700

    liblwfsclient: Add rename API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5feab82f0c228410d94f3dfa53025f85d6eac8b1
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:56:40 2009 -0700

    liblwfsclient: Add statvfs API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ff2bacf3466ddd4473ae3774e1f822981f4d8198
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:56:29 2009 -0700

    liblwfsclient: Add statfs API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f199ebf5d0c4d90abbc5d0dafd67561f39f398b8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:56:08 2009 -0700

    liblwfsclient: Add link API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e18b8031ab4c7ce763e1e7d57bf5c98a1cbe7167
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:55:55 2009 -0700

    liblwfsclient: Add ftruncate API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9193494d20a8555a90126b9d23e848b0b8ca196e
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:55:40 2009 -0700

    linlwfsclient: Add fsync API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 912f1a8492c8c20743c8d7f0a75aeb31f2483932
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:55:26 2009 -0700

    liblwfsclient: Add fchown API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 67561c965210f299b8a7e4ea1be0a702095b19f6
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:55:12 2009 -0700

    liblwfsclient: Add fchmod API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 01a48790c4a0c9805eb55bfe1c60860ee91f48a1
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:54:58 2009 -0700

    liblwfsclient: Add closedir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit eb4d5f0074ab6430973188906a8083d26e24e790
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:54:42 2009 -0700

    liblwfsclient: Add opendir API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f6ebe58492095a5d7ceb5762cb35defca945ab45
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:54:27 2009 -0700

    liblwfsclient: Add chown API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e7d7a19d5733dfcea87467c5f96e1aaa812d5df8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:54:14 2009 -0700

    liblwfsclient: Add chmod API
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f887fd6f7c6a5b740ebbf220706ebc44a938d67e
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:54:00 2009 -0700

    liblwfsclient: Abstract away inode attr cache updates
    
    This commit creates a separate function that allows users of
    the inode attribute cache to update the cache when required.
    Major users are lookup, stat and fstat functions.
    
    The function libgf_update_iattr_cache(..) allows updating the lookup
    and stat caches separately using flags.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4c98eaf4c464e7e2f1c6ce66414fd7864f5c8bfa
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:53:51 2009 -0700

    liblwfsclient: Replace dict based inode ctx with array based one
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c71110fb153adfd4628718f634348b7a5712bf32
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:53:39 2009 -0700

    liblwfsclient: Fix fd_ctx leak on release cbks
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit adb677be13e6b755c3eeb685759d2522f6c466a7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:53:24 2009 -0700

    liblwfsclient: Replace dict-based fd ctx with array-based one
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 00968db3069e7b145f108d53a62d1899c9c1f3f9
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:53:12 2009 -0700

    liblwfsclient: Generalize [RW] checks on dirs
    
    This patch moves the read-write permission check on directory
    inode into libgf_client_opendir, so that when I am next adding support
    for the opendir syscall, I dont have to perform similar checks again,
    outside this function.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1873d0bdb53af0311e8ad344116c0923448a6ff5
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:52:54 2009 -0700

    liblwfsclient: Check for directory on O_CREAT
    
    If we have received an O_CREAT for a name where that basename is a
    directory, and if we have successfully looked up the inode for this directory,
    then we can check for S_ISDIR in liblwfsclient and prevent sending a message
    to the server through libgf_client_creat. See also the comment inline.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 79215d4f2487e6db87e5fd637f0262037c1d230b
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:52:43 2009 -0700

    liblwfsclient: Create and use LIBGF_REPLY_NOTIFY macro
    
    All reply notifications can now be abstracted away through
    this macro and all cbk functions should now call this.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ba4833355a1ee77f828b538a357e07c46f36b037
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:52:27 2009 -0700

    liblwfsclient: Fix segfault on non-NULL loc->name
    
    The gf_log message actually assumes that loc->name will have a valid
    non-NULL name in it, whereas if the loc_t being passed to it was
    actually created on a function stack, i.e. a local function variable
    and was then passed down the code path to do_path_resolve without ever
    initing it or zeroing the structure, its possible that the name member
    has a non-NULL but corrupted address. This leads to a segfault.
    Whereas, we know loc->path will always have the full path.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c1b3deff1186c581cb8d9893a3a0de6bf00d3adc
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:52:04 2009 -0700

    liblwfsclient: Use macros for argument checks
    
    Having those if {} blocks to check for argument
    validity hurts the eye so this patch replaces those checks
    with macros. One macro already exists in liblwfs. The second
    macro is introduced by this commit for liblwfsclient-specific
    check for paths.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b3e3fc79d4e7008a27d935decefcca51ba89dc17
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 16 23:51:45 2009 -0700

    liblwfsclient: Rename XLATOR_NAME define
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 41011cdb4c9f76a1805f0b908d1d7f77cef545b2
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Fri Apr 17 00:32:17 2009 +0530

    protocol/client - NULL check for loc->inode added in statfs(), before trying to retrieve remote inode number from loc->inode's context.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4c4021bea2d9f484321066518e10d2b139af2a3a
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu Apr 16 06:15:48 2009 -0700

    RPM spec file updates for RHEL,CentOS,Fedora,SLES and OpenSUSE for upcoming 2.0.0 stable release
    
    * Updates to ahere to RPM standards hugely driven by Fedora dist-f11.
    * RPM spec file portable across RHEL, Fedora, CentOS, SLES, OpenSUSE.
    * RPM spec build options made compact and removed unnecessary.
    * %changelog old entries removed as they were giving many warnings
      during rpmlint.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7ae141bb054494c86cfb60b377ab989c30938f66
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu Apr 16 17:32:05 2009 +0530

    add NULL check in iobuf_arena_destroy

commit 6bc3f3c19b9e720ade3702ce409a8a99cc13f1dc
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Apr 16 03:41:54 2009 -0700

    logging enhances to commit d77279ef04ca75ab9715864274567d1ce0ce66a6
    
    - logging made more relevent.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8a00ad080cbea0d01470c5f724d7d8ff54b0e254
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Apr 15 06:02:22 2009 -0700

    Use original pid when calling the FOP in afr transaction.
    
    Save the original pid while locking and restore it
    after the FOP is done. This ensures posix-locks can
    release locks (fcntl) properly.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 34f8f0b3e1f992cf59da2c2d410471e440e6ed92
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 15 03:11:21 2009 -0700

    write-behind aggregate-size related changes
    
    This patch brings in following changes:
       1. make aggregate-size as non-configurable and make it to be equal to
          maximum iobuf size.
       2. best effort to write data in chunks of length as close to aggregate-size
          as possible but not greater than aggregate-size, since aggregate-size is
          made equal to Maximum size of iobuf.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ffb863c3a8cbfb2105ac23ce5fc5be1df372458c
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Apr 15 03:12:17 2009 -0700

    write-behind: adhere to coding guidelines.
    
    - make sure lines are not greater than 80 characters in length
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e77eb62f253bc2288b1b4ff582f99ebf16a28c47
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Apr 16 14:38:02 2009 +0530

    cluster/distribute bug fix - try to create linkfile in dht_lookup_everywhere_cbk(), only if hashed subvolume can be determined, else error out with ENOENT.
    
    -- with local fixes (avati)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d1703344735d9c4df89b84310deaf1b9703f8c49
Author: Harshavardhana <harsha@sunway.com>
Date:   Wed Apr 15 01:00:01 2009 -0700

    Fixed the build problems observed
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e6c22c0587bbd9cb84969f5673db043c32e485ef
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Tue Apr 14 15:28:34 2009 +0530

    eliminate this_ino_get(), this_ino_set(). handle inode_ctx_{get,set}() at the fop level itself.
    
    they used to log ambiguously
    and was of no use. logging is now more precise and will help in debugging,
    in case of errors.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f7902b7072015c9c20f47e999af85c923f202d33
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 14 08:15:50 2009 -0700

    Changed xattr format of afr changelog to support adding and removing of subvolumes while keeping existing data.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d77279ef04ca75ab9715864274567d1ce0ce66a6
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Apr 14 02:53:09 2009 -0700

    server-helpers: Add check for NULL connection arguement being passed in helpers.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3baa437e9980e7dac9893d6c11ccc1623a5faee2
Author: Anand V. Avati <avati@lw.com>
Date:   Tue Apr 14 15:09:37 2009 +0530

    remove unused variable @ret in ib_verbs_options_init
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 54c40bbfb48e2f7469149d6724e2ac77bce0690a
Author: Anand V. Avati <avati@lw.com>
Date:   Tue Apr 14 14:51:26 2009 +0530

    use MAP_FAILED macro to free mem_base in arena_destroy
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1ce5acccf5186e70424826d4f22cee3a29ac114e
Author: Anand V. Avati <avati@lw.com>
Date:   Tue Apr 14 14:51:16 2009 +0530

    FREE arena->iobufs in iobuf_arena_destory
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8b32e03f87599bd3d87ec99c5718d40ff10831ff
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Tue Apr 14 14:20:04 2009 +0530

    cluster/unify link() should be sent to only one subvolume.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7a4bc3fbb352396b27489b0e97327d0fc82b85d5
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Apr 14 00:41:43 2009 -0700

    minor bug fix in posix_create() when 'o-direct enable' option is given.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 33e81bc94986929caab14a05231b25787a25a41b
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Apr 13 23:40:22 2009 -0700

    bug fixes in dht-disk-usage feature.
    
    fixes bugs seen with dht's disk usage.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d8bc2834d056a23f55bd86a5fd704bd81e35836d
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Apr 13 07:23:59 2009 -0700

    Send statbuf from the same subvolume, even across revalidates.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8e0d48cbb23cf056277ebc609d47b5184b95fa87
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Mon Apr 13 18:42:36 2009 +0530

    use ctx->page_size in all translators and transports instead of having their own configurations
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 451620e0ec88f717e7046ebb27fe1f29d73796d9
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Mon Apr 13 17:50:21 2009 +0530

    introduce page_size in lwfs_ctx_t to be used by all translators set it to 128KB in main()
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3093ff0b125c520fdac3db627af708f495c9a47e
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Mon Apr 13 15:41:01 2009 +0530

    client_readv_cbk - when op_ret is 0, iobuf comes NULL from transport, handles this case
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a0bb8a02cd334aeda02e6146ea541a7dae4223d5
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Apr 13 14:03:43 2009 +0530

    bug fix in iobuf_select_arena - call __iobuf_pool_add_arena (unlocked version)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3fb7252c5ec7edd8c9234d4fcc369fd10707a613
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Apr 13 14:03:35 2009 +0530

    bug fix - arena destruction now calls munmap and not FREE
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit dc9cdbdc1c03c231ba405e540fac7d6483159bb2
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Apr 13 14:03:28 2009 +0530

    add purge list support to make iobuf_pool_purge() in expensive, and actually call it in iobuf_put :-)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b9a210a419ff28f2d75b10a680520fd6cc37ac5a
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Apr 13 14:03:21 2009 +0530

    bug fix in iobuf_select_arena - never created a new arena
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 688db6452befde5d7cd2b35f86b770b4c19c53fc
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Apr 13 14:03:13 2009 +0530

    add @filled list in iobuf_pool to keep away filled list from getting searched in iobuf_select_arena
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4f0d487c96b84123289d3c48fd84188efe136293
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Apr 13 14:03:02 2009 +0530

    change arena size to 8MB
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 00dff3bddc375e88e710a751f47843f9da77a70c
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Apr 13 14:02:57 2009 +0530

    use MAP_FAILED macro to check for mmap failure instead of (void *) -1
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 014cdf385642947d0592102b2c7338a8ad1c2d4e
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Apr 13 14:02:47 2009 +0530

    fixed sizeof parameter in CALLOC of a new arena
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5dd850ae840ddb402ca4aaae19c668094947507e
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Apr 13 11:21:20 2009 +0530

    switch scheduler to validate the subvolume specified for a pattern, against the given subvolumes of cluster/unify.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ec06475f22db2a3683167c5ffbe236c8e4aaf0ab
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Apr 13 04:47:39 2009 +0530

    changes to database read interface, to make use of a given buffer instead of allocating internally.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 945f438d393297cf72a3157532625b6b02e87268
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Mon Apr 13 02:09:25 2009 +0530

    log formatting fixes. use GF_PRI_SIZET for size_t.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3f1e93c29856ec1e75327525899d1f0d6a81c0a3
Author: Amar Tumballi <amar@lw.com>
Date:   Sun Apr 12 04:16:09 2009 -0700

    minor initialization bug fix in quota's build_loc
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ecead44b5c8d1215e7c398ca1132a4b0b11a44bb
Author: Amar Tumballi <amar@lw.com>
Date:   Sun Apr 12 04:12:00 2009 -0700

    in dht, initialize the free available space properly, so the first few creates are not confused.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e00bdb4a323b60ced500df59071d2a940b976ae9
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 8 02:28:16 2009 -0700

    Coding Style: Add a few points
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4a62b5af1c9add4a74ea38ab9008bf129e2b4110
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Apr 10 00:34:34 2009 -0700

    feature to disable volumefile's checksum
    
    in server volume define, "option verify-volfile-checksum no" to disable
    the checksum feature.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit be9909606428d78ec23ea02900640c68ca2a40d2
Author: Anand V. Avati <avati@lw.com>
Date:   Fri Apr 10 09:22:18 2009 +0530

    reset errno to 0 before calling first fuse_lowlevel_new() to reliably detect for unsupported params
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fa9eb588fbe758cbc1ebe727d2455f1dcd0b065f
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri Apr 10 07:09:49 2009 -0700

    io-threads: Remove unnecessary call to pthread_attr_setstacksize
    
    We do not need to explicitly set the stack size to its default
    value.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4f81149489ae80b20ac28d1fdbe48ee56d0a181b
Author: Anand V. Avati <avati@lw.com>
Date:   Sat Apr 11 00:54:29 2009 +0530

    prefix ULL to large constants (to fix bdb build warning)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 45c4fb76dfd0756ebd86bf431f5b5761068901b5
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 23:32:24 2009 +0530

    updated lwfsd to create iobuf pool at initialization
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6d94a368e061afeeac6fb57c5910c71f60791dc3
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 23:22:26 2009 +0530

    updated liblwfsclient with IOBUF/IOBREFs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 77714c065d99767f5a3820bc1c62b22522681821
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 23:09:15 2009 +0530

    updated transport/ib-verbs to use IOBUF/IOBREFs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 07e8f887547c1b9fd71a3ca45b2c1ac974c939ad
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 23:00:59 2009 +0530

    updated transport/socket to use IOBUF/IOBREFs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 19cac9a1b3d7d4f5720049c4fb2b5e08b27d27e8
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 22:04:44 2009 +0530

    updated mount/fuse with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1650945f2379cc33eab1b21c033d42152fa2592f
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 21:53:57 2009 +0530

    updated encryption/rot-13 with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5617f5e3a3840b59263ede767c53f80088593c66
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 21:52:08 2009 +0530

    update features/quota with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 91e3976e99523908541932c02b2c4e9df28a9510
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 21:48:35 2009 +0530

    updated features/filter with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5d80832d2dc0127b8f380afd7d49ff7b27ac79ec
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 21:46:54 2009 +0530

    updated features/locks with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d7b12cdc8d2bcbf89530e00710da308bd757e35d
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 21:43:51 2009 +0530

    updated debug/error-gen with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit aed3aaef43589633f2a43d48435ef234582f37e0
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 21:42:45 2009 +0530

    updated debug/trace with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d720afb836ecd22c13859356261e85334422f119
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 21:40:19 2009 +0530

    updated performance/io-cache with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit be1d7c1e3b61477a82152a07a11993061e89b894
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 21:23:00 2009 +0530

    updated performance/io-threads with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 795fb95f42697796008e34790e0768929d478a3a
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 19:00:45 2009 +0530

    update performance/read-ahead with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c29b1710529fb52724ba37e09ca0f10cd7fcffa8
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 18:51:39 2009 +0530

    update performance/write-behind with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e062dd5c2f76106593829ebbb86003de966f00f2
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 18:43:35 2009 +0530

    update protocol/server with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ad86fba6e22b10b06aa44426c2ab3591c54ed0a7
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 18:15:11 2009 +0530

    updated protocol/client with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2e743ddc4a89f8a4d0c9ff0f16a6faf0218e453f
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 18:14:10 2009 +0530

    updated transport interface functions to accommodate IOBUF/IOBREF
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 0e9cda6d77a63723014bb2c040d8215fd7180a10
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 02:33:49 2009 +0530

    update storage/bdb with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6e641226df9a90a4d88c859d4bc1c27fdacc2037
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 02:17:25 2009 +0530

    update storage/posix with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fa5847401431f62013f1ef66363b5a0c1b29a0c5
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 02:02:52 2009 +0530

    update cluster/map with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 645c60e308de5290b9059eae557a320bd6a294d9
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 01:59:56 2009 +0530

    update cluster/ha with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 89cacef43e843c7563ed5d4ebb6ec16a3b81df3e
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 01:57:14 2009 +0530

    update cluster/dht with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f33f0669efd89216a528bab3694ac4645a7f523b
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 01:52:08 2009 +0530

    update cluster/afr with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e0e6acd6fbdcbd294c89e61cbe108fc1b96a62a8
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 01:39:34 2009 +0530

    update cluster/stripe with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f551e72584b3525d5a55c6fb4456d7b9ca5cb5f3
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 01:25:26 2009 +0530

    update cluster/unify with new readv writev prototypes
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c723c0dae5fd2887b714a08bcaeadb663e4de44b
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 01:21:57 2009 +0530

    do away with frame->root->{req,rsp}_refs members
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4554d82bbe2ecec6c79b6a791522358c8855408d
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 01:12:10 2009 +0530

    update prototype of writev and readv_cbk to use IOBREF in parameter (step towards elmination of frame->root->{req,rsp}_refs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3524572538e5abe839fa29fe94da8f7591cedce8
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Apr 11 00:09:08 2009 +0530

    IOBREF support for holding iobuf refs along with fops (replacement for frame->root->{req,rsp}_refs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e953968683d988c8fc3020ede2cb8e5229a548a6
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Apr 10 23:11:33 2009 +0530

    use 128Kbyte as the channel transfer size in fuse-bridge
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 124fb0c752530322e6311dde668422afef6b2afe
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Apr 3 15:17:04 2009 +0530

    IOBUF support (to be used by transports and fuse)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a31e26f8df26b1229e9fbca60ff8bf462b234241
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri Apr 10 04:22:37 2009 -0700

    io-threads: Reduce default min and max threads
    
    Going by the memory usage for each threads, it is prudent to
    have lower number of threads by default and let users who understand
    the memory consequences increase the thread count for themselves.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e1977a4e75637109889b581201e44e24506398c8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri Apr 10 04:21:53 2009 -0700

    io-threads: Use non-default thread stack size
    
    The default stack size on Linux is around 8 MiB for each
    thread. This is clearly too high for our purpose. This commit reduces
    the stack size down to 1 MiB.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit bf7b4623821c8ffe8070297949e18dc6e3757e9c
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Apr 9 07:59:21 2009 -0700

    posix_unlink: make unlinking in background configurable through volume spec file
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fb034ba3036fadc7cf35edc5cae7481149a67ca0
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Apr 9 03:54:51 2009 -0700

    Compulsorily do self heal if file sizes differ.
    
    If file sizes differ, then compulsorily do self-heal. If no 'wise'
    sources are found, then pick a 'fool' with the biggest file size.
    If even 'fools' aren't found, pick the 'innocent' source with the
    biggest file size.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit bfbcde78924fc5847b31ae56fe8d14ea52b60dfd
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Apr 9 03:53:59 2009 -0700

    Handle files which have no pending xattrs at all.
    
    If a pending xattr key is non-existent on a file (call such
    files 'ignorant'), make all other non-ignorant subvolumes point
    towards the ignorant one.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ec35b79f746d8a9451d7a3b9894025fdad7382f4
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Apr 9 03:53:26 2009 -0700

    Erase xattr during self-heal based on original dict.
    
    Decrement xattr during self-heal based on the original dict instead
    of pending_matrix, as the pending_matrix might have been
    altered later.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 445b57bf7207107a9ef078697b7d03bb9349747a
Author: Csaba Henk <csaba@sunway.com>
Date:   Tue Apr 7 02:14:20 2009 +0200

    niftify mount(8) output for lwfs mounts
    
    Originally, mount(8) shows a lwfs mount like this:
    
    lwfs on <mp> type fuse
    
    With this patch, mount(8) will show a lwfs mount like this:
    
    <volfile> on <mp> type fuse.lwfs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8123c907015e6ad6e2975ba77eadd4db32e08628
Author: Harshavardhana <harsha@sunway.com>
Date:   Tue Apr 7 00:43:23 2009 -0700

    Commit package making files for FreeBSD and Solaris platform.
    
    Commit for package making related files for FreeBSD and Solaris. These files
    are supposed to be in repository to not loose track and update them as needed.
    I will update them soon for upcoming release where we support Solaris on
    ib fabric also.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b976536e616e6dd23dd4a3981d150b168f9d2bef
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:43:31 2009 -0700

    liblwfsclient: Complete support for rmdir fop
    
    lwfs_rmdir code path wasnt implemented completely. Here is an
    attempt to complete it.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ca32040f350a7b8ad2e24ee68b417d6bec266038
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:42:14 2009 -0700

    liblwfsclient: Create new directory inode
    
    Make sure we give an allocated inode in the loc so that the underlying
    callbacks are able to fill it with the relevant information about the
    directory being created.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 364af2266e9cd9d1f4d88763e61a5b28d1336414
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:41:50 2009 -0700

    liblwfsclient: Return ENOENT on missing ancestor component
    
    If any of the path's components, except the basename, are missing
    from the dentry cache and the corresponding lookup from the server
    also fails, return an ENOENT.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 353f30ad17c9ace576df47abedf71054d8eb434e
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:40:12 2009 -0700

    liblwfsclient: Return EEXIST on lookup success in lwfs_mkdir
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 957ae7ba2ba7b8276dab963b7af7dbf16eeb5888
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:36:57 2009 -0700

    liblwfsclient: Perform explicit create
    
    We must create the file based on the O_CREATE in the flags
    instead of depending on the return status of the lookup.
    This works because we've already handled O_EXCL earlier and
    also handled a missing file(ENOENT)
    in case this was actually an open and not create.
    Adapted from Raghu's original patch.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d4ab91b1f254a21cac538fdffa7ff37db10ae83c
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:35:32 2009 -0700

    liblwfsclient: Handle O_CREAT on lookup failure
    
    On lookup failure, if O_CREAT is required, then we must:
    
    1. explicitly lookup the parent directory.
    2. create a new inode for the new file being opened.
    
    This special case is required for file creation because:
    1. We cannot depend on the previous lookup to have reliably looked up
    the parent inode.
    
    2. inode for the new file does not exist in the itable.
    
    Patch adapted from Raghu's original fix.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e8282fd242ba4061a40b992ebe4549b4dd23fa11
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:34:56 2009 -0700

    liblwfsclient: Dont depend on ENOENT
    
    Dont depend on the dentry and explicit lookup function, i.e.
    libgf_client_path_lookup(..), to return ENOENT on not
    finding a dentry. Just use op_ret = -1 as a lookup failure
    status.
    Patch adapted from Raghu's original fix.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ccbb9c7df1d887bc835a04e0f76799770ba3e2b8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:34:24 2009 -0700

    liblwfsclient: Remove spurious strcmp
    
    This strcmp existed because of assumptions that do
    not hold true since the change in liblwfsclient
    internals recently.
    
    This is another step in fixing the seg-fault on lwfs_create.
    Patch adapted from Raghu's original fix to the problem.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2524bf2e9cb89627833b1120eac0f78b279c1751
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:33:56 2009 -0700

    liblwfsclient: Resolve path on empty caches
    
    The earlier case was that the explicit lookups to the server
    were being sent only when the parent inode was NULL. This situation
    breaks when the parent inode is available in the i- or d-cache
    but the child dirent is not. In such a case, no explicit lookups
    were being sent to get the missing child dirent.
    
    Now, explicit path lookup happens even if the inode for parent or basename
    is not found in the caches.
    
    This also fixes a seg-fault occuring during lwfs_open, in my test
    case, but one that could occur almost anywhere lookup code is used.
    Patch adapted from Raghu's original patch.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 47f03734685076fce51eaacb706796d2213bdbf1
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Apr 7 05:32:47 2009 -0700

    liblwfsclient: Fix segfault in lwfs_open
    
    libgf_client_loc_fill gets passed a name=NULL argument.
    So when this function returns the filled loc argument, this loc
    is actually missing the inode structure that was to be filled.
    
    The segfault actually occurs a few lines later when
    we try to access fd->flags but fd returned by fd_create is NULL
    because we'd passed a NULL inode to it, i.e. the loc->inode.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 07fcdfebf25c30811a9313ac3d9a0fdbbceaad6c
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Wed Apr 8 04:24:22 2009 +0530

    introduction of secondary index database in storage/bdb
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit abf35ff6c7a2cc94d9e1e738fb76f711bd2abc16
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Wed Apr 8 04:24:00 2009 +0530

    link() & rename() on storage/bdb will always return EXDEV.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8fea700263bd356e6ecacd3dabc9a9c00043a804
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Wed Apr 8 04:23:30 2009 +0530

    storage/bdb untabify, code alignment to limit to 80 characters per line.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 34ae34826cce3233402bf36cd6f0174be06a83dc
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Apr 7 17:38:07 2009 -0700

    map translator cleanup.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4e90ca853b774f64c6adde73a62ed2649bda5eab
Author: Vikas Gorur <vikas@lw.com>
Date:   Wed Apr 8 02:30:18 2009 -0700

    Fix minor bug in afr_open_cbk.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 225e86b37492e5004eb51498b46471d74f30841d
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri Apr 3 02:06:52 2009 -0700

    io-threads: Refactor un-ordered worker exit path
    
    This is being done for the same reason as the
    previous refactoring for ordered threads.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fe1cedc1a960493337676885881018e4687c12a2
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Fri Apr 3 02:06:25 2009 -0700

    io-threads: Refactor ordered worker exit path
    
    This patch re-factors the exit path of an ordered worker
    on a time-out. Earlier we're checking for exit permission
    in such a way that required us to release and acquire
    the worker lock a second time in the worker loop opening
    a window wherein a new request could've been appended to the
    request queue.
    
    This patch makes the decision to exit while still holding on to the
    worker lock.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3acd56bec5afef9db673ae8d7dbe52bc7943b298
Author: Csaba Henk <csaba@sunway.com>
Date:   Mon Apr 6 21:25:12 2009 +0200

    add .gitignore
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5634986f594fe75d0cd2e69cadf002a2c701f366
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 7 06:55:43 2009 -0700

    Fix in changelog logic.
    
    If a writev fails, remember it by marking it in the fd context.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d46684117a02359886e096d1bcc9f590b54144a6
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 7 06:55:15 2009 -0700

    Consider a subvolume dead if an fop fails on it
    
    Transaction fops earlier called afr_transaction_child_died only
    if an fop failed due to ENOTCONN or EBADFD. Now they consider a child
    dead regardless of the reason for failure. This handles cases such
    as ENOSPC.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d71e72248096d12ce2a8ca7ccb36ef97ae486583
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Apr 7 03:27:24 2009 -0700

    Add lock-less versions of fd_ctx_*
    
    Added __fd_ctx_get
          __fd_ctx_set
          __fd_ctx_del which do not hold any lock.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 27996c714f7fd6a7686f2d4a3552efbc1e54c2c7
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Apr 6 10:27:45 2009 -0700

    Enabling booster after port to work with changed liblwfsclient interface.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2d59bde99600ecb15b7ebba9cd0283925c9f20f4
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Apr 6 10:56:52 2009 -0700

    fix to fd leak in posix_create() in case of some failures.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c7962678224374fa295d4063c2f5387c7280536e
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Apr 2 19:45:04 2009 -0700

    nufa to take care of free disk-space while creating files.
    
    nufa gets awareness about the available free-disk-space in subvolumes.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 258fec70ba2cc588f500f3e3bc16c99af212b4c9
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Apr 6 05:21:29 2009 -0700

    Fix in return value of afr_sh_mark_sources
    
    afr_sh_mark_sources now returns:
      -1   if two wise subvols conflict (split-brain)
       0   if all subvols are innocent (no self-heal needed)
      >0   if sources found
    
    Also, changes to callers of afr_sh_mark_sources to handle return
    value properly.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6b18487d2811b4fb004d0f4c5c98a101a93b35ed
Author: Csaba Henk <csaba@sunway.com>
Date:   Mon Apr 6 14:03:21 2009 +0200

    bitrot-13 fix
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7a543c3b45139adce1189785200ad23b2ec867d2
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Apr 6 04:00:59 2009 -0700

    Fix an incorrect type-cast in liblwfsclient.c
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 258da6cd992c279469f2288f8a3cd41be69d43c2
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 6 00:37:54 2009 -0700

    io-threads: Cleaner stub destruction
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 45dab1eefd85e38570c2c3ccfac0061245f70e74
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Apr 6 00:25:51 2009 -0700

    io-threads: Sanity check worker thread idx
    
    This patch adds sanity check for the ordered worker thread index
    returned from the inode's context. If the index is corrupted we
    STACK_UNWIND with ECANCELED.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fed1aa318dcf939326b955a8fcc2da2b1535acb9
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Apr 3 22:13:53 2009 +0530

    disabling booster

commit 8a5005ecf06f23f1607c0ff4111a21c00bd74205
Author: Amar Tumballi <amar@lw.com>
Date:   Fri Apr 3 08:27:44 2009 -0700

    distribute to take care of available disk space while creating new dirs, and files.
    
    distribute gets awareness about disk-space while creating the files
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f235826215205ac626abb0ad475e7a89f7003da5
Author: Rommer <rommer@active.by>
Date:   Wed Mar 18 14:32:50 2009 +0200

    fix broken transport-type unix
    
    fix broken transport-type "unix"
    however unix transport not working with defined transport.socket.bind-path
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7a52d4ba1f1f8b68ecd79b4d5409f3b930b4efd4
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Mar 30 07:25:32 2009 -0700

    liblwfsclient - reimplement lwfs_fgetxattr and lwfs_fsetxattr
    
    - lwfs_fgetxattr and lwfs_fsetxattr earlier used lookup and setxattr
        fops for implementation. Change it to use fgetxattr and fsetxattr fops
        instead.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 475a5909f3f80a1fc91630ea22bec228bfdc676b
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Mar 30 07:20:35 2009 -0700

    liblwfsclient - fix bug in __do_path_resolve
    
    - add argument lookup_basename to __do_path_resolve which indicates whether to
        lookup basename(path). This is necessary for apis like lwfs_get, which
        dont want basename(path) to be looked up by libgf_client_lookup_path.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 65bd768543c4de3d2ffd8d17efbd79e1e03666a4
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Mar 30 06:33:06 2009 -0700

    liblwfsclient - move lookup timeout related code to libgf_client_path_lookup
    
    - this simplifies the resolution of path to inode, the apis which receive
         path as argument just need to call libgf_client_path_lookup for
         path->inode translation.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ab534d54e4e2e1eb921c7a3c98d44137471c7ac5
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Mar 30 04:21:59 2009 -0700

    liblwfsclient - fix indentation
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e60d2194840b78034db1ad5c8b385a691ab3ddb6
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Mar 30 03:57:20 2009 -0700

    liblwfsclient - change implementation of lwfs_get
    
    - remove redundent lookups happening in lwfs_get.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8b8448799cc43f20f5812bf5629c8670f76f78d3
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Mar 25 23:22:55 2009 -0700

    mod_lwfs/lighttpd/1.4 port and memory leak fixes
    
    - port owing to changes in interface of liblwfsclient.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 38be3fda5ce27352c45475fc4de442806cbddd36
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Mar 25 23:22:28 2009 -0700

    mod_lwfs/apache/1.3 port
    
    - port owing to changes in interface of liblwfsclient.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e600abcb96979f80a0a20074347e8efc6cae880d
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Mar 25 23:22:03 2009 -0700

    mod_lwfs/apache/2.2 port
    
    - port owing to changes in interface of liblwfsclient.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cf6f21928dbe3489de5dfdc3513f3be5f5ef529d
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Mar 25 06:52:05 2009 -0700

    liblwfsclient code changes
    
    - add dentry support to liblwfsclient.
      - changes related to using array, to store context in inode instead of
        dictionary.
      - code changes related to cleanup of liblwfsclient interface.
      - added lwfs_mkdir and lwfs_rmdir
      - other changes in liblwfsclient to make it work with code changes
        in other parts of lwfs.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6eb419f1ca68f536a700e63c1521e428560a0d9d
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Fri Apr 3 06:30:54 2009 -0700

    server-protocol - reimplement connection cleanup to happen in 2 phases
    
    - first phase, which happens when POLLERR is received on transport,
         releases all locks, flushes all open fds.
       - second phase, which happens when both the transports of connection destroyed,
         destroys the containers like lock table, fd table along with the connection.
       - the first phase, clears up any references to transport held by translators
         like posix-locks(in the form of blocked locks) paving way for the second phase.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d3d7245970189629937f6330a6d946f5fbb454af
Author: Vikas Gorur <vikas@lw.com>
Date:   Fri Apr 3 05:34:10 2009 -0700

    Made afr inode context a 64-bit packed value instead of a structure.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 75c70231fe7e13a68239dac889568d243a79a75e
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Apr 2 08:31:23 2009 -0700

    Load balance read operations among subvolumes in afr
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1e7c9fa93716844e60d41811b8b79f8605a5044c
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Apr 2 08:30:32 2009 -0700

    Defined afr_inode_ctx_t structure.
    
    Notification of a split-brain situation, which was earlier signalled
    by the mere presence of inode context is now signalled by
    the 'split_brain' member in the structure.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9f2ef60274dae8b302d691ba8d266cd76dcd7c4b
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 14:01:05 2009 -0700

    io-threads: Support autoscaling volfile options
    
    This commit finally makes the autoscaling feature visible to the user.
    Know that we're now using two separate thread-pools, one for data
    requests, called ordered thread-pool in io-threads, and the other
    for meta-data requests, called un-ordered thread-pool.
    We do not expose this information to the user to keep io-threads
    simple. Consequently, when the user specifies a min-threads and
    max-threads value, the number of threads assigned to each pool
    is equal, i.e. both pools start with their min threads set to half of
    the option "min-threads" and both scale up their threads at most up to
    half of option "max-threads".
    
    Volfile options will be added to the wiki and user-guide.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b1bbd77f16a13f8109d1e2e1b4ed869db1e86645
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 14:00:36 2009 -0700

    io-threads: Cleanup request queueing,thread firing
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ae53812b2ccfd7842fa6430081465ed90f18814b
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 14:00:06 2009 -0700

    io-threads: Allow scaling to be switched off
    
    The default is also to provide no scaling. For both, ordered and
    unordered request pools, when scaling is off, we maintain atleast the
    minimum number of threads specified in the volfile.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b64fa35870b54b8d9e62afd71c92e35b1f7a4cfd
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:59:43 2009 -0700

    io-threads: Add ordered threadpool state and code
    
    Now we have the remaining fops going through the ordered
    thread-pool.
    
    To route a request through ordered thread, we use
    iot_schedule_ordered(..) and the worker thread for
    ordered requests is iot_worker_ordered(..)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ee79908d3b577c061b497e35481b8d1523502077
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:59:24 2009 -0700

    io-threads: Add un-ordered thread-pool.
    
    This commit adds everything needed to:
    
    a. Get un-ordered request going through the un-ordered
    thread-pool. This happens through, the
    iot_schedule_unordered(..). The unordered thread-pool
    consists of thread running the iot_worker_unordered(..)
    function.
    
    b. Make threads in the un-ordered thread pool start-up
    and exit depending on the thread state.
    
    Note that at this point the requests that need
    ordering are still going through iot_schedule(..).
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e27f7f344e12d0885a48fcca8dfce36440f5e9e8
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:58:49 2009 -0700

    io-threads: Classify requests for threadpool type
    
    New io-threads will serve requests through two separate
    threadpools.
    
    One thread pool for requests that must be ordered
    on a file that is open. so that the server can process the requests
    in the order they were entered in the requests queue, and not in the order
    the io-thread is able to send a request, which in turn is determined
    by how the thread gets scheduled. This can also be called the
    data-intensive ops thread pool.
    
    Second thread-pool for requests that dont care about ordering, i.e.
    requests like lookup, open, create, mkdir, etc.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 42df79e2ad14053f38a12f30b29b81dd897921c9
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:58:30 2009 -0700

    io-threads: Wire in support for rename fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 369476e93e4ab99234602a5bbe2070d734b45567
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:58:11 2009 -0700

    io-threads: Wire in support for symlink fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6afeb9dd1bb9f329b5b0508d49c2e5142c6fc8cc
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:57:51 2009 -0700

    io-threads: Wire in support for rmdir fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 21363da2935615b5574cce597c95a8a7b0503766
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:57:34 2009 -0700

    io-threads: Wire in support for mkdir fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cbf8858a230b91174dc6134e4729a047db6ff914
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:57:18 2009 -0700

    io-threads: Wire in support for mknod fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ef73c3de6097c6114b5492d5972c257b849e10b7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:56:50 2009 -0700

    io-threads: Wire in support for readlink fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d767455020f9730793230a14cd9e795194c5257f
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:56:27 2009 -0700

    io-threads: Wire in support for access fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit eab231f3596aa4b6ad2b9b8f3d1a4cc97bda76bc
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:56:04 2009 -0700

    io-threads: Wire in support for fchown fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3ca0a7859f6f8f7ebc6ac32b6f17035f2115d2a0
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:55:44 2009 -0700

    io-threads: Wire in support for chown
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d56683ccfa1b53c42717ff36490066cff25fd7d0
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:55:19 2009 -0700

    io-threads: Wire in support for fchmod fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f05ca55ef77fb2004b0f573aa267c92405166d9c
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:54:52 2009 -0700

    io-threads: Wire in support for chmod fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit dffa5a92c70732e790b6c789e2aacb7f8c5c34cc
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Wed Apr 1 13:54:33 2009 -0700

    io-threads: Wire in support for lookup fop
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b91e83aa0d3891b4cd725b6044131096405dfba8
Author: Anand V. Avati <avati@lw.com>
Date:   Thu Apr 2 16:37:37 2009 +0530

    wb_flush - keep reference on fd for process_frame to perform STACK_WIND of flush.
    
    This patch fixes bug report by Greg <greg@easyflirt.com> on lw-users@ with subject 'lwfsd crash'
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f2cdc5d10c56ef8010ab83acf31b3fb6c4c2fd1f
Author: Anand V. Avati <avati@lw.com>
Date:   Thu Apr 2 16:49:37 2009 +0530

    change char to int in execute_cmd (based on comment on #26006 from Giorgio Marinelli <gio@reversiva.net>
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1e9b5a5a35e8d53e631788443dadf1fe30853743
Author: Bharat Shetty Barkur <bharat.shetty@gmail.com>
Date:   Thu Apr 2 01:41:55 2009 -0400

    Changed few lines to ensure Optimization (lesser code).
    
    Changed few lines to ensure lesser code optimization while checking the EOF for the file pointed to by specfp.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit aa0fd06dad70a7ecfc3dab819e9b3fab8baad2a9
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu Apr 2 02:49:42 2009 -0700

    Build fixes for ib-verbs compilation on solaris
    
    Build fixes for solaris on ib-verbs with recent OFUV Update 3 release.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 63115897fe77e584552624c88f84eaeac55d9b57
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Apr 2 04:05:50 2009 -0700

    unify-self-heal: Fix un-ref'ing of incorrect dict
    
    dict_unref'ing of the dict in local
    results in a crash due to de-referencing a NULL spinlock.
    That is because after a STACK_UNWIND(..), we cannot expect
    the frame->local to be allocated still.
    
    Fix by using the other available reference to local->dict.
    
    Ref: https://savannah.nongnu.org/bugs/?26058
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 26af4e1229106e3d4d311fcfa1646f1ce9f3f271
Author: Vikas Gorur <vikas@lw.com>
Date:   Thu Apr 2 03:39:24 2009 -0700

    Print log message when AFR receives CHILD_UP/DOWN notification
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 522b2bdb540bef4911e0874030d1f9b3003ba104
Author: Anand V. Avati <avati@lw.com>
Date:   Thu Apr 2 15:51:34 2009 +0530

    socket_connect() - if socket is already created, do not fail transport_connect() -- causes spurious CHILD_DOWN events to be sent up when reconnect() thread misinterprets the failure of transport_connect() to be an actual teardown of the transport
    
    the spurious CHILD_DOWN events cause self-heal in replicate to not heal files in that subvolume, writev to not modify that subvolume etc, accounting for a lot of discrepencies in replicate which are being in the mailing lists recently.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3acfb275879fb8392f8cb4ea2a58766afbc42baa
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu Apr 2 02:50:33 2009 -0700

    Fixes server goes into infinite loop on Solaris when poll_err is not set.
    
    Server goes into infinite loop when poll_err is not set.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cda677a98d039de6381887422d0b482ed412daaf
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Apr 2 06:09:56 2009 +0530

    mount/fuse to silently send fresh lookup for ESTALEd revalidates. log only in DEBUG level.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8e621bdfff915f40d67ed5b2d17914226c601108
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Apr 2 06:09:26 2009 +0530

    cluster/stripe to propogate ESTALE to parent.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2b63980c5da5e82c1a80fe91115fb8d8af201755
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Apr 2 06:08:57 2009 +0530

    cluster/unify propogates ESTALE to parent translator, if any subvolume returns ESTALE during revalidate.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 60615a0a78ab8bc93dd027c1338c588c4f3d49a7
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Apr 2 06:08:17 2009 +0530

    cluster/replicate should propogate the ESTALE error to parent, when at least one subvolume returns ESTALE.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 705c7c9bacafc22b714ac15e3925cb5eaeb45b0a
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Apr 2 06:07:25 2009 +0530

    cluster/{dht,nufa} propogate ESTALE (when at least one subvolume returns ESTALE for revalidate) to parent translator.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e8cce0bed6e5e6bd926ee465c5ec7a00b0b37793
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Apr 2 06:07:04 2009 +0530

    cluster/{nufa,dht} fail revalidates with ESTALE, in case a stale layout is found in inode->ctx.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 905b9fd38a3da787de3f30d1cbdd5e85d56e2f81
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu Apr 2 01:10:03 2009 +0530

    Review comment from Krishna was missed out in previous commit of fix for sending first_lookup in 2nd call

commit 25d415e1917df1cac363142fb6fd3768f3e7d2af
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Apr 1 21:54:43 2009 +0530

    use (fgetc() != EOF) instaed of feof() in parser
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 978174fd7362b6c425db78c8d316b96050603844
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Mar 30 23:36:41 2009 -0700

    Bug fix in posix-init(), when span-devices is set above 1
    
    removed the extra '!' in if statement, which was a typo earlier.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 39d67cbf8921db55e7205a94bce5c6d154a3a3d5
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Mar 31 15:49:57 2009 -0700

    fix a segfault with io-threads when iot-schedule is called with NULL inode
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit db365c30d07f5faae4197e37148f64e75b54a7ec
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Mar 31 10:56:10 2009 -0700

    Enable lwfs client to exit after a configured number of failed connects \ while fetching volume specification file from server
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit aa63a122433d51e89148af27dab98cf68846dab4
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Mar 31 11:18:55 2009 -0700

    Avoid infinite loop while parsing volume specification files on Linux/ARM.
    
    - patch submitted by anonymous user (ref: bug #26006 on savannah).
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 96b687b9b8d58fc70dfaaed42dbe1b35799117f8
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Mar 31 06:22:16 2009 -0700

    Add new type of option type INTERNET_ADDRESS for validation
    
    - used to validate options like remote-host, bind-address.
      - Also validate options of translators created during fetch of volume
        specification file from remote server.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c8ddd2588ae7d9890b2d30fd1dadc6f9b054d7f4
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Tue Mar 31 12:25:58 2009 +0530

    log message changes in mount/fuse for SETLK, GETLK, GETXATTR, SETXATTR fops
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9922b37658d7d996321382c5157bf33bbbb1330d
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Mar 30 21:14:45 2009 -0700

    Add support for log-level NORMAL in fuse mount helper script.
    
    - patch submitted by John Feuerstein <john@feurix.com>.
      - copying changes in the patch verbatim to
        xlators/mount/fuse/utils/mount.lwfs.in and
        xlators/mount/fuse/utils/mount_lwfs.in
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a0c1de7c9cf41d37f95660fe45da66418e263340
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Mar 28 14:17:55 2009 +0530

    first call of fuse is INIT internal call, and not first system call. 2nd call is the system call where first_lookup() has to be done.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3276e650f8af676ed602279f4be85d053aa6065d
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sat Mar 28 00:32:34 2009 +0530

    memory leak (of header) when frame is attempted to be xfer'ed when transport is disconnected
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3baa99ebef316c6a9947c17c6d0c4bca863a8c82
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Mar 27 22:11:31 2009 +0530

    ping-pong timer: - share last_sent and last_received between channels so that any activity ensures the remote host being alive (useful under heavy loads) - timer expiry disconnects both transports
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6c28cb81b2a326a416968932919ea9d19f3b56ab
Author: Anand V. Avati <avati@lw.com>
Date:   Thu Mar 26 17:29:52 2009 +0530

    fix duplicate setting of values in inode->ctx and fd->ctx
    
    this patch avoids setting of duplicate key/value pairs in the context.
    note that consumers have to explicitly check for previous existance of key
    to avoid any kind of resource leak resulting from this overwrite.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 675e8b4a1f07668a6145c16283b68daa165a7a0c
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Mar 26 08:47:13 2009 -0700

    liblwfsclient: Fix NULL argument bug
    
    inode_ctx_get was being passed a xlator_t type
    that was initialized to NULL resulting in a
    EINVAL return from lwfs_fstat.
    
    Reported on lw-devel
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a59582c3faed3efcf713caeb990ea5c35479dd8d
Author: Anand V. Avati <avati@lw.com>
Date:   Thu Mar 26 16:26:21 2009 +0530

    posix_unlink - open/unlink/close only regular files
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 36e39bf9cb4b7c712ef411d60203bf05af7e129f
Author: Anand V. Avati <avati@lw.com>
Date:   Wed Mar 25 18:08:43 2009 +0530

    Enhancements to distribute selfheal
    
    - create missing directories instead of creating linkfiles when
      entry missing  on hashed subvol
    
    - detect cases where there are dirs and linkfiles for a name and
      make them all dirs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a2d44f8cd32988ad52ad924b61a2ef5fc41e4b0e
Author: Csaba Henk <csaba@sunway.com>
Date:   Wed Mar 25 02:19:14 2009 +0100

    make the location of the mount utility tunable at configure time
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ec5a5fa20823aed3127bdbea4e754ef308d81d89
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Mar 23 05:16:16 2009 -0700

    Fixed typo in warning string in afr.c
    
    Fixed typo.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3df266c278ab74c6bf1980bd17a545595bd04344
Author: Bharat Shetty Barkur <bharat.shetty@gmail.com>
Date:   Sun Mar 22 13:57:37 2009 -0400

    Changed the gf_log warning for return of null via CALLOC from 'old' to 'newdata'
    
    Fixed the warning message to be more clearer for return of the null by CALLOC, by changing old to newdata.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 4e5c297d7c3480d0d3ab1c0c2a184c6a4fb801ef
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Mar 24 03:46:08 2009 -0700

    fix to rm of large file blocking other operations on the same directory containing file (ref: rt #779)
    
    posix_unlink follows the below procedure to avoid client noticing delay during
    unlink of large file
    1. open file
    2. unlink file
    3. stack_unwind
    4. close file
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6e8017479fd9997ae47e7c8cbb74247d7e2b4fd0
Author: Vikas Gorur <vikas@lw.com>
Date:   Tue Mar 24 05:44:59 2009 -0700

    Made self heal logic more precise.
    
    Discard earlier patch sent for the same error. This patch fixes
    it more comprehensively.
    
    This solves the spurious split-brain seen by many users.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8f590ad883c170827cc06dcbcb17e5aaa1788996
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Mon Mar 23 23:45:53 2009 -0700

    dht memory leak fix
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 270621b34af7528755373e04b07f959c8dca274b
Author: Amar Tumballi <amar@lw.com>
Date:   Sat Mar 21 19:04:15 2009 -0700

    fixes crash in write-behind
    
    in wb_flush, there was a chance that wb_process_queue()
    was called with NULL frame, which causes crash.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 617fa2504283b63dde7f27186648ef9a9f060f52
Author: Amar Tumballi <amar@del.lw.com>
Date:   Fri Mar 20 12:50:51 2009 -0700

    when the both channels in client protocol is disconnected, fd's are marked as bad
    
    patch solves the problem of fds being valid even in the case of server
    disconnection, which causes operations on wrong fd when server comes back up.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cf15c8ab0fab3ad9e37cab544ccbbccd59ab03db
Author: Amar Tumballi <amar@del.lw.com>
Date:   Fri Mar 20 12:49:12 2009 -0700

    fixes issue of hashing to wrong subvolumes in case when a subvolume is down
    
    When a hashed subvolume is down, variable 'subvol' was NULL, but was sent to itransform.
    This patch solves this, and readdir is sent to proper subvolume now.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c20359b5b2a564e83b5830b9a17013e780096e2d
Author: Amar Tumballi <amar@lw.com>
Date:   Wed Mar 18 18:31:30 2009 -0700

    fixed sys_<fops> related warnings. (on mac os x and opensolaris)
    
    The fix in posix will fix 'unresolved' symbol errors in Mac/Solaris/FreeBSD
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 103d82700483bf744f86719e97846b065ca3394c
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Wed Mar 18 17:10:51 2009 +0530

    dht_layout_dir_cmp - if xattr is missing, it is an error only if cached layout has entry for that subvolume.

commit b9fef00edbe7272d31be0ca22f3b2794918300e0
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Tue Mar 17 21:59:30 2009 -0700

    Add return after STACK_UNWIND
    
    We must add a 'return' after a STACK_UNWIND due to a stub creation
    failure, because if we dont, we'll end up adding a NULL stub to the
    worker thread request queue.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2d7f44e39792c71e4f7bb768acffc2f5a76c80e0
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Mar 17 19:05:43 2009 -0700

    Moving few translators which are not well tested, are in beta stage to 'testing/' directory.
    
    This way, users will be aware which are in 'beta' stage, and we can keep on
    adding new translators (if any) seemlessly to stable codebase and once tested
    can move them to proper places.
    
    To use these translators, everyone will have to prefix 'testing/' to existing
    type of translator (in volumefile)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b947dc7161427b8c84f47b0a97861a36557f5748
Author: Amar Tumballi <amar@del.lw.com>
Date:   Tue Mar 17 18:15:19 2009 -0700

    ib-verbs recv-size and send-size argument takes SIZET arguments now.
    
    With this patch, to specify recv-size and send-size of ib-verbs to <n>KB, we need not give
    the option as integer value of 'n * 1024' value. This is neater to do deployments.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 0a7f4cfc1c516da573949a9521248744ce97c4e9
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Mar 17 16:08:10 2009 -0700

    afr data self heal bug fix
    
    fixes the issue of corrupting self-healed copy in AFR
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ac8fe9901b3215c27ef8bc0971bf2bd140bbfcd5
Merge: 8e0453e 1601bb6
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Mar 17 22:38:26 2009 +0530

    Merge branch 'master' of ssh://avati@git.sv.gnu.org/srv/git/lw

commit 8e0453e615255a5f64777a68d873a6f46262b5b3
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Mar 16 07:05:33 2009 -0700

    IO-threads Cleanup: Remove useless data structures.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit babf82427ce19aee091259b25613c426c696c330
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Mar 16 07:04:21 2009 -0700

    IO-threads Cleanup: Clean-up request scheduling and queueing interface.
    
    This patch does two things:
    
    1. Cleans up the request scheduling and queueing interface so that all
    fops only need to call iot_schedule and not iot_queue and in some
    cases iot_schedule.
    
    2. Till now, we've had open and create calls go through the main
    lwfsd thread when sending open and create fops. This patch makes
    them also go through the worker threads. But since the open and
    creates requests would not be called with a valid inode number in the
    loc_t, these requests will get assigned to the worker at index 0.
    This will be fixed RSN, when we introduce various techniques of
    distributing the inodes(..not requests..) over the worker threads.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8e3e0e776cc04ad9f840383c4693ee73adc79558
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Mar 16 07:03:02 2009 -0700

    IO-threads Cleanup: Change workers list to dynamically allocated array
    
    Worker threads were represented as a list in iot_conf_t
    which made us traverse the list of workers in order to
    decide which thread gets the request. Now we represent the
    workers as a dynamically allocated array so that we can just index
    into the array to schedule the file.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3a83fdc459a620d5ce0360bcf5fa071118d5430f
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Mar 16 07:01:33 2009 -0700

    IO-threads Cleanup: Change request queue into a struct list_head
    
    This patch changes the per-thread request queue from a custom circular
    linked list, into the standard list.h list which is easier to
    understand and has a cleaner interface.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3099d29e8e65554af31927c8f767b9b6103ca58e
Author: Vikas Gorur <vikas@lw.com>
Date:   Mon Mar 16 04:03:55 2009 -0700

    Add system call abstraction layer
    
    - syscall.c provides platform-independent system calls
    - previous code for this from compat.c removed
    - posix xlator uses new functions from syscall.c
    - solaris_flistxattr added to compat.c
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7d61f9d69309ccb0f9aa787caacfef77bc4e32d2
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Mar 12 04:41:23 2009 -0700

    write behind preserves order of fops with respect to writes
    
    - the execution order of fops like read, stat, fsync, truncate etc whose results
     are affected by writes, are preserved.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 473d02d1698259b4a0a6c22fdf70071e69c6e987
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Fri Mar 13 01:12:20 2009 +0530

    implement forget for cluster/unify
    
    inode_ctx_put() would set a list allocated on heap and would not be free()ed anywhere.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 215a91c4729bff06899375c02ae1568f24d683a9
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Mar 12 20:29:56 2009 +0530

    unify revalidate should propogate the error from any of the subvolume upto the parent, so that parent sends a fresh lookup.
    
    unify revalidate fails if one of the subvolume returns error.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1601bb69f48b79572789c67d12753fcaa0bd2f24
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Mar 12 04:41:23 2009 -0700

    write behind preserves order of fops with respect to writes
    
    - the execution order of fops like read, stat, fsync, truncate etc whose results
     are affected by writes, are preserved.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7af8d8edbd8554235348e0f54348edf222c0b46e
Author: Vikas Gorur <vikas@sunway.com>
Date:   Thu Mar 12 16:21:51 2009 +0530

    Add extra 'volume' parameter to inodelk/entrylk calls
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 31c817836c9c56eca1441b3b6f8b83db41c67f94
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Wed Mar 11 18:57:17 2009 +0530

    xlator.c option validation should check for empty valid options list (for strings).
    
    'if (!opt->value)' always fails as 'value' member is an array of size ZR_OPTION_MAX_ARRAY_SIZE and is always non-null. it should have been 'if (opt->value[0] == NULL)' instead.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b1c6a8507d59d16f9691652703be48f4539ca093
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Mar 9 22:37:57 2009 -0700

    feature to span the export directory across different mountpoints
    
    This feature enables exported directory containing different mountpoints.
    With, 'option span-devices <n>' where n is number of different mountpoints
    export directories can have, one can enable this feature. By default the
    number will be 1, and the inode scaling won't come into picture.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3b45b4c922a5f5835afa4e9211d64da2c6868633
Author: Krishna Srinivas <krishna@sunway.com>
Date:   Tue Mar 10 00:00:58 2009 -0700

    ping timer will not timeout if we recently got POLLOUT on the socket i.e if ((cur - (sent|received)) < timeout)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6a70225b69e7c617cb0ff62124b2687a7027c64a
Author: Bharat Shetty Barkur <bharat.shetty@gmail.com>
Date:   Sun Mar 8 12:54:25 2009 -0400

    Fixed two more occurrences of poll_out variables used for logging.
    
    Changed the poll_in variable to poll_out variable at two more places in the code.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d4adb2b0f5e7cd8e91d384f3f9047deab2464647
Author: Harshavardhana <harsha@sunway.com>
Date:   Mon Mar 9 10:31:53 2009 -0700

    removed word "tla" from last of the remaining files
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 2323b92d9b7b679c84cab64697fc715434e28ac9
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Mar 10 00:27:52 2009 +0530

    failover to any active transport when requested channel is not connected
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ae378b63c0ae93d8077d250de6a035b92bac8697
Author: Harshavardhana <harsha@sunway.com>
Date:   Mon Mar 9 03:19:31 2009 -0700

    Fixed build problems for init script installation.
    
    Fixed build problem for init scripts (Reported by Krishna and Vikas).
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fdfdd7cf05b7378c879917acb9129d69a407aee9
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Mar 9 16:16:02 2009 +0530

    dht_readdir_cbk - retry on same subvol if no entries match the hash
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5e4e99f4c1aa09b9e323c6fd23fcc3517447a6d7
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Thu Mar 5 07:55:43 2009 -0800

    changing the conversion specifier from 'd' to 'o' while printing st_mode
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 0991858fca6dc93de685e9527fb9ff47d77f616f
Author: Vikas Gorur <vikas@sunway.com>
Date:   Tue Mar 3 16:00:58 2009 +0530

    added fgetxattr and fsetxattr FOPs
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d092dff9a6e23d5fdef64154b6f3d6211f7482a6
Author: Vikas Gorur <vikas@sunway.com>
Date:   Thu Mar 5 17:05:35 2009 +0530

    fixed deadlock in io-cache
    
    ioc_create_cbk was holding inode->lock and calling inode_ctx_put,
    which also holds the same lock.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit cb602a1d7d41587c24379cb2636961ab91446f86
Author: Krishna Srinivas <krishna@sunway.com>
Date:   Tue Mar 3 02:54:20 2009 -0800

    Changed the default transport-timeout to 600
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit eab182e8a8b2f9a89147334f39e51db60aafa953
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu Mar 5 02:04:28 2009 +0530

    disable building of user-guide
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 762b1f9aefe07971178e584e288833bf142f402b
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Mar 4 04:00:24 2009 -0800

    code changes in the usage of inode_ctx_get and inode_ctx_put after their implementation is changed to hold inode->lock.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c8340e70f881dbb95d5238e588a7e985f6f04816
Author: Amar Tumballi <amar@lw.com>
Date:   Tue Mar 3 20:13:45 2009 -0800

    Change to fix the build problems with bison 1.28 (in RHEL 4.6)
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1b51e542b9aa7996e2753a7686c7743ffc8ecefd
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Tue Mar 3 20:10:47 2009 +0530

    inode_ctx_t locks added
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 5ed5ea9bffe018512edc6babff18fd4d44bcdd70
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Mar 2 15:47:37 2009 -0800

    create fuse thread after setvolume cbk happens, not only in case of success
    
    This patch fixes the 'hang' effect when client protocol fails to authenticate
    to servers (it may be problem with volume file, or server process would have
    not started yet).
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 130ae0dee7f1ed1292c32df52276833a9fa187b2
Author: Amar Tumballi <amar@lw.com>
Date:   Mon Mar 2 09:16:45 2009 -0800

    changes in patchset and repo version
    
    noticed that if anyone pulls from git repo, the version says 'tla' and
    patchset also shows tla's patch.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit da71d1359c1335997595935dbaa07c5747231861
Author: Harshavardhana <harsha@sunway.com>
Date:   Sun Mar 1 05:35:18 2009 -0800

    Added proper handling for the init scripts for (Debian, Ubuntu, SuSE, Redhat), SuSE init script also added.
    
    * Init scripts added for Debian, Redhat, SuSE distribution, each are installed
      by checking each distribution specific.
    
    Tested on
    1. Debian, Ubuntu.
    2. Redhat, CentOS.
    3. OpenSUSE.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b29a555c0be1c0db47c290d61f8c4dfe1e6fecbf
Author: Harshavardhana <harsha@sunway.com>
Date:   Fri Feb 27 05:03:50 2009 -0800

    now user-guide.info is built only when "makeinfo" found
    
    user-guide info is built only when "makeinfo" found
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 7d7610007aeb3e31e9d51996a2234659de792a25
Author: Bharat Shetty Barkur <bharat.shetty@gmail.com>
Date:   Mon Mar 2 14:31:39 2009 -0500

    Fixed small error regarding the poll_out variable
    
    Changed the poll_in variable to poll_out variable, so that the logging is relevant to the case of invalid poll_out value.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit fd524dda532a05cb2485935212d1a66f4130256c
Author: Harshavardhana <harsha@sunway.com>
Date:   Sat Feb 28 01:49:40 2009 -0800

    Fix solaris server segfault in recent "rc3" release.
    
    typecasting from uint64_t directly over pl_inode structure segfaults
    are all the calls from posix-locks.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b6bf3b8d6efb995d4ca7b91ff41709c57753d632
Author: Harshavardhana <harsha@sunway.com>
Date:   Fri Feb 27 10:23:45 2009 -0800

    CALLOC changed to calloc in rdd.c and several other cleanup and moved rdd.c into more appropriate "benchmarking" directory.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 24f80a408cbf5214664efe12466929d50575c963
Author: Harshavardhana <harsha@sunway.com>
Date:   Fri Feb 27 10:23:29 2009 -0800

    Removed unncessary EXTRA_DIST entries and updated benchmarking directory
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b2db5d966f210be72250fb87e513d187d3de7fdd
Author: Harshavardhana <harsha@sunway.com>
Date:   Fri Feb 27 10:23:08 2009 -0800

    Added /etc/init.d/lwfsd for rpmbuilds
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3aff44fab8ba7a109bd691b8675dbfd9842237a3
Author: Vikas Gorur <vikas@sunway.com>
Date:   Fri Feb 27 22:35:25 2009 +0530

    check for fd ctx set in changelog_needed_post_op for flush() in afr
    
    Earlier the check was in afr_flush(), which caused race conditions
    with writev()
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1e5ac91d05e89356ac63fb07cc09bed7a979289f
Author: krishna <krishna@guest-laptop>
Date:   Fri Feb 27 03:31:13 2009 -0800

    send a lookup on root as soon as we get CHILD_UP to fuse.
    
    send a lookup on root as soon as we get CHILD_UP to fuse. This fixes the
    case where some of the fuse versions do not send a lookup on the root
    directory when one of the "sub-dir" or "sub-file" is accessed just after mount.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8462dd88ad3531837ebfccd17a083467faa40227
Author: Amar Tumballi <amar@lw.com>
Date:   Thu Feb 26 08:09:25 2009 -0800

    volumefile modification awareness to make sure there are no inconsistencies.
    
    Complete (including feature to properly umount) in my sense.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit da9664587d414ba703c46839e3a4831ad3784a19
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Feb 27 10:34:03 2009 +0530

    Skip self-heal when subvolumes are down
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 596b48e14e5797deca35915edb047471d7c15a00
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Feb 27 02:50:48 2009 +0530

    fixing warnings in previous patch (typecasting pointer to long)

commit 0601a2d6631983cbce39982dfcbecae23a4fa629
Merge: 2dbcb3c b4ff0d5
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Fri Feb 27 02:39:49 2009 +0530

    Merge branch 'master' of ssh://avati@git.sv.gnu.org/srv/git/lw
    
    Conflicts:
    	xlators/features/locks/src/common.c

commit 2dbcb3c79338dc4f4c45c21e4bf62e61e455ae19
Author: Vikas Gorur <vikas@sunway.com>
Date:   Fri Feb 27 02:14:15 2009 +0530

    reverting nested locks in posix-locks for inodelk
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b4ff0d5c88b886dbe841cdcfdb71ac936522f9c3
Author: Vikas Gorur <vikas@sunway.com>
Date:   Fri Feb 27 02:14:15 2009 +0530

    reverting nested locks in posix-locks for inodelk
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f097e77ffb386dc73e3639af4a9cd57df0d3d40d
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Fri Feb 27 00:36:23 2009 +0530

    moved dht_hashfn_tea() to liblwfs/hashfn.c as gf_dm_hashfn() (dm - davies-meyer).
    
    moved dht_hashfn_tea() to liblwfs/src/hashfn.c as gf_dm_hashfn().
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 3d8bc3cbafa84a46e43e46f69d3e7d617d746012
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Feb 26 21:14:23 2009 +0530

    updated copyright header to extend copyright upto 2009
    
    updated copyright header to include 2009.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6fb7cda0a92b333e9c3861eb35f6f9ae3a1c03a2
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Feb 26 20:47:16 2009 +0530

    removed unnecessary README.git file
    
    removed README.git file
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d3a318973c9613cfef8b1a14256fb5178e417fb0
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Feb 26 20:36:50 2009 +0530

    fd->lock added to protect transactions for accessing and modifying fd->_ctx.
    
    fd->_ctx access and modifications are now protected by fd->lock.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 431617ef19244272797106f2356ef31591e9c7b9
Author: krishna <krishna@guest-laptop>
Date:   Thu Feb 26 06:11:48 2009 -0800

    Layout is sorted on volume names before forming the layout ranges. But when anomalies are to be detected layout is sorted based on "start" of the range (done in the selfheal during lookup).
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit c445012fa990be5dbc0ccbace04187484ccd92f3
Author: Vikas Gorur <vikas@sunway.com>
Date:   Thu Feb 26 17:51:47 2009 +0530

    protect fd_ctx get/set in afr_transaction and afr.c with locks
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 523d23b94c21cf5cfdfd087409371d9d2dcf25a4
Author: Vikas Gorur <vikas@sunway.com>
Date:   Thu Feb 26 17:13:25 2009 +0530

    Unset fd_ctx in afr_flush if it is set
    
    If fd_ctx is set, it means pending array needs to be decremented.
    However, flush might be called many times and it used to lead
    to multiple decrements. Fix is to unset fd_ctx on the first flush
    received
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b5377787903109dd5aea408e7b3a8e772b2be4f5
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Feb 26 13:38:33 2009 +0530

    __inode_unlink() should not be sent a NULL inode.
    
    unlink_inode might be NULL in inode_unlink() under the following circumstances:
    1. 'inode' got forget() and was unhashed.
    2. 'inode' was replaced by a new inode object and the new object got forget() or was pruned out of the inode table.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 417dfa48df166bfcd3f8a6da56c189de6e7a6aff
Author: Krishna Srinivas <krishna@sunway.com>
Date:   Thu Feb 19 12:39:04 2009 -0800

    DHT clean up. Lot of selfheal code is not applicable to newly created directory. Newly created directory will use only relavant part of DHT selfheal code - only for xattr application.
    
    DHT clean up. Lot of selfheal code is not applicable to newly created directory. Newly created directory will use only relavant part of DHT selfheal
    code - only for xattr application.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 029913bbd62ed7e3c3f436afe92ad6bca9dc642c
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Wed Feb 25 00:47:43 2009 -0800

    change MALLOC to malloc
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 6609b1d37bd0254ec0eb068758862a0bb0e78515
Author: Krishna Srinivas <krishna@sunway.com>
Date:   Tue Feb 24 06:55:39 2009 -0800

    DHT selfheal fix during lookup - create missing directories.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 1d556afdf8bf5459a1ea1a27ed5638d440439666
Author: Krishna Srinivas <krishna@sunway.com>
Date:   Tue Feb 24 06:53:21 2009 -0800

    Ping timer does not timeout in case there is any activity (cbks) from the server side.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8479df9809107f20df31afb332b8fb6a1931b861
Author: Krishna Srinivas <krishna@sunway.com>
Date:   Tue Feb 24 06:52:55 2009 -0800

    per frame time out - i.e individual frames are unwound instead of the transport point itself being disconnected. timeout is configured using "transport-timeout".
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit ab7fe2987fb4e2c2bd3158682fbb8c1977a049de
Author: Raghavendra G <raghavendra@sunway.com>
Date:   Tue Feb 24 02:42:41 2009 -0800

    backtick support enhancement
    
    - text within backtick can span multiple lines
      - check exit status of command after execution
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit d47eb5d681b79b32b838505b6e22c4ab627ba934
Author: Anand V. Avati <avati@lw.com>
Date:   Mon Feb 23 17:18:53 2009 +0530

    DHT TEA hashfn bugfix
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit f264f69ae96ade536dc6f5b8c1ce2579839d6222
Author: Vikas Gorur <vikas@sunway.com>
Date:   Mon Feb 23 19:36:26 2009 +0530

    Deleted xattr caching code from posix in anticipation of the xattr-cache translator.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8b1762971f8d18f73fa64a967c4cd2baa13d07fc
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Mon Feb 23 05:48:14 2009 -0800

    RE-SEND: Add braces around critical sections.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a3ed4474de9db5bda606b374f3d8cb1cdbf8a9fb
Author: Vikas Gorur <vikas@sunway.com>
Date:   Mon Feb 23 02:33:11 2009 -0800

    added lock_notify and lock_fnotify FOPs to everywhere necessary in liblwfs/*
    
    fixed indentation and resubmitting
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 80066c23da120621f26d83d631e204ab2943d181
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Sun Feb 22 11:29:05 2009 +0530

    posix_releasedir flush fds from xattrcache.
    
    It would have entered cache in setdents.
    
    Proposed fix for: http://sunway.com/pipermail/lw-users/2009-February/001621.html
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 8b99865bb1db5e349cfdacc795ca2160a32604e1
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Sat Feb 21 15:27:03 2009 +0530

    removed to 'option cache-size <size>' in example volfiles for io-threads.
    
    io-threads translator does not take 'cache-size' option now. so removed all
    references to 'cache-size' option for performance/io-threads.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit bcd1e26a95ab75f3431be8e71d93eae9b7b6cbf8
Author: Amar Tumballi <amar@del.lw.com>
Date:   Fri Feb 20 18:09:02 2009 -0800

    default volume file option enhanced in server-protocolg
    
    Noticed that with current codebase, there is no proper method to have a default volume filename to choose in getspec() without printing a *lot* of warning messages. This patch tries to have a proper 'default' behavior.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 869df6de6429bd556215a2a555883cabaa4dca80
Author: Amar Tumballi <amar@lw.com>
Date:   Sat Feb 21 13:50:01 2009 -0800

    change to make round robin dns work for getspec()
    
    Noticed that if I have just 'socket' and not the address-family, the
    round robin dns for '-s' option doesn't work. Changing it to 'tcp'
    works.
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a7b514ab8ec879a67e5a290743b4be6f0b58de1d
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu Feb 19 04:59:29 2009 -0800

    command line and mount/fuse now use float attr/entry timeouts
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit a2131aeafa94d671b0121631922d823c8a7ab988
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu Feb 19 04:59:06 2009 -0800

    attritbute and entry timeout values under volume now support float/double values
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit b5e0ee918fdff566e45bb255130b9efa6b8fb7b0
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu Feb 19 10:34:28 2009 -0800

    new function gf_string2double for float/double values
    
    fixed warning
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit 9679f8db65de29a40f622c12c2cc538d70b052b2
Author: Harshavardhana <harsha@sunway.com>
Date:   Thu Feb 19 10:26:17 2009 -0800

    new functions dict_{get,set}_double for float/double value
    
    fixed warning
    
    Signed-off-by: Anand V. Avati <avati@amp.lw.com>

commit e9ac5f587763b48acc19268ce57e6bfd886a0561
Author: Amar Tumballi <amar@del.lw.com>
Date:   Fri Feb 20 09:37:13 2009 -0800

    fix to remove ''input' defined but not used' warning in building lwfs
    
    needed to complete the build scripts without warnings
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 99a1cac632b4325afb95cb7c183721c0a90925d7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Feb 19 05:21:47 2009 -0800

    Reduce iothreads requests queue lock granularity.
    
    iot_queue() and iot_dequeue() functions were using a io-threads
    translator-wide lock which would be contended for by every worker
    thread waiting for IO requests.
    
    This patch reduces the granularity by turning the
    lock into a per-worker lock.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 57957c59cd2925540769ae9cb58029b0125e4ae7
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Feb 19 05:20:41 2009 -0800

    Remove conf->cache_size checks
    
    Since we're not dependent on this io-thread internal state(i.e.
    cache_size and current_size) to rate limit requests, we can remove
    these two data members and code that checks for these.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 6a250d9087014551c5085a534248982b195f819f
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Feb 19 05:25:44 2009 -0800

    Remove dead code.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 91df2dbcb10813d17053f715ae40a50b7499f4bc
Author: Basavanagowda Kanur <gowda@lw.com>
Date:   Thu Feb 19 19:38:57 2009 +0530

    cluster/ha to handle EBADFD for fd based operations as transport disconnected.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit ed1d91986cdaf0240b4e6a8c920f17b7f2d6d57b
Author: Vikas Gorur <vikas@sunway.com>
Date:   Thu Feb 19 04:26:47 2009 -0800

    warn on ERANGE error for lgetxattr in posix
    
    (amended to fit in 80 columns)
    
    ERANGE is usually caused by the user reducing the number of AFR's
    children but continues to use the old backend.
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 1c701badce280d8de92a5314881824725deec1e6
Author: Shehjar Tikoo <shehjart@sunway.com>
Date:   Thu Feb 19 02:26:40 2009 -0800

    Fix the order of CALLOC() args
    
    Fix the order of  CALLOC arguments.
    
    Signed-off-by: Shehjar Tikoo <shehjart@sunway.com>
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 0bb3a56f246082967f7a89a7ea51638babf514d1
Author: Anand V. Avati <avati@amp.lw.com>
Date:   Thu Feb 19 02:04:17 2009 -0800

    updated commit.sh
    
    changed commit.sh for git usage
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 9a4bba3a7ad86681abc9d022fd6677f668fdf062
Author: Vikas Gorur <vikas@sunway.com>
Date:   Thu Feb 19 00:18:28 2009 -0800

    added lock-ahead translator design document
    
    Design document for the lock-ahead translator
    
    Vikas
    
    Signed-off-by: Anand V. Avati <avati@dev.lw.com>

commit 77adf4cd648dce41f89469dd185deec6b6b53a0b
Author: Vikas Gorur <vikas@sunway.com>
Date:   Wed Feb 18 17:36:07 2009 +0530

    Added all files

commit f3b2e6580e5663292ee113c741343c8a43ee133f
Author: Vikas Gorur <vikas@sunway.com>
Date:   Wed Feb 18 17:01:30 2009 +0530

    Initial import
